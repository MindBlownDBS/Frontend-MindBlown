/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{checkAuthenticatedRoute:()=>T,checkProtectedRoute:()=>I,checkUnauthenticatedRouteOnly:()=>O,getAccessToken:()=>S,getLogout:()=>C,putAccessToken:()=>j,removeAccessToken:()=>P});var r={};function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){o=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function h(e,r,n,o){var i=r&&r.prototype instanceof p?r:p,a=Object.create(i.prototype);return l(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=E(s,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new P(o||[])),!0),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d={};function p(){}function v(){}function m(){}var y={};l(y,s,(function(){return this}));var g=Object.getPrototypeOf,w=g&&g(g(_([])));w&&w!==r&&i.call(w,s)&&(y=w);var b=m.prototype=p.prototype=Object.create(y);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,a,s,u){var c=f(t[o],t,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==n(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,s,u)}),(function(t){r("throw",t,s,u)})):e.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,u)}))}u(c.arg)}var o;l(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function E(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function S(t){this.tryEntries.push(t)}function j(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function P(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function _(e){if(null!=e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(i.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return v.prototype=m,l(b,"constructor",m),l(m,"constructor",v),v.displayName=l(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,l(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},x(k.prototype),l(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(b),l(b,c,"Generator"),l(b,s,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),j(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:_(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function i(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function a(t){var e=t.skipTransition,r=void 0!==e&&e,n=t.updateDOM;if(r||!document.startViewTransition){var o=Promise.resolve(n()).then((function(){}));return{ready:Promise.reject(Error("View transitions unsupported")),updateCallbackDone:o,finished:o}}return document.startViewTransition(n)}function s(t){t.style.height="auto",t.style.height=t.scrollHeight+"px"}function u(){return c.apply(this,arguments)}function c(){var t;return t=o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("serviceWorker"in navigator){t.next=3;break}return console.log("Service Worker API unsupported"),t.abrupt("return");case 3:return t.prev=3,t.next=6,navigator.serviceWorker.register("/sw.bundle.js");case 6:e=t.sent,console.log("Service worker telah terpasang",e),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),console.log("Failed to install service worker:",t.t0);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})),c=function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function s(t){i(a,n,o,s,u,"next",t)}function u(t){i(a,n,o,s,u,"throw",t)}s(void 0)}))},c.apply(this,arguments)}function l(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=atob(e),n=new Uint8Array(r.length),o=0;o<r.length;o++)n[o]=r.charCodeAt(o);return n}t.r(r),t.d(r,{checkTodayEntry:()=>Z,commentOnStory:()=>pt,deleteCommentApi:()=>Gt,deleteStory:()=>Tt,editStory:()=>Ot,getCommentDetail:()=>Bt,getEntryByDate:()=>et,getLogin:()=>X,getNotifications:()=>gt,getRegister:()=>V,getStories:()=>it,getStoryDetail:()=>ht,getUserProfile:()=>ct,likeComment:()=>Nt,likeStory:()=>ft,markAllNotificationsAsRead:()=>kt,markNotificationAsRead:()=>bt,postStory:()=>st,replyToComment:()=>It,saveEntry:()=>nt,subscribePushNotification:()=>St,unsubscribePushNotification:()=>Pt,updateProfile:()=>mt});var h=function(){return'\n    <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">\n        <h2 class="text-2xl font-semibold mb-4">Login Diperlukan</h2>\n        <p class="text-gray-600 mb-6">Silakan login untuk mengakses fitur ini.</p>\n        <div class="flex justify-end gap-4">\n            <button id="cancel-login" class="px-4 py-2 text-gray-600 hover:text-gray-800">Batal</button>\n            <button id="go-to-login" class="px-4 py-2 bg-third text-white rounded-lg hover:bg-third/80">Login</button>\n        </div>\n    </div>\n'};function f(t){return'\n        <div class="flex justify-end mb-3">\n            <div class="flex flex-row-reverse items-start gap-2 max-w-[80%]">\n                <div class="bg-[#7de3e1] px-4 py-2 rounded-lg text-sm text-gray-800 text-left">\n                    '.concat(t,"\n                </div>\n            </div>\n        </div>\n    ")}function d(t){return'\n        <div class="flex justify-start mb-3">\n            <div class="flex items-start max-w-[80%]">\n                <div class="w-8 h-8 rounded-lg bg-white flex items-center justify-center">\n                    <img src="images/logo.png" alt="Bot" class="w-7 h-7 lg:w-8 lg:h-8 object-cover">\n                </div>\n                <div class="bg-white px-3 py-2 rounded-lg text-sm text-gray-800 text-left">\n                    '.concat(t,"\n                </div>\n            </div>\n        </div>\n    ")}function p(t){var e=[40,10,60,35,50,25,45,0],r=200*(t.length-1)+40,n=65*(Math.min(4,t.length)-1)+40,o=t.map((function(t,r){var n=e[r]||40;return"".concat(20+200*r,",").concat(n)})).join(" "),i=t.slice(0,4).map((function(t,r){var n=e[r]||40;return"".concat(20+65*r,",").concat(n)})).join(" ");return'\n    <div class="bg-white rounded-xl border border-gray-200 p-4 mt-6 mb-8">\n      <div class="flex items-center justify-between">\n        <button class="rounded-full border border-gray-300 w-8 h-8 flex items-center justify-center text-gray-500 hover:bg-gray-100" id="moodPrevBtn">\n          &larr;\n        </button>\n        <div class="flex-1 flex flex-col items-center">\n          \x3c!-- Desktop View --\x3e\n          <div class="hidden lg:block" style="position:relative; width:'.concat(r,"px; height:").concat(120,'px;">\n            <svg width="').concat(r,'" height="').concat(80,'" style="position:absolute;top:0;left:0;">\n              <polyline\n                fill="none"\n                stroke="#bbb"\n                stroke-width="2"\n                points="').concat(o,'"\n              />\n            </svg>\n            ').concat(t.map((function(t,r){var n=20+200*r,o=e[r]||40;return'\n                <div style="position:absolute;left:'.concat(n-18,"px;top:").concat(o-18,'px;width:36px;height:36px;display:flex;flex-direction:column;align-items:center;">\n                  <span style="font-size:2rem;line-height:1;">').concat(t.emoji,'</span>\n                </div>\n                <div style="position:absolute;left:').concat(n-30,"px;top:").concat(85,'px;width:60px;text-align:center;font-size:12px;color:#666;">\n                  ').concat(t.date,"\n                </div>\n              ")})).join(""),'\n          </div>\n\n          \x3c!-- Mobile View --\x3e\n          <div class="lg:hidden" style="position:relative; width:').concat(n,"px; height:").concat(120,'px;">\n            <svg width="').concat(n,'" height="').concat(80,'" style="position:absolute;top:0;left:0;">\n              <polyline\n                fill="none"\n                stroke="#bbb"\n                stroke-width="2"\n                points="').concat(i,'"\n              />\n            </svg>\n            ').concat(t.slice(0,4).map((function(t,r){var n=20+65*r,o=e[r]||40;return'\n                <div style="position:absolute;left:'.concat(n-18,"px;top:").concat(o-18,'px;width:36px;height:36px;display:flex;flex-direction:column;align-items:center;">\n                  <span style="font-size:1.5rem;line-height:1;">').concat(t.emoji,'</span>\n                </div>\n                <div style="position:absolute;left:').concat(n-30,"px;top:").concat(85,'px;width:60px;text-align:center;font-size:12px;color:#666;">\n                  ').concat(t.date,"\n                </div>\n              ")})).join(""),'\n          </div>\n        </div>\n        <button class="rounded-full border border-gray-300 w-8 h-8 flex items-center justify-center text-gray-500 hover:bg-gray-100" id="moodNextBtn">\n          &rarr;\n        </button>\n      </div>\n    </div>\n  ')}function v(t){var e,r,n,o,i,a=t.id,s=void 0===a?"":a,u=t.icon,c=void 0===u?"images/logo.png":u,l=t.title,h=void 0===l?"":l,f=t.message,d=void 0===f?"":f,p=t.read,v=void 0!==p&&p,m=t.createdAt,y=void 0===m?"":m,g=y?(e=new Date(y),r=new Date-e,n=Math.floor(r/6e4),o=Math.floor(r/36e5),i=Math.floor(r/864e5),n<1?"Baru saja":n<60?"".concat(n," menit yang lalu"):o<24?"".concat(o," jam yang lalu"):i<7?"".concat(i," hari yang lalu"):e.toLocaleDateString("id-ID")):"";return'\n    <div class="flex items-start gap-3 py-4 border-b border-gray-200 cursor-pointer hover:bg-gray-50 '.concat(v?"opacity-60":"",'" \n         data-notification-id="').concat(s,'">\n      <div class="w-8 h-8 flex-shrink-0 flex items-center justify-center">\n        <img src="').concat(c,'" alt="icon" class="w-7 h-7 object-cover">\n      </div>\n      <div class="text-left flex-1">\n        <div class="flex justify-between items-start">\n          <div class="font-semibold text-base text-gray-800 mb-1">').concat(h,"</div>\n          ").concat(v?"":'<div class="w-2 h-2 bg-third rounded-full flex-shrink-0"></div>','\n        </div>\n        <div class="text-sm text-gray-700 leading-snug mb-1">').concat(d,"</div>\n        ").concat(g?'<div class="text-xs text-gray-500">'.concat(g,"</div>"):"","\n      </div>\n    </div>\n  ")}function m(t){var e=t.username,r=void 0===e?"Pengguna":e,n=t.handle,o=void 0===n?"Anonim":n,i=t.content,a=void 0===i?"":i,s=(t.isAnonymous,t.likeCount),u=void 0===s?0:s,c=t.commentCount,l=void 0===c?0:c,h=t.viewCount,f=void 0===h?0:h,d=t.storyId,p=void 0===d?"":d,v=t.profilePicture,m=void 0===v?"./images/image.png":v,y=t.createdAt,g=void 0===y?"":y,w=t.isOwner,b=void 0!==w&&w,x="";if(g)try{var k=new Date(g);x=isNaN(k.getTime())?"Tanggal tidak valid":k.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){x="Gagal memuat tanggal"}return'\n    <div class="story-container flex items-start gap-3 py-3 border-b border-gray-200 max-w-2xl" data-story-id="'.concat(p,'">\n    <div class="w-10 h-10 flex-shrink-0 user-info">\n      <img src="').concat(m,'" alt="icon" class="w-10 h-10 object-cover rounded-full" />\n    </div>\n\n    <div class="flex flex-col text-left story-content w-full">\n      <div class="flex justify-between items-start">\n      <div class="user-info">\n        <div class="font-semibold text-base text-gray-800">').concat(r,'</div>\n        <div class="text-sm text-gray-500">').concat(o,"</div>\n      </div>\n\n        ").concat(b?'\n        <div class="relative">\n          <button class="story-menu-btn p-1 text-gray-500 hover:text-gray-700">\n            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n              <circle cx="12" cy="12" r="1"></circle>\n              <circle cx="12" cy="5" r="1"></circle>\n              <circle cx="12" cy="19" r="1"></circle>\n            </svg>\n          </button>\n\n          <div class="story-menu hidden absolute right-0 mt-1 w-32 bg-white rounded-md shadow-lg z-10 border border-gray-200">\n            <button class="edit-story-btn w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-story-id="'.concat(p,'">Edit</button>\n            <button class="delete-story-btn w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100" data-story-id="').concat(p,'">Hapus</button>\n          </div>\n        </div>\n        '):"",'\n      </div>\n\n      <p class="text-gray-700 mt-3 text-sm leading-relaxed">').concat(a,"</p>\n\n      ").concat(x?'\n        <div class="text-xs text-gray-400 mt-2">\n          '.concat(x,"\n        </div>\n        "):"",'\n\n        <div class="flex items-center gap-30 mt-3">\n          <button class="like-btn flex items-center gap-1" data-story-id="').concat(p,'">\n            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>\n            <span class="like-count text-sm">').concat(u,'</span>\n          </button>\n          <button class="comment-btn flex items-center gap-1" data-story-id="').concat(p,'">\n            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>\n            <span class="comment-count text-sm">').concat(l,'</span>\n          </button>\n          <button class="view-btn flex items-center gap-1" data-story-id="').concat(p,'">\n            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 flex-shrink-0" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 17c-.55 0-1-.45-1-1v-5c0-.55.45-1 1-1s1 .45 1 1v5c0 .55-.45 1-1 1zm4 0c-.55 0-1-.45-1-1V8c0-.55.45-1 1-1s1 .45 1 1v8c0 .55-.45 1-1 1zm4 0c-.55 0-1-.45-1-1v-2c0-.55.45-1 1-1s1 .45 1 1v2c0 .55-.45 1-1 1zm2 2H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm1-16H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/></svg>\n            <span class="view-count text-sm">').concat(f,"</span>\n          </button>\n        </div>\n      </div>\n    </div>\n  ")}function y(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.username,r=void 0===e?"Nama Pengguna":e,n=t.handle,o=void 0===n?"@namapengguna":n,i=t.timestamp,a=void 0===i?"":i,s=t.profilePicture,u=void 0===s?"./images/image.png":s;return new Date(a).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),'\n    <form id="chat-form" class="mt-auto sticky">\n    <div class="flex items-start gap-3 py-4 border-gray-200 max-w-2xl">\n    <div class="w-10 h-10 flex-shrink-0">\n        <img src="'.concat(u,'" alt="icon" class="w-10 h-10 object-cover rounded-full" />\n      </div>\n\n      <div class="flex flex-col text-left w-full">\n      <div>\n        <div class="font-semibold text-base text-gray-800">').concat(r,'</div>\n        <div class="text-sm text-gray-500 mb-4">').concat(o,'</div>\n      </div>\n      <div class="relative w-full z-50 w-full max-w-2xl mx-auto">\n        <textarea \n          id="chat-input"\n          class="text-[#8c8c8c] w-full h-24 px-4 py-3 pr-14 rounded-3xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent overflow-hidden"\n          placeholder="Ada cerita apa?..."></textarea>\n        <button class="absolute right-3 top-1/2 transform -translate-y-1/2 rounded-full bg-[#eee] p-2 w-25 text-white py-2 mt-2 hover:bg-third focus:bg-third justify-end" type="submit">Unggah</button>\n      </div>\n      <div class="mt-2 flex items-center">\n        <input type="checkbox" id="post-anonymously" class="mr-2">\n        <label for="post-anonymously" class="text-sm text-gray-600">Unggah sebagai anonim</label>\n      </div>\n    </div>\n    </form>\n  ')}function g(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.username,r=void 0===e?"Nama Pengguna":e,n=t.handle,o=void 0===n?"@namapengguna":n,i=t.profilePicture;return'\n    <form id="comment-form" class="sticky top-4">\n      <div class="flex items-start gap-3 py-4 border-gray-200 max-w-2xl">\n        <div class="w-10 h-10 flex-shrink-0">\n          <img src="'.concat(void 0===i?"./images/image.png":i,'" alt="icon" class="w-10 h-10 object-cover rounded-full" />\n        </div>\n\n        <div class="flex flex-col text-left w-full">\n          <div>\n            <div class="font-semibold text-base text-gray-800">').concat(r,'</div>\n            <div class="text-sm text-gray-500 mb-4">').concat(o,'</div>\n          </div>\n          <div class="relative w-full z-50">\n            <textarea \n              id="comment-input"\n              class="text-[#8c8c8c] w-full h-24 px-4 py-3 pr-14 rounded-3xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent overflow-hidden"\n              placeholder="Unggah komentarmu..."></textarea>\n            <button class="absolute right-3 top-1/2 transform -translate-y-1/2 rounded-full bg-[#eee] p-2 w-25 text-white py-2 mt-2 hover:bg-teal-500 justify-end" type="submit">Unggah</button>\n          </div>\n        </div>\n      </div>\n    </form>\n  ')}function w(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.commentId,r=void 0===e?"":e,n=t.username,o=void 0===n?"Pengguna":n,i=t.handle,a=void 0===i?"Anonim":i,s=t.content,u=void 0===s?"":s,c=t.profilePicture,l=void 0===c?"./images/image.png":c,h=t.createdAt,f=void 0===h?"":h,d=t.likeCount,p=void 0===d?0:d,v=t.replyCount,m=void 0===v?0:v,y=t.isOwner,g=void 0!==y&&y,w="";if(f)try{var b=new Date(f);w=isNaN(b.getTime())?"Tanggal tidak valid":b.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){w="Gagal memuat tanggal"}return'\n    <div class="comment-item-container flex items-start gap-3 py-3 border-b border-gray-200" data-comment-id="'.concat(r,'">\n      <div class="w-8 h-8 flex-shrink-0 user-info">\n        <img src="').concat(l,'" alt="icon" class="w-8 h-8 object-cover rounded-full" />\n      </div>\n\n      <div class="flex flex-col text-left comment-content w-full">\n        <div class="flex justify-between items-start">\n        <div class="user-info">\n          <div class="font-semibold text-sm text-gray-800 username-comment">').concat(o,'</div>\n          <div class="text-sm text-gray-500 mb-3 handle-comment">').concat(a,"</div>\n        </div>\n          ").concat(g?'\n            <div class="relative comment-actions-menu">\n              <button class="comment-menu-btn p-1 text-gray-500 hover:text-gray-700">\n                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                <circle cx="12" cy="12" r="1"></circle>\n                <circle cx="12" cy="5" r="1"></circle>\n                <circle cx="12" cy="19" r="1"></circle>\n              </svg>\n              </button>\n              <div class="comment-menu hidden absolute right-0 mt-1 w-32 bg-white rounded-md shadow-lg z-10 border border-gray-200">\n                <button class="delete-comment-btn w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100" data-comment-id="'.concat(r,'">Hapus</button>\n              </div>\n            </div>\n          '):"",'\n        </div>\n\n        <p class="text-gray-700 mt-1 text-sm leading-relaxed">').concat(u,"</p>\n\n        ").concat(w?'<div class="text-xs text-gray-400">'.concat(w,"</div>"):"",'\n\n        <div class="flex items-center gap-4 mt-2">\n          <button class="comment-like-btn flex items-center gap-1 text-xs text-gray-500 hover:text-red-500" data-comment-id="').concat(r,'">\n            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>\n            <span class="comment-like-count">').concat(p,'</span>\n          </button>\n          <a href="#/comment/').concat(r,'" class="comment-reply-link flex items-center gap-1 text-xs text-gray-500 hover:text-teal-500">\n            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>\n            <span class="comment-reply-count">').concat(m,'</span>\n          </a>\n        </div>\n        <div class="replies-container mt-2 pl-5 border-l-2 border-gray-100">\n          </div>\n      </div>\n    </div>\n  ')}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.parentCommentId,r=void 0===e?"":e,n=t.username,o=void 0===n?"Nama Pengguna":n,i=t.handle,a=void 0===i?"@namapengguna":i,s=t.profilePicture,u=void 0===s?"./images/image.png":s;return'\n    <form id="reply-form-'.concat(r,'" class="sticky top-4 reply-form-container" data-parent-comment-id="').concat(r,'">\n      <div class="flex items-start gap-3 py-4 border-gray-200 max-w-2xl">\n        <div class="w-10 h-10 flex-shrink-0">\n          <img src="').concat(u,'" alt="icon" class="w-10 h-10 object-cover rounded-full" />\n        </div>\n        <div class="flex flex-col text-left w-full">\n          <div>\n            <div class="font-semibold text-base text-gray-800">').concat(o,'</div>\n            <div class="text-sm text-gray-500 mb-2">').concat(a,'</div>\n          </div>\n          <div class="relative w-full z-10">\n            <textarea\n              id="reply-input-').concat(r,'"\n              class="text-[#8c8c8c] w-full h-24 px-4 py-3 pr-14 rounded-3xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent overflow-hidden"\n              placeholder="Tulis balasanmu..."></textarea>\n            <button class="absolute right-3 top-1/2 transform -translate-y-1/2 rounded-full bg-[#eee] p-2 w-25 text-white py-2 mt-2 hover:bg-teal-500 justify-end" type="submit">Unggah</button>\n          </div>\n        </div>\n      </div>\n    </form>\n  ')}function x(){return r=location.hash.replace("#","")||"/",n=r.split("/"),t={resource:n[1]||null,id:n[2]||null},e="",t.resource&&(e=e.concat("/".concat(t.resource))),t.id&&(e=e.concat("/:id")),e||"/";var t,e,r,n}var k="accessToken",E="http://localhost:5000";function S(){try{var t=localStorage.getItem(k);return"null"===t||"undefined"===t?null:t}catch(t){return console.error("getAccessToken: error:",t),null}}function j(t){try{return localStorage.setItem(k,t),!0}catch(t){return console.error("putAccessToken: error:",t),!1}}function P(){try{return localStorage.removeItem(k),!0}catch(t){return console.error("getLogout: error:",t),!1}}var _=["/login","/register"];function O(t){var e=x(),r=!!S();return _.includes(e)&&r?(location.hash="/",null):t}function T(t){return S()?t:(location.hash="/login",null)}function I(t){var e;return S()?t:(window.location.hash,(e=document.createElement("div")).className="fixed inset-0 bg-black/70 flex items-center justify-center z-50",e.innerHTML=h(),document.body.appendChild(e),document.getElementById("cancel-login").addEventListener("click",(function(){e.remove(),window.history.back()})),document.getElementById("go-to-login").addEventListener("click",(function(){e.remove(),window.location.hash="/login"})),null)}function C(){P()}function N(t){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}function L(){L=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==N(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(N(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function G(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function A(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){G(i,n,o,a,s,"next",t)}function s(t){G(i,n,o,a,s,"throw",t)}a(void 0)}))}}function B(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,M(n.key),n)}}function M(t){var e=function(t){if("object"!=N(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=N(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==N(e)?e:e+""}function D(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var F=new WeakSet,H=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,F)},e=[{key:"render",value:(n=A(L().mark((function t(){return L().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="md:ml-16 h-150 lg:min-h-screen flex items-center">\n        <div class="w-full flex items-center pb-20"> \n            <div class="max-w-2xl w-full mx-auto text-center">\n                <img src="images/logo.png" alt="Logo" class="w-27 h-27 mx-auto mb-3 lg:mb-10 mt-30">\n                <h1 class="text-primary lg:text-3xl text-2xl font-semibold mb-1">Hai, aku MindBlown!</h1>\n                <p class="text-secondary mb-8 lg:text-lg text-sm px-10 lg:px-0">Apa pun yang kamu rasain sekarang, itu valid. Mau cerita sedikit?</p>\n\n                <div id="chat-container" class="flex flex-col gap-2 px-4"></div>\n                \n                <form id="chat-form" class="relative mx-4 lg:mx-0 flex flex-col gap-2">\n                    <textarea \n                      id="chat-input"\n                      class="text-[#8c8c8c] w-full h-16 lg:h-24 px-4 py-3 pr-14 rounded-3xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent overflow-hidden   placeholder:leading-[2rem] lg:placeholder:leading-[4rem]"\n                      placeholder="Cerita sedikit..."></textarea>\n                    <button class="absolute right-3 top-1/2 transform -translate-y-1/2 rounded-full bg-[#eee] p-2 flex items-center justify-center hover:bg-third focus:bg-third transition cursor-pointer">\n                       <svg xmlns="http://www.w3.org/2000/svg"  class="w-6 h-6 text-white" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="white" id="Send--Streamline-Mynaui" height="16" width="16">\n                        <path d="m8.75 6.25 -1.875 1.875m5.805 -6.230625a0.33437500000000003 0.33437500000000003 0 0 1 0.42500000000000004 0.42562500000000003l-3.7025 10.58125a0.33437500000000003 0.33437500000000003 0 0 1 -0.62125 0.025l-2.011875 -4.52625a0.33375 0.33375 0 0 0 -0.169375 -0.169375l-4.52625 -2.0125a0.33437500000000003 0.33437500000000003 0 0 1 0.025 -0.620625z" stroke-width="1"></path>\n                    </svg>\n                    </button>\n                </form>\n            </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=A(L().mark((function t(){var e;return L().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:S()||sessionStorage.getItem("welcomeModalShown")||D(F,this,z).call(this),(e=document.getElementById("chat-input")).addEventListener("input",(function(){return s(e)})),D(F,this,U).call(this);case 4:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&B(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function U(){document.getElementById("chat-form").addEventListener("submit",(function(t){t.preventDefault();var e=document.getElementById("chat-input").value.trim();e&&(localStorage.setItem("pendingChatMessage",e),window.location.hash="/chatbot")}))}function z(){if(!document.getElementById("welcome-modal")){var t=document.createElement("div");t.id="welcome-modal",t.innerHTML='\n  <div class="fixed inset-0 bg-black/70 flex items-center justify-center z-50">\n    <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 text-center">\n      <h2 class="text-2xl font-semibold mb-2">Selamat Datang</h2>\n      <p class="text-gray-600 mb-5 text-sm">\n         Masuk atau daftar untuk menikmati lebih banyak fitur unggulan dari kami ...\n      </p>\n      <button id="welcome-login" class="w-full py-2 mb-3 rounded-full bg-third text-white font-semibold border-2 border-third hover:bg-third/80 transition">Log in</button>\n      <button id="welcome-signup" class="w-full py-2 mb-3 rounded-full border-2 border-third text-black font-semibold hover:bg-gray-100 transition">Sign up</button>\n      <a href="#" id="welcome-stay-logged-out" class="text-gray-500 underline text-sm">Lewati untuk sekarang</a>\n    </div>\n  </div>\n',document.body.appendChild(t),sessionStorage.setItem("welcomeModalShown","true"),document.getElementById("welcome-login").onclick=function(){t.remove(),window.location.hash="/login"},document.getElementById("welcome-signup").onclick=function(){t.remove(),window.location.hash="/register"},document.getElementById("welcome-stay-logged-out").onclick=function(e){e.preventDefault(),t.remove()}}}function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function R(){R=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==q(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(q(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function W(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function J(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){W(i,n,o,a,s,"next",t)}function s(t){W(i,n,o,a,s,"throw",t)}a(void 0)}))}}var Y="/mind-tracker",K="/notifications/read-all";function V(t,e,r,n){return $.apply(this,arguments)}function $(){return($=J(R().mark((function t(e,r,n,o){var i,a,s;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=JSON.stringify({username:e,name:r,email:n,password:o}),t.next=3,fetch("".concat(E).concat("/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:i});case 3:return a=t.sent,t.next=6,a.json();case 6:return s=t.sent,t.abrupt("return",s);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function X(t,e){return Q.apply(this,arguments)}function Q(){return(Q=J(R().mark((function t(e,r){var n,o,i;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.stringify({usernameOrEmail:e,password:r}),t.next=3,fetch("".concat(E).concat("/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:n});case 3:return o=t.sent,t.next=6,o.json();case 6:return i=t.sent,t.abrupt("return",i);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Z(){return tt.apply(this,arguments)}function tt(){return(tt=J(R().mark((function t(){var e,r,n,o,i;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=localStorage.getItem("accessToken")){t.next=3;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 3:return r=new Date,n=r.toISOString().split("T")[0],t.next=7,fetch("".concat(E).concat("/mind-tracker/check","/").concat(n),{headers:{Authorization:"Bearer ".concat(e)}});case 7:return o=t.sent,t.next=10,o.json();case 10:if(i=t.sent,!o.error){t.next=13;break}throw new Error(i.message||"Terjadi kesalahan saat mengecek data");case 13:return t.abrupt("return",i);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function et(t){return rt.apply(this,arguments)}function rt(){return(rt=J(R().mark((function t(e){var r,n,o,i;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=localStorage.getItem("accessToken")){t.next=3;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 3:return n=new Date(e),o=n.toISOString().split("T")[0],t.next=7,fetch("".concat(E).concat(Y,"/").concat(o),{headers:{Authorization:"Bearer ".concat(r)}});case 7:return i=t.sent,t.next=10,i.json();case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function nt(t){return ot.apply(this,arguments)}function ot(){return(ot=J(R().mark((function t(e){var r,n,o;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=localStorage.getItem("accessToken")){t.next=3;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 3:return t.next=5,fetch("".concat(E).concat(Y),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(e)});case 5:return n=t.sent,t.next=8,n.json();case 8:if(o=t.sent,!n.error){t.next=11;break}throw new Error(o.message||"Terjadi kesalahan saat menyimpan data");case 11:return t.abrupt("return",o);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function it(){return at.apply(this,arguments)}function at(){return(at=J(R().mark((function t(){var e,r;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=S(),t.prev=1,t.next=4,fetch("".concat(E,"/stories"),{headers:{Authorization:"Bearer ".concat(e)}});case 4:return r=t.sent,t.next=7,r.json();case 7:return t.abrupt("return",t.sent);case 10:return t.prev=10,t.t0=t.catch(1),console.error("Error fetching stories:",t.t0),t.abrupt("return",{error:!0,message:"Gagal menampilkan cerita"});case 14:case"end":return t.stop()}}),t,null,[[1,10]])})))).apply(this,arguments)}function st(t){return ut.apply(this,arguments)}function ut(){return ut=J(R().mark((function t(e){var r,n,o,i,a=arguments;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a.length>1&&void 0!==a[1]&&a[1],t.prev=1,n=S()){t.next=5;break}throw new Error("No authentication token found");case 5:return t.next=7,fetch("".concat(E,"/stories"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({content:e,isAnonymous:r})});case 7:return o=t.sent,t.next=10,o.json();case 10:if(i=t.sent,o.ok){t.next=13;break}throw new Error(i.message||"Gagal mengunggah cerita");case 13:return t.abrupt("return",i);case 16:throw t.prev=16,t.t0=t.catch(1),console.error("Error posting story:",t.t0),t.t0;case 20:case"end":return t.stop()}}),t,null,[[1,16]])}))),ut.apply(this,arguments)}function ct(t){return lt.apply(this,arguments)}function lt(){return(lt=J(R().mark((function t(e){var r,n,o;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=S()){t.next=3;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 3:return t.next=5,fetch("".concat(E,"/profile/").concat(e),{headers:{Authorization:"Bearer ".concat(r)}});case 5:return n=t.sent,t.next=8,n.json();case 8:if(o=t.sent,!n.error){t.next=11;break}throw new Error(o.message||"Terjadi kesalahan saat mengambil profil");case 11:return t.abrupt("return",o);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ht=function(){var t=J(R().mark((function t(e){var r,n,o,i;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e&&"undefined"!==e){t.next=3;break}return t.abrupt("return",{error:!0,message:"Invalid story ID. Story ID is required."});case 3:return t.next=5,fetch("".concat(E,"/stories/").concat(e),{headers:{Authorization:"Bearer ".concat(S())}});case 5:if(r=t.sent,(n=r.headers.get("content-type"))&&n.includes("application/json")){t.next=12;break}return t.next=10,r.text();case 10:throw o=t.sent,new Error("Expected JSON but got: ".concat(o.substring(0,100),"..."));case 12:return t.next=14,r.json();case 14:if(i=t.sent,r.ok){t.next=17;break}return t.abrupt("return",{error:!0,message:i.message||"Failed to fetch story"});case 17:return t.abrupt("return",i);case 20:return t.prev=20,t.t0=t.catch(0),console.error("Error fetching story detail:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Network error while fetching story"});case 24:case"end":return t.stop()}}),t,null,[[0,20]])})));return function(e){return t.apply(this,arguments)}}();function ft(t){return dt.apply(this,arguments)}function dt(){return(dt=J(R().mark((function t(e){var r,n,o;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}throw new Error("Invalid story ID");case 3:if(r=S()){t.next=6;break}throw new Error("Authentication required");case 6:return t.next=8,fetch("".concat(E,"/stories/").concat(e,"/likes"),{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});case 8:return n=t.sent,t.next=11,n.json();case 11:if(o=t.sent,n.ok){t.next=14;break}throw new Error(o.message||"Failed to like story");case 14:return t.abrupt("return",o.likeCount);case 17:throw t.prev=17,t.t0=t.catch(0),console.error("Failed to like story:",t.t0),t.t0;case 21:case"end":return t.stop()}}),t,null,[[0,17]])})))).apply(this,arguments)}function pt(t,e){return vt.apply(this,arguments)}function vt(){return(vt=J(R().mark((function t(e,r){var n;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(E,"/stories/").concat(e,"/comments"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(S())},body:JSON.stringify({content:r})});case 2:return n=t.sent,t.next=5,n.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mt(t){return yt.apply(this,arguments)}function yt(){return(yt=J(R().mark((function t(e){var r,n,o;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(r=localStorage.getItem("accessToken"))&&"string"==typeof r&&r.includes(".")){t.next=4;break}throw new Error("Invalid token structure");case 4:return t.next=6,fetch("".concat(E,"/profile"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(e)});case 6:return n=t.sent,t.next=9,n.json();case 9:if(o=t.sent,n.ok){t.next=12;break}return t.abrupt("return",{error:!0,message:o.message||"Failed to update profile"});case 12:return t.abrupt("return",o);case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",{error:!0,message:t.t0.message||"Network error occurred"});case 18:case"end":return t.stop()}}),t,null,[[0,15]])})))).apply(this,arguments)}function gt(){return wt.apply(this,arguments)}function wt(){return(wt=J(R().mark((function t(){var e,r,n;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=S()){t.next=4;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 4:return t.next=6,fetch("".concat(E).concat("/notifications"),{headers:{Authorization:"Bearer ".concat(e)}});case 6:return r=t.sent,t.next=9,r.json();case 9:if(n=t.sent,r.ok){t.next=12;break}throw new Error(n.message||"Terjadi kesalahan saat mengambil notifikasi");case 12:return t.abrupt("return",n);case 15:return t.prev=15,t.t0=t.catch(0),console.error("Error fetching notifications:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal mengambil notifikasi"});case 19:case"end":return t.stop()}}),t,null,[[0,15]])})))).apply(this,arguments)}function bt(t){return xt.apply(this,arguments)}function xt(){return(xt=J(R().mark((function t(e){var r,n,o,i,a,s;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=S()){t.next=4;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 4:return n="".concat(E).concat("/notifications","/").concat(e,"/read"),t.next=7,fetch(n,{method:"PUT",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});case 7:if(o=t.sent,i=o.headers.get("content-type"),console.log("Content-Type:",i),!i||!i.includes("application/json")){t.next=16;break}return t.next=13,o.json();case 13:a=t.sent,t.next=21;break;case 16:return t.next=18,o.text();case 18:throw s=t.sent,console.log("Non-JSON response text:",s),new Error("Server returned non-JSON response: ".concat(s));case 21:if(o.ok){t.next=31;break}if(403!==o.status){t.next=26;break}throw new Error("Anda tidak memiliki akses untuk menandai notifikasi ini");case 26:if(404!==o.status){t.next=30;break}throw new Error("Notifikasi tidak ditemukan");case 30:throw new Error(a.message||"Terjadi kesalahan saat menandai notifikasi");case 31:return t.abrupt("return",a);case 34:return t.prev=34,t.t0=t.catch(0),console.error("Error message:",t.t0.message),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal menandai notifikasi sebagai dibaca"});case 38:case"end":return t.stop()}}),t,null,[[0,34]])})))).apply(this,arguments)}function kt(){return Et.apply(this,arguments)}function Et(){return(Et=J(R().mark((function t(){var e,r,n,o,i;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=S()){t.next=4;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 4:return console.log("Attempting to mark all notifications as read"),console.log("URL:","".concat(E).concat(K)),t.next=8,fetch("".concat(E).concat(K),{method:"PUT",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});case 8:if(r=t.sent,console.log("Response received:"),console.log("Status:",r.status),console.log("Status Text:",r.statusText),console.log("OK:",r.ok),n=r.headers.get("content-type"),console.log("Content-Type:",n),!n||!n.includes("application/json")){t.next=21;break}return t.next=18,r.json();case 18:o=t.sent,t.next=26;break;case 21:return t.next=23,r.text();case 23:throw i=t.sent,console.log("Non-JSON response text:",i),new Error("Server returned non-JSON response: ".concat(i));case 26:if(r.ok){t.next=28;break}throw new Error(o.message||"Terjadi kesalahan saat menandai semua notifikasi");case 28:return t.abrupt("return",o);case 31:if(t.prev=31,t.t0=t.catch(0),console.error("Error marking all notifications as read:",t.t0),console.error("Error type:",t.t0.constructor.name),console.error("Error message:",t.t0.message),!(t.t0 instanceof TypeError&&t.t0.message.includes("Failed to fetch"))){t.next=38;break}return t.abrupt("return",{error:!0,message:"Tidak dapat terhubung ke server. Periksa koneksi internet Anda dan pastikan server berjalan."});case 38:return t.abrupt("return",{error:!0,message:t.t0.message||"Gagal menandai semua notifikasi sebagai dibaca"});case 39:case"end":return t.stop()}}),t,null,[[0,31]])})))).apply(this,arguments)}function St(t){return jt.apply(this,arguments)}function jt(){return(jt=J(R().mark((function t(e){var r,n,o;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=S()){t.next=4;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 4:return t.next=6,fetch("".concat(E).concat("/notifications/push/subscribe"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({subscription:e})});case 6:return n=t.sent,t.next=9,n.json();case 9:if(o=t.sent,n.ok){t.next=12;break}throw new Error(o.message||"Gagal menyimpan subscription push notification");case 12:return t.abrupt("return",o);case 15:return t.prev=15,t.t0=t.catch(0),console.error("Error subscribing push notification:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal berlangganan push notification"});case 19:case"end":return t.stop()}}),t,null,[[0,15]])})))).apply(this,arguments)}function Pt(){return _t.apply(this,arguments)}function _t(){return(_t=J(R().mark((function t(){var e,r,n;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=S()){t.next=4;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 4:return t.next=6,fetch("".concat(E).concat("/notifications/push/unsubscribe"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});case 6:return r=t.sent,t.next=9,r.json();case 9:if(n=t.sent,r.ok){t.next=12;break}throw new Error(n.message||"Gagal menghapus subscription push notification");case 12:return t.abrupt("return",n);case 15:return t.prev=15,t.t0=t.catch(0),console.error("Error unsubscribing push notification:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal berhenti berlangganan push notification"});case 19:case"end":return t.stop()}}),t,null,[[0,15]])})))).apply(this,arguments)}var Ot=function(){var t=J(R().mark((function t(e,r){var n,o,i;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=S()){t.next=4;break}throw new Error("Authentication token not found");case 4:if(e){t.next=6;break}throw new Error("Story ID is required for editing");case 6:return t.next=8,fetch("".concat(E,"/stories/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({content:r})});case 8:return o=t.sent,t.next=11,o.json();case 11:if(i=t.sent,o.ok){t.next=15;break}throw console.error("Error editing story ".concat(e," - Status: ").concat(o.status),i),new Error(i.message||"Failed to edit story. Status: ".concat(o.status));case 15:return t.abrupt("return",i);case 18:throw t.prev=18,t.t0=t.catch(0),console.error("Error editing story (catch block) for ID ".concat(e,":"),t.t0),t.t0;case 22:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(e,r){return t.apply(this,arguments)}}(),Tt=function(){var t=J(R().mark((function t(e){var r,n,o;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=S()){t.next=4;break}throw new Error("Authentication token not found");case 4:if(e){t.next=6;break}throw new Error("Story ID is required for deleting");case 6:return t.next=8,fetch("".concat(E,"/stories/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r)}});case 8:if((n=t.sent).ok){t.next=22;break}return o={message:"Failed to delete story. Status: ".concat(n.status)},t.prev=11,t.next=14,n.json();case 14:o=t.sent,t.next=20;break;case 17:t.prev=17,t.t0=t.catch(11),console.warn("Could not parse error response as JSON for deleteStory");case 20:throw console.error("Error deleting story ".concat(e," - Status: ").concat(n.status),o),new Error(o.message||"Failed to delete story. Status: ".concat(n.status));case 22:if(204!==n.status){t.next=24;break}return t.abrupt("return",{success:!0,message:"Story deleted successfully."});case 24:return t.next=26,n.json();case 26:return t.abrupt("return",t.sent);case 29:throw t.prev=29,t.t1=t.catch(0),console.error("Error deleting story (catch block) for ID ".concat(e,":"),t.t1),t.t1;case 33:case"end":return t.stop()}}),t,null,[[0,29],[11,17]])})));return function(e){return t.apply(this,arguments)}}();function It(t,e){return Ct.apply(this,arguments)}function Ct(){return(Ct=J(R().mark((function t(e,r){var n;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(E,"/comments/").concat(e,"/replies"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(S())},body:JSON.stringify({content:r})});case 2:return n=t.sent,t.next=5,n.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Nt(t){return Lt.apply(this,arguments)}function Lt(){return(Lt=J(R().mark((function t(e){var r;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(E,"/comments/").concat(e,"/likes"),{method:"POST",headers:{Authorization:"Bearer ".concat(S())}});case 2:return r=t.sent,t.next=5,r.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Gt(t){return At.apply(this,arguments)}function At(){return(At=J(R().mark((function t(e){var r;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(E,"/comments/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(S())}});case 2:return r=t.sent,t.next=5,r.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Bt(t){return Mt.apply(this,arguments)}function Mt(){return(Mt=J(R().mark((function t(e){var r;return R().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(E,"/comments/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(S())}});case 2:if((r=t.sent).ok){t.next=5;break}throw new Error("Failed to fetch comment detail: ".concat(r.statusText));case 5:return t.next=7,r.json();case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Dt(t){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function Ft(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Ht(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ht(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ut(){Ut=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==Dt(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Dt(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function zt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function qt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?zt(Object(r),!0).forEach((function(e){Rt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Rt(t,e,r){return(e=Kt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Jt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Wt(i,n,o,a,s,"next",t)}function s(t){Wt(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Kt(n.key),n)}}function Kt(t){var e=function(t){if("object"!=Dt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Dt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Dt(e)?e:e+""}var Vt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=e,this._stories=[]},e=[{key:"loadStories",value:(p=Jt(Ut().mark((function t(){var e;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,it();case 3:(e=t.sent).error?console.error("Error loading stories:",e.message):(this._stories=(e.data||[]).map((function(t){var e,r;return qt(qt({},t),{},{likeCount:(null===(e=t.likes)||void 0===e?void 0:e.length)||0,commentCount:(null===(r=t.comments)||void 0===r?void 0:r.length)||0})})),console.log("Stories loaded successfully:",this._stories),this._view.showStories(this._stories)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Failed to load stories:",t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return p.apply(this,arguments)})},{key:"postNewStory",value:(d=Jt(Ut().mark((function t(e,r){var n,o,i,a;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e&&"string"==typeof e&&""!==e.trim()){t.next=3;break}throw new Error("Content is required");case 3:return t.next=5,st(e,r);case 5:if(!(n=t.sent).error){t.next=10;break}throw o=n.message||"Gagal mengunggah cerita. Respons server tidak valid.",console.error("Error posting story:",o,n),new Error(o);case 10:if((i=n.data)&&(i.id||i._id)){t.next=14;break}throw console.error("API response for new story is missing a story ID in data.",n),new Error("Cerita berhasil diunggah, namun ID cerita tidak diterima dari server.");case 14:return a={id:i._id||i.id,name:r?"Pengguna":i.name,username:r?null:i.username,content:i.content,isAnonymous:i.isAnonymous,likes:i.likes||[],comments:i.comments||[],createdAt:i.createdAt,views:i.views||0,likeCount:(i.likes||[]).length,commentCount:(i.comments||[]).length},this._stories.unshift(a),this._view.showStories(this._stories),this._view.clearForm(),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{story:a,action:"posted"}})),t.abrupt("return",!0);case 22:return t.prev=22,t.t0=t.catch(0),console.error("Failed to post story:",t.t0),t.t0.message.includes("Content is required")?alert("Content tidak boleh kosong"):t.t0.message.includes("Gagal mengunggah cerita")||t.t0.message.includes("ID cerita tidak diterima")?alert("Gagal mengunggah cerita: "+t.t0.message):alert("Terjadi kesalahan. Silakan coba lagi."),t.abrupt("return",!1);case 27:case"end":return t.stop()}}),t,this,[[0,22]])}))),function(t,e){return d.apply(this,arguments)})},{key:"getCurrentUser",value:function(){try{return JSON.parse(localStorage.getItem("user"))||{}}catch(t){return console.error("Error getting user data:",t),null}}},{key:"getCompleteUserData",value:(f=Jt(Ut().mark((function t(e){var r,n,o,i;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}return t.abrupt("return",null);case 3:return t.next=5,ct(e);case 5:if(!(i=t.sent).error){t.next=9;break}return console.error("Error getting user profile:",i.message),t.abrupt("return",null);case 9:return t.abrupt("return",{name:(null===(r=i.data)||void 0===r?void 0:r.name)||"Pengguna",username:(null===(n=i.data)||void 0===n?void 0:n.username)||null,profilePicture:(null===(o=i.data)||void 0===o?void 0:o.profilePicture)||"./images/image.png"});case 12:return t.prev=12,t.t0=t.catch(0),console.error("Error getting user data:",t.t0),t.abrupt("return",null);case 16:case"end":return t.stop()}}),t,null,[[0,12]])}))),function(t){return f.apply(this,arguments)})},{key:"loadStoryDetail",value:(h=Jt(Ut().mark((function t(e){var r,n,o,i,a,s,u,c,l,h,f,d,p,v;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(o=e)&&"undefined"!==o){t.next=11;break}if(i=window.location.hash,!(a=i.match(/#\/story\/([a-f0-9]+)/i))||!a[1]){t.next=9;break}o=a[1],t.next=11;break;case 9:return console.error("Invalid story ID provided to loadStoryDetail:",o),t.abrupt("return");case 11:return t.next=13,ht(o);case 13:if("string"!=typeof(s=t.sent)||!s.startsWith("<!DOCTYPE")){t.next=16;break}throw new Error("Server returned HTML instead of JSON");case 16:if(s&&!s.error){t.next=21;break}return u=(null==s?void 0:s.message)||"Failed to load story details",console.error("Error loading story detail:",u),this._view.showError("Gagal memuat detail story. Silakan coba lagi."),t.abrupt("return");case 21:if((c=s.data).likeCount=(null===(r=c.likes)||void 0===r?void 0:r.length)||0,c.commentCount=(null===(n=c.comments)||void 0===n?void 0:n.length)||0,c.isAnonymous||!c.username){t.next=32;break}return t.next=27,this.getCompleteUserData(c.username);case 27:l=t.sent,c.profilePicture=(null==l?void 0:l.profilePicture)||"./images/image.png",c.name=(null==l?void 0:l.name)||c.name,t.next=34;break;case 32:c.profilePicture="./images/image.png",c.name="Pengguna";case 34:if(!(c.comments&&c.comments.length>0)){t.next=67;break}h=Ft(c.comments),t.prev=36,h.s();case 38:if((f=h.n()).done){t.next=59;break}if((d=f.value).isCommentAnonymous=!0,d.authorActualUsername=null,!d.username){t.next=54;break}return p=d.username,d.authorActualUsername=p,t.next=47,this.getCompleteUserData(p);case 47:v=t.sent,d.profilePicture=(null==v?void 0:v.profilePicture)||"./images/image.png",d.displayName=(null==v?void 0:v.name)||p,d.handleName="@".concat(p),d.isCommentAnonymous=!1,t.next=57;break;case 54:d.profilePicture="./images/image.png",d.displayName="Pengguna",d.handleName="Anonim";case 57:t.next=38;break;case 59:t.next=64;break;case 61:t.prev=61,t.t0=t.catch(36),h.e(t.t0);case 64:return t.prev=64,h.f(),t.finish(64);case 67:this._view.showStoryDetail(c),t.next=74;break;case 70:t.prev=70,t.t1=t.catch(0),console.error("Failed to load story detail:",t.t1),this._view.showError("Terjadi kesalahan saat memuat detail story.");case 74:case"end":return t.stop()}}),t,this,[[0,70],[36,61,64,67]])}))),function(t){return h.apply(this,arguments)})},{key:"getStoryById",value:(l=Jt(Ut().mark((function t(e){var r;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ht(e);case 3:if((r=t.sent).error){t.next=6;break}return t.abrupt("return",r.data);case 6:throw new Error(r.message||"Failed to get story");case 9:throw t.prev=9,t.t0=t.catch(0),console.error("Error getting story:",t.t0),t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,9]])}))),function(t){return l.apply(this,arguments)})},{key:"likeStory",value:(c=Jt(Ut().mark((function t(e){var r,n,o,i,a,s;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}throw new Error("Invalid story ID");case 3:return t.next=5,ft(e);case 5:if(!(o=t.sent).error){t.next=8;break}throw new Error(o.message||"Failed to like story");case 8:return i=Array.isArray(null===(r=o.data)||void 0===r?void 0:r.likes)?o.data.likes.length:"number"==typeof o.data?o.data:0,-1!==(a=this._stories.findIndex((function(t){return t.id===e||t._id===e})))&&(this._stories[a].likeCount=i,Array.isArray(null===(s=o.data)||void 0===s?void 0:s.likes)&&(this._stories[a].likes=o.data.likes)),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:e,action:"liked",newLikeCount:i,likes:null===(n=o.data)||void 0===n?void 0:n.likes}})),t.abrupt("return",i);case 15:throw t.prev=15,t.t0=t.catch(0),console.error("Failed to like story:",t.t0),t.t0;case 19:case"end":return t.stop()}}),t,this,[[0,15]])}))),function(t){return c.apply(this,arguments)})},{key:"addComment",value:(u=Jt(Ut().mark((function t(e,r){var n,o,i,a;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r&&"string"==typeof r&&""!==r.trim()){t.next=3;break}throw new Error("Content is required");case 3:if((n=e)&&"undefined"!==n){t.next=12;break}if(o=window.location.hash,!(i=o.match(/#\/story\/([a-f0-9]+)/i))||!i[1]){t.next=11;break}n=i[1],t.next=12;break;case 11:throw new Error("Invalid story ID");case 12:return t.next=14,pt(n,r);case 14:if((a=t.sent).error){t.next=23;break}if("function"!=typeof this._view.showStoryDetail){t.next=19;break}return t.next=19,this.loadStoryDetail(n);case 19:return document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:n,action:"commented",newCommentId:a.commentId,currentCommentCount:a.commentCount,message:a.message}})),t.abrupt("return",!0);case 23:throw new Error(a.message||"Failed to post comment");case 24:t.next=30;break;case 26:throw t.prev=26,t.t0=t.catch(0),console.error("Failed to post comment in addComment:",t.t0),t.t0;case 30:case"end":return t.stop()}}),t,this,[[0,26]])}))),function(t,e){return u.apply(this,arguments)})},{key:"loadCommentDetail",value:(s=Jt(Ut().mark((function t(e){var r;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Bt(e);case 3:!(r=t.sent).error&&r.data?this._view.showCommentDetail(r.data):(console.error("Error loading comment detail:",r.message),this._view.showError(r.message||"Gagal memuat detail komentar.")),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Failed to load comment detail:",t.t0),this._view.showError("Terjadi kesalahan saat memuat detail komentar.");case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return s.apply(this,arguments)})},{key:"addReplyToComment",value:(a=Jt(Ut().mark((function t(e,r){var n;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r&&"string"==typeof r&&""!==r.trim()){t.next=3;break}throw new Error("Konten balasan tidak boleh kosong");case 3:return t.next=5,It(e,r.trim());case 5:if(!(n=t.sent).error){t.next=8;break}throw new Error(n.message||"Gagal menambahkan balasan.");case 8:return document.dispatchEvent(new CustomEvent("commentDataChanged",{detail:{action:"replied",parentId:e,replyId:n.replyId}})),t.abrupt("return",n);case 12:throw t.prev=12,t.t0=t.catch(0),console.error("Failed to add reply:",t.t0),t.t0;case 16:case"end":return t.stop()}}),t,null,[[0,12]])}))),function(t,e){return a.apply(this,arguments)})},{key:"likeExistingComment",value:(i=Jt(Ut().mark((function t(e){var r;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Nt(e);case 3:if(!(r=t.sent).error){t.next=6;break}throw new Error(r.message||"Gagal menyukai komentar.");case 6:return document.dispatchEvent(new CustomEvent("commentDataChanged",{detail:{action:"commentLiked",entityId:e,newLikeCount:r.likeCount,message:r.message}})),t.abrupt("return",r);case 10:throw t.prev=10,t.t0=t.catch(0),console.error("Failed to like comment:",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[0,10]])}))),function(t){return i.apply(this,arguments)})},{key:"deleteExistingComment",value:(o=Jt(Ut().mark((function t(e){var r;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Gt(e);case 3:if(!(r=t.sent).error){t.next=6;break}throw new Error(r.message||"Gagal menghapus komentar.");case 6:return document.dispatchEvent(new CustomEvent("commentDataChanged",{detail:{action:"commentDeleted",entityId:e}})),t.abrupt("return",r);case 10:throw t.prev=10,t.t0=t.catch(0),console.error("Failed to delete comment:",t.t0),t.t0;case 14:case"end":return t.stop()}}),t,null,[[0,10]])}))),function(t){return o.apply(this,arguments)})},{key:"editStory",value:(n=Jt(Ut().mark((function t(e,r){var n,o;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r&&"string"==typeof r&&""!==r.trim()){t.next=3;break}throw new Error("Content is required");case 3:return t.next=5,Ot(e,r.trim());case 5:if(!(n=t.sent).error){t.next=8;break}throw new Error(n.message);case 8:return-1!==(o=this._stories.findIndex((function(t){return t.id===e||t._id===e})))&&(this._stories[o]=qt(qt({},this._stories[o]),{},{content:n.data.content,updatedAt:n.data.updatedAt})),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:e,action:"edited",updatedStory:n.data}})),t.abrupt("return",!0);case 14:throw t.prev=14,t.t0=t.catch(0),console.error("Failed to edit story:",t.t0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(t,e){return n.apply(this,arguments)})},{key:"deleteStory",value:(r=Jt(Ut().mark((function t(e){var r;return Ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Tt(e);case 3:if(!(r=t.sent).error){t.next=6;break}throw new Error(r.message);case 6:return this._stories=this._stories.filter((function(t){return t.id!==e&&t._id!==e})),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:e,action:"deleted"}})),t.abrupt("return",!0);case 11:throw t.prev=11,t.t0=t.catch(0),console.error("Failed to delete story:",t.t0),t.t0;case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t){return r.apply(this,arguments)})}],e&&Yt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s,u,c,l,h,f,d,p}();function $t(t){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(t)}function Xt(){Xt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==$t(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError($t(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Qt(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Zt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Qt(i,n,o,a,s,"next",t)}function s(t){Qt(i,n,o,a,s,"throw",t)}a(void 0)}))}}var te=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"stories-container",r=document.getElementById(e);if(r){var n="_storyInteractionHandler_".concat(e);r[n]&&r.removeEventListener("click",r[n]),r[n]=function(){var e=Zt(Xt().mark((function e(r){var n,o,i;return Xt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.target.closest(".story-container")){e.next=3;break}return e.abrupt("return");case 3:if(o=n.dataset.storyId){e.next=6;break}return e.abrupt("return");case 6:if(!r.target.closest(".story-menu-btn")&&!r.target.closest(".story-menu")){e.next=8;break}return e.abrupt("return");case 8:if(!(r.target.closest(".like-btn")||r.target.closest(".comment-btn")||r.target.closest(".view-btn")||r.target.closest(".user-info"))){e.next=11;break}e.next=13;break;case 11:return window.location.hash="#/story/".concat(o),e.abrupt("return");case 13:if(!(i=r.target.closest(".like-btn"))){e.next=19;break}return r.stopPropagation(),e.next=18,ee(t,o,i);case 18:return e.abrupt("return");case 19:if(!r.target.closest(".comment-btn")){e.next=24;break}return r.stopPropagation(),window.location.hash="#/story/".concat(o),e.abrupt("return");case 24:if(!r.target.closest(".view-btn")){e.next=29;break}return r.stopPropagation(),window.location.hash="#/story/".concat(o),e.abrupt("return");case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.addEventListener("click",r[n])}},ee=function(){var t=Zt(Xt().mark((function t(e,r,n){var o,i,a;return Xt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.disabled){t.next=2;break}return t.abrupt("return");case 2:return o=n.innerHTML,n.disabled=!0,t.prev=4,t.next=7,e.likeStory(r);case 7:"number"==typeof(i=t.sent)&&((a=n.querySelector(".like-count"))&&(a.textContent=i),n.querySelector("svg")),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(4),console.error("Error handling like:",t.t0),alert("Gagal menyukai cerita: "+(t.t0.message||"Terjadi kesalahan")),n.innerHTML=o;case 16:return t.prev=16,n.disabled=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[4,11,16,19]])})));return function(e,r,n){return t.apply(this,arguments)}}();function re(t){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},re(t)}function ne(){ne=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==re(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(re(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function oe(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function ie(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){oe(i,n,o,a,s,"next",t)}function s(t){oe(i,n,o,a,s,"throw",t)}a(void 0)}))}}var ae=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"stories-container",r=document.getElementById(e);if(r){var n=null;r.addEventListener("click",(function(t){var e=t.target.closest(".story-menu-btn");if(e){t.stopPropagation();var r=e.nextElementSibling;document.querySelectorAll(".story-menu").forEach((function(t){t===r||t.classList.contains("hidden")||t.classList.add("hidden")})),r.classList.toggle("hidden"),n=r.classList.contains("hidden")?null:r}})),document.addEventListener("click",(function(t){n&&!n.classList.contains("hidden")&&(n.contains(t.target)||t.target.closest(".story-menu-btn")||(n.classList.add("hidden"),n=null))})),r.addEventListener("click",function(){var t=ie(ne().mark((function t(e){var r,o,i,a,s,u;return ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=e.target.closest(".edit-story-btn"))){t.next=18;break}if(e.stopPropagation(),(o=r.closest(".story-menu"))&&o.classList.add("hidden"),n=null,i=r.dataset.storyId,a=r.closest(".story-container")){t.next=11;break}return console.error("Story container not found for edit button:",r),t.abrupt("return");case 11:if(s=a.querySelector(".story-content p")){t.next=16;break}return console.error("Content paragraph not found within story container for story ID:",i,a),alert("Tidak dapat menemukan konten cerita untuk diedit."),t.abrupt("return");case 16:u=s.textContent,document.dispatchEvent(new CustomEvent("showEditStoryModalRequest",{detail:{storyId:i,currentContent:u}}));case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),r.addEventListener("click",function(){var e=ie(ne().mark((function e(r){var o,i,a;return ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=r.target.closest(".delete-story-btn"))){e.next=16;break}if(r.stopPropagation(),(i=o.closest(".story-menu"))&&i.classList.add("hidden"),n=null,a=o.dataset.storyId,!confirm("Apakah Anda yakin ingin menghapus cerita ini?")){e.next=16;break}return e.prev=8,e.next=11,t.deleteStory(a);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),alert(e.t0.message||"Gagal menghapus cerita");case 16:case"end":return e.stop()}}),e,null,[[8,13]])})));return function(t){return e.apply(this,arguments)}}())}};function se(t){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},se(t)}function ue(){ue=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==se(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(se(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function ce(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function le(t,e,r){var n=document.getElementById("editStoryModal");n&&n.remove();var o='\n    <div id="editStoryModal" class="fixed inset-0 items-center justify-center bg-black/40 z-50 hidden">\n      <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">\n        <div class="flex justify-between items-center mb-4">\n          <h3 class="text-lg font-semibold">Edit Cerita</h3>\n          <button id="closeEditStoryModalBtn" class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>\n        </div>\n        <hr class="my-4 border-gray-300">\n        <form id="editStoryForm" class="space-y-4">\n          <div>\n            <label for="storyContentInput" class="block text-sm font-medium text-gray-700 mb-1">Konten Cerita</label>\n            <textarea id="storyContentInput" name="content" rows="6"\n              class="w-full border border-gray-300 rounded-lg p-2 focus:ring-teal-500 focus:border-teal-500"\n              placeholder="Tuliskan ceritamu di sini...">'.concat({content:e}.content||"",'</textarea>\n          </div>\n          <div class="flex justify-end gap-3 pt-4">\n            <button type="button" id="cancelEditStoryBtn"\n              class="w-auto border border-gray-300 py-2 px-4 rounded-lg text-gray-700 hover:bg-gray-50">Batal</button>\n            <button type="submit"\n              class="w-auto bg-teal-500 text-white py-2 px-4 rounded-lg hover:bg-teal-600">Simpan Perubahan</button>\n          </div>\n        </form>\n      </div>\n    </div>\n  ');document.body.insertAdjacentHTML("beforeend",o);var i=document.getElementById("editStoryModal"),a=document.getElementById("closeEditStoryModalBtn"),s=document.getElementById("cancelEditStoryBtn"),u=document.getElementById("editStoryForm"),c=document.getElementById("storyContentInput"),l=u?u.querySelector('button[type="submit"]'):null;if(!(i&&a&&s&&u&&c&&l))return console.error("Error: One or more elements for the edit story modal were not found in the DOM. Template IDs might be incorrect."),void(i&&i.remove());i.classList.remove("hidden"),i.classList.add("flex");var h=function(){i.classList.add("hidden"),i.classList.remove("flex"),setTimeout((function(){i.remove()}),300)};a.addEventListener("click",h),s.addEventListener("click",h),i.addEventListener("click",(function(t){t.target===i&&h()})),u.addEventListener("submit",function(){var e,n=(e=ue().mark((function e(n){var o,i;return ue().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),o=c.value.trim()){e.next=5;break}return alert("Konten cerita tidak boleh kosong."),e.abrupt("return");case 5:return i=l.textContent,l.disabled=!0,l.textContent="Menyimpan...",e.prev=8,e.next=11,r.editStory(t,o);case 11:h(),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(8),console.error("Failed to edit story:",e.t0),alert(e.t0.message||"Gagal menyimpan perubahan cerita.");case 18:return e.prev=18,l.disabled=!1,l.textContent=i,e.finish(18);case 22:case"end":return e.stop()}}),e,null,[[8,14,18,22]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(t){ce(i,n,o,a,s,"next",t)}function s(t){ce(i,n,o,a,s,"throw",t)}a(void 0)}))});return function(t){return n.apply(this,arguments)}}())}function he(t){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},he(t)}function fe(){fe=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==he(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(he(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function de(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function pe(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){de(i,n,o,a,s,"next",t)}function s(t){de(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ve(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,we(n.key),n)}}function me(t,e,r){ye(t,e),e.set(t,r)}function ye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ge(t,e,r){return(e=we(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function we(t){var e=function(t){if("object"!=he(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=he(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==he(e)?e:e+""}function be(t,e){return t.get(ke(t,e))}function xe(t,e,r){return t.set(ke(t,e),r),r}function ke(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ee=new WeakMap,Se=new WeakMap,je=new WeakSet,Pe=function(){return t=function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ye(this,e=je),e.add(this),ge(this,"_presenter",null),ge(this,"_currentUser",null),me(this,Ee,null),me(this,Se,null),this._presenter=new Vt(this)},e=[{key:"render",value:(i=pe(fe().mark((function t(){var e,r,n,o,i,a;return fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._currentUser=JSON.parse(localStorage.getItem("user"))||{},o=(null===(e=this._currentUser)||void 0===e?void 0:e.name)||"Nama Pengguna",i=null!==(r=this._currentUser)&&void 0!==r&&r.username?"@".concat(this._currentUser.username):"@namapengguna",a=(null===(n=this._currentUser)||void 0===n?void 0:n.profilePicture)||"./images/image.png",t.abrupt("return",'\n        <div class="ml-16 min-h-screen p-10">\n          <div class="mb-1">\n            <h1 class="text-2xl font-semibold text-gray-900 mb-2">Story MindBlown</h1>\n            <p class="text-gray-600">Berbagi cerita, temukan makna.</p>\n            <hr class="mt-4 text-gray-300">\n          </div>\n\n          <div class="grid grid-cols-2 gap-4 h-screen">\n            <div class="overflow-y-auto p-6 mr-10 border-gray-200">\n              <div id="stories-container" class="space-y-6">\n              </div>\n            </div>\n\n            <div class="p-6">\n              <div class="space-y-6 mt-4">\n                '.concat(y({username:o,handle:i,profilePicture:a}),"\n              </div>\n            </div>\n          </div>\n        </div>\n      "));case 8:return t.prev=8,t.t0=t.catch(0),console.error("Error rendering StoryPage:",t.t0),t.abrupt("return",'\n        <div class="ml-16 min-h-screen p-10 flex justify-center items-center">\n          <p class="text-red-500">Gagal memuat halaman cerita. Silakan coba lagi nanti.</p>\n        </div>\n      ');case 12:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(o=pe(fe().mark((function t(){return fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._presenter.loadStories();case 3:this._setupFormSubmit(),ke(je,this,_e).call(this),ke(je,this,Oe).call(this),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Error in afterRender (StoryPage):",t.t0),this.showError(t.t0.message||"Gagal memuat konten halaman cerita.");case 12:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return o.apply(this,arguments)})},{key:"showStories",value:(n=pe(fe().mark((function t(e){var r,n,o,i=this;return fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=document.getElementById("stories-container")){t.next=4;break}return console.error("StoryPage: 'stories-container' element not found."),t.abrupt("return");case 4:if(e&&0!==e.length){t.next=7;break}return n.innerHTML='<p class="text-gray-500 text-center py-8">Belum ada cerita untuk ditampilkan.</p>',t.abrupt("return");case 7:return this._currentUser=null!==(r=this._currentUser)&&void 0!==r&&r.username?this._currentUser:JSON.parse(localStorage.getItem("user"))||{},t.prev=8,t.next=11,Promise.all(e.map(function(){var t=pe(fe().mark((function t(e,r){var n,o,a,s,u,c,l,h,f,d;return fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=e.id||e._id||e.storyId||"story-".concat(r),u=!e.isAnonymous&&e.username===(null===(n=i._currentUser)||void 0===n?void 0:n.username),c="./images/image.png",l="Pengguna",h="Anonim",e.isAnonymous||!e.username){t.next=21;break}if(t.prev=6,null===(f=i._presenter)||void 0===f||!f.getCompleteUserData){t.next=13;break}return t.next=10,i._presenter.getCompleteUserData(e.username);case 10:t.t0=t.sent,t.next=14;break;case 13:t.t0=null;case 14:(d=t.t0)?(c=d.profilePicture||c,l=d.name||e.name||l,h="@".concat(d.username||e.username)):(c=e.profilePicture||c,l=e.name||l,h="@".concat(e.username)),t.next=21;break;case 18:t.prev=18,t.t1=t.catch(6),console.error("Error fetching profile for ".concat(e.username,":"),t.t1);case 21:return t.abrupt("return",m({username:l,handle:h,content:e.content,isAnonymous:e.isAnonymous,storyId:s,likeCount:e.likeCount||(null===(o=e.likes)||void 0===o?void 0:o.length)||0,commentCount:e.commentCount||(null===(a=e.comments)||void 0===a?void 0:a.length)||0,viewCount:e.viewCount||e.views||0,profilePicture:c,createdAt:e.createdAt,isOwner:u}));case 22:case"end":return t.stop()}}),t,null,[[6,18]])})));return function(e,r){return t.apply(this,arguments)}}()));case 11:o=t.sent,n.innerHTML=o.join(""),this._presenter&&(te(this._presenter,"stories-container"),ae(this._presenter,"stories-container")),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(8),console.error("Error rendering stories:",t.t0),n.innerHTML="<div>Error loading stories</div>";case 20:case"end":return t.stop()}}),t,this,[[8,16]])}))),function(t){return n.apply(this,arguments)})},{key:"_setupFormSubmit",value:function(){var t=this,e=document.getElementById("chat-form");e&&e.addEventListener("submit",function(){var r=pe(fe().mark((function r(n){var o,i,a,s,u;return fe().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.preventDefault(),o=document.getElementById("chat-input"),i=document.getElementById("post-anonymously"),a=!!i&&i.checked,s=e.querySelector('button[type="submit"]'),u=s.textContent,o&&o.value.trim()){r.next=9;break}return alert("Silakan masukkan konten cerita."),r.abrupt("return");case 9:if(s.disabled=!0,s.textContent="Mengunggah...",r.prev=11,!t._presenter){r.next=16;break}return r.next=15,t._presenter.postNewStory(o.value.trim(),a);case 15:r.sent;case 16:r.next=22;break;case 18:r.prev=18,r.t0=r.catch(11),console.error("Error submitting story:",r.t0),alert(r.t0.message||"Gagal mengunggah cerita.");case 22:return r.prev=22,s.disabled=!1,s.textContent=u,r.finish(22);case 26:case"end":return r.stop()}}),r,null,[[11,18,22,26]])})));return function(t){return r.apply(this,arguments)}}())}},{key:"_getProfilePicture",value:(r=pe(fe().mark((function t(e){var r;return fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return","./images/image.png");case 2:return t.prev=2,t.next=5,getUserProfile(e);case 5:return r=t.sent,t.abrupt("return",r.profilePicture||"./images/image.png");case 9:return t.prev=9,t.t0=t.catch(2),console.error("Error getting profile picture:",t.t0),t.abrupt("return","./images/image.png");case 13:case"end":return t.stop()}}),t,null,[[2,9]])}))),function(t){return r.apply(this,arguments)})},{key:"clearForm",value:function(){try{var t=document.getElementById("chat-input");t&&(t.value="");var e=document.getElementById("post-anonymously");e&&(e.checked=!1)}catch(t){console.error("Error clearing form:",t)}}},{key:"showError",value:function(t){var e=document.getElementById("stories-container");if(e)e.innerHTML='<p class="text-red-500 p-4 text-center">'.concat(t,"</p>");else{var r=document.querySelector(".ml-16.min-h-screen.p-10");r?r.innerHTML='<p class="text-red-500 p-6 text-center">'.concat(t,"</p>"):alert(t)}}}],e&&ve(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}();function _e(){var t=this;xe(Ee,this,(function(e){var r=e.detail,n=r.storyId,o=r.currentContent;t._presenter&&"function"==typeof t._presenter.editStory?le(n,o,t._presenter):(console.error("StoryPage: Presenter or presenter.editStory method is not available."),alert("Tidak dapat mengedit cerita saat ini."))})),document.addEventListener("showEditStoryModalRequest",be(Ee,this))}function Oe(){var t=this;xe(Se,this,function(){var e=pe(fe().mark((function e(r){var n,o;return fe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.detail,o=n.action,n.storyId,!["posted","edited","deleted","liked","commented"].includes(o)){e.next=6;break}if(console.log("StoryPage: Reloading stories due to storyDataChanged",r.detail),!t._presenter){e.next=6;break}return e.next=6,t._presenter.loadStories();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),document.addEventListener("storyDataChanged",be(Se,this))}function Te(t,e){var r=t.getFullYear(),n=t.getMonth();document.getElementById("monthDisplay").textContent="".concat(e[n]," ").concat(r);for(var o=new Date(r,n,1),i=new Date(r,n+1,0),a=o.getDay(),s=i.getDate(),u=new Date(r,n,0).getDate(),c=document.getElementById("calendarDays"),l="",h=a;h>0;h--)l+='\n            <div class="flex items-center justify-center border-t border-r border-gray-100 p-2 h-20 md:h-25 lg:h-30">\n                <span class="text-sm text-gray-400">'.concat(u-h+1,"</span>\n            </div>");for(var f=1;f<=s;f++){var d=f===(new Date).getDate()&&n===(new Date).getMonth()&&r===(new Date).getFullYear(),p=d?"bg-blue-50 text-blue-600 font-semibold":"hover:bg-gray-50",v=(n+1).toString().padStart(2,"0"),m=f.toString().padStart(2,"0");l+='\n            <div class="flex items-center justify-center border-t border-r border-gray-100 p-2 h-20 md:h-25 lg:h-30 '.concat(p,'" data-date="').concat(r,"-").concat(v,"-").concat(m,'">\n                <span class="text-sm ').concat(d?"text-blue-600":"text-gray-700",'">').concat(f,"</span>\n            </div>")}for(var y=35-(a+s),g=1;g<=y;g++)l+='\n            <div class="flex items-center justify-center border-t border-r border-gray-100 p-2 h-20 md:h-25 lg:h-30">\n                <span class="text-sm text-gray-400">'.concat(g,"</span>\n            </div>");c.innerHTML=l}function Ie(t){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ie(t)}function Ce(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ne(){Ne=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==Ie(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ie(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Le(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Ge(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Le(i,n,o,a,s,"next",t)}function s(t){Le(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Ae(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Be(n.key),n)}}function Be(t){var e=function(t){if("object"!=Ie(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ie(e)?e:e+""}var Me=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentDate=new Date,this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"]},e=[{key:"checkTodayEntry",value:(o=Ge(Ne().mark((function t(){var e;return Ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("Presenter: Checking today entry"),t.next=4,Z();case 4:return e=t.sent,t.abrupt("return",{exists:e.exists,formattedDate:this.formatDate(this.currentDate)});case 8:throw t.prev=8,t.t0=t.catch(0),console.error("Presenter: Error checking today entry:",t.t0),t.t0;case 12:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return o.apply(this,arguments)})},{key:"getEntryByDate",value:(n=Ge(Ne().mark((function t(e){var r;return Ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("Presenter: Getting entry for date:",e),t.next=4,et(e);case 4:return r=t.sent,t.abrupt("return",{data:r.data,formattedDate:this.formatDate(new Date(e))});case 8:throw t.prev=8,t.t0=t.catch(0),console.error("Presenter: Error getting entry by date:",t.t0),t.t0;case 12:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(t){return n.apply(this,arguments)})},{key:"saveEntry",value:(r=Ge(Ne().mark((function t(e){var r;return Ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("Presenter: Saving entry data:",e),t.next=4,nt(e);case 4:return r=t.sent,console.log("Presenter: Save entry result:",r),t.abrupt("return",r);case 9:throw t.prev=9,t.t0=t.catch(0),console.error("Presenter: Error saving entry:",t.t0),t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,9]])}))),function(t){return r.apply(this,arguments)})},{key:"getCurrentDate",value:function(){return this.currentDate}},{key:"setCurrentDate",value:function(t){this.currentDate=t}},{key:"getMonthNames",value:function(){return this.monthNames}},{key:"formatDate",value:function(t){return t.toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})}},{key:"parseDateString",value:function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);u=!0);}catch(t){c=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ce(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ce(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.match(/(\d+)\s+(\w+)\s+(\d+)/),4),r=(e[0],e[1]),n=e[2],o=e[3];return new Date(o,{Januari:0,Februari:1,Maret:2,April:3,Mei:4,Juni:5,Juli:6,Agustus:7,September:8,Oktober:9,November:10,Desember:11}[n],r)}}],e&&Ae(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function De(t){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},De(t)}function Fe(){Fe=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==De(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(De(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function He(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Ue(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){He(i,n,o,a,s,"next",t)}function s(t){He(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ze(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qe(n.key),n)}}function qe(t){var e=function(t){if("object"!=De(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=De(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==De(e)?e:e+""}var Re=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.presenter=new Me},e=[{key:"render",value:(o=Ue(Fe().mark((function t(){var e;return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[{date:"Kamis, 1 Mei",emoji:""},{date:"Jumat, 2 Mei",emoji:""},{date:"Sabtu, 3 Mei",emoji:""},{date:"Minggu, 4 Mei",emoji:""},{date:"Senin, 5 Mei",emoji:""}],t.abrupt("return",'\n        <div class="p-4 lg:p-8 pb-20 lg:pb-10 md:pb-10">\n        <div class="max-w-md md:max-w-[90%] ml-0 md:ml-16 lg:ml-24 mx-auto">\n            <div class="mb-4">\n                <h1 class="text-2xl font-semibold text-gray-900 mb-2">Mind Tracker</h1>\n                <p class="text-gray-600 text-sm lg:text-md">Hari ini rasanya gimana? Ini tracker ini buat bantu kamu lebih sadar sama perasaan dan progressmu.</p>\n                <hr class="mt-4 text-gray-300">\n            </div>\n\n            <div class="mb-6">\n                <button id="trackTodayBtn" class="bg-third hover:bg-teal-700 text-white px-3 lg:px-4 py-2 rounded-md flex items-center">\n                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>\n                    </svg>\n                    Yuk Track Your Mind !\n                </button>\n            </div>\n\n            <div>\n             <h2 class="font-semibold text-base mb-1 lg:mb-3">Mood dalam 1 Minggu</h2> \n             '.concat(p(e),'\n            </div>\n\n            <div class="flex items-center justify-between py-2">\n                <h2 id="monthDisplay" class="text-xl font-semibold text-gray-800">\n                    May 2025\n                </h2>\n\n                <div class="flex items-center space-x-2">\n                    <button id="todayBtn"\n                    class="bg-gray-200 text-gray-400 text-sm px-4 py-2 rounded-md">\n                    Today\n                    </button>\n\n                    <div class="flex rounded-md overflow-hidden border border-gray-200">\n                    <button id="prevMonth" class="px-3 py-2 bg-gray-100 hover:bg-gray-200">\n                        <svg class="w-4 h-4 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />\n                        </svg>\n                    </button>\n                    <button id="nextMonth" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 border-l border-gray-300">\n                        <svg class="w-4 h-4 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />\n                        </svg>\n                    </button>\n                    </div>\n                </div>\n                </div>\n\n\n            <div class="bg-white shadow-sm">\n                <div class="grid grid-cols-7 gap-0 border-t border-r border-gray-100">\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">Su</div>\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">Mo</div>\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">Tu</div>\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">We</div>\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">Th</div>\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">Fr</div>\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">Sa</div>\n\n                    <div id="calendarDays" class="col-span-7 grid grid-cols-7"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n      '));case 2:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(n=Ue(Fe().mark((function t(){var e=this;return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Te(this.presenter.getCurrentDate(),this.presenter.getMonthNames()),document.getElementById("prevMonth").addEventListener("click",(function(){var t=e.presenter.getCurrentDate();t.setMonth(t.getMonth()-1),e.presenter.setCurrentDate(t),Te(t,e.presenter.getMonthNames())})),document.getElementById("nextMonth").addEventListener("click",(function(){var t=e.presenter.getCurrentDate();t.setMonth(t.getMonth()+1),e.presenter.setCurrentDate(t),Te(t,e.presenter.getMonthNames())})),document.getElementById("todayBtn").addEventListener("click",(function(){e.presenter.setCurrentDate(new Date),Te(e.presenter.getCurrentDate(),e.presenter.getMonthNames())})),document.getElementById("trackTodayBtn").addEventListener("click",Ue(Fe().mark((function t(){var r;return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.presenter.checkTodayEntry();case 3:if(!(r=t.sent).exists){t.next=7;break}return alert("Anda sudah mengisi Mind Tracker untuk hari ini."),t.abrupt("return");case 7:e.showModal(r.formattedDate,null,!1),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),console.error("Error checking mind tracker entry:",t.t0),alert(t.t0.message||"Terjadi kesalahan server");case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))),document.getElementById("calendarDays").addEventListener("click",function(){var t=Ue(Fe().mark((function t(r){var n;return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=r.target.closest("div[data-date]"))&&e.handleDayClick(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 6:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"handleDayClick",value:(r=Ue(Fe().mark((function t(e){var r,n;return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return document.querySelectorAll("div[data-date]").forEach((function(t){t.classList.remove("bg-blue-100")})),e.classList.add("bg-blue-100"),r=e.getAttribute("data-date"),t.prev=3,t.next=6,this.presenter.getEntryByDate(r);case 6:n=t.sent,this.showModal(n.formattedDate,n.data,!0),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(3),console.error("Error fetching mind tracker data:",t.t0),alert(t.t0.message||"Terjadi kesalahan server");case 14:case"end":return t.stop()}}),t,this,[[3,10]])}))),function(t){return r.apply(this,arguments)})},{key:"showModal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=document.getElementById("mindTrackerModal");n&&n.remove();var o=!!document.getElementById("calendarDays").contains(document.activeElement)||r;document.body.insertAdjacentHTML("beforeend",function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return'\n    <div id="mindTrackerModal" class="fixed inset-0 items-center justify-center bg-black/40 z-50 hidden">\n        <div class="bg-white rounded-lg shadow-lg p-6 md:w-lg lg:w-full lg:max-w-lg">\n            <div class="flex justify-between items-center mb-4">\n                <h3 id="modalTitle" class="text-lg font-semibold">Mind Tracker</h3>\n                <button id="closeModalBtn" class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>\n            </div>\n            <hr class="my-4 text-gray-300">\n            <form id="mindTrackerForm">\n                <div class="text-center mb-4">\n                    <p class="text-sm my-4">Perasaanmu Hari ini</p>\n                    <div class="flex justify-center space-x-6 mb-2 gap-15">\n                        <label class="flex flex-col gap-3 cursor-pointer">\n                            <input type="radio" name="mood" value="buruk" class="hidden peer" required>\n                            <span class="text-3xl peer-checked:scale-125 transition"></span>\n                            <div class="text-xs">Buruk</div>\n                        </label>\n                        <label class="flex flex-col gap-3 cursor-pointer">\n                            <input type="radio" name="mood" value="oke" class="hidden peer" required>\n                            <span class="text-3xl peer-checked:scale-125 transition"></span>\n                            <div class="text-xs">Oke</div>\n                        </label>\n                        <label class="flex flex-col gap-3 cursor-pointer">\n                            <input type="radio" name="mood" value="sempurna" class="hidden peer" required>\n                            <span class="text-3xl peer-checked:scale-125 transition"></span>\n                            <div class="text-xs">Sempurna</div>\n                        </label>\n                    </div>\n                    <p class="mb-4 mt-8">Progres kamu</p>\n                    <textarea name="progress" class="w-full border p-2 rounded-xl overflow-hidden" rows="3" placeholder="Ceritakan bagaimana harimu dan perasaanmu sekarang" required '.concat(t?"readonly":"","></textarea>\n                </div>\n                ").concat(t?"":'\n                <div id="submit-mind-tracker" class="flex justify-end">\n                    <button type="submit" class="w-25 bg-third text-white py-2 rounded-lg mt-2 justify-end">Kirim</button>\n                </div>\n                ',"\n            </form>\n        </div>\n    </div>\n    ")}(o));var i=document.getElementById("mindTrackerModal"),a=document.getElementById("modalTitle"),s=(document.getElementById("closeModalBtn"),document.getElementById("mindTrackerForm"));if(a.textContent="Mind Tracker  ".concat(t),i.classList.remove("hidden"),i.classList.add("flex"),e&&(document.querySelector('input[name="mood"][value="'.concat(e.mood,'"]')).checked=!0,document.querySelector('textarea[name="progress"]').value=e.progress||""),o){var u=document.getElementById("mindTrackerForm");u&&(u.onsubmit=function(t){return t.preventDefault(),!1})}this.setupModalEventListeners(i,s,t)}},{key:"setupModalEventListeners",value:function(t,e,r){var n=this;document.getElementById("closeModalBtn").addEventListener("click",(function(){t.classList.add("hidden"),t.classList.remove("flex")})),t.addEventListener("click",(function(e){e.target===t&&(t.classList.add("hidden"),t.classList.remove("flex"))})),e&&e.addEventListener("submit",function(){var o=Ue(Fe().mark((function o(i){var a,s,u;return Fe().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i.preventDefault(),i.stopPropagation(),a=new FormData(e),s={date:n.presenter.parseDateString(r).toISOString(),mood:a.get("mood"),progress:a.get("progress")},o.prev=4,o.next=7,n.presenter.saveEntry(s);case 7:if((u=o.sent).error){o.next=16;break}t.classList.add("hidden"),t.classList.remove("flex"),e.reset(),Te(n.presenter.getCurrentDate(),n.presenter.getMonthNames()),alert(u.message),o.next=17;break;case 16:throw new Error(u.message);case 17:o.next=23;break;case 19:o.prev=19,o.t0=o.catch(4),console.error("Error saving mind tracker:",o.t0),alert(o.t0.message||"Terjadi kesalahan server");case 23:return o.abrupt("return",!1);case 24:case"end":return o.stop()}}),o,null,[[4,19]])})));return function(t){return o.apply(this,arguments)}}())}}],e&&ze(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function We(t){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},We(t)}function Je(){Je=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==We(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(We(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Ye(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Ke(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ye(i,n,o,a,s,"next",t)}function s(t){Ye(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Ve(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$e(n.key),n)}}function $e(t){var e=function(t){if("object"!=We(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=We(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==We(e)?e:e+""}var Xe=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e},e=[{key:"loadNotifications",value:(o=Ke(Je().mark((function t(){var e,r;return Je().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,gt();case 3:if(!(e=t.sent).error){t.next=7;break}return this.view.showError(e.message),t.abrupt("return");case 7:r=this.formatNotifications(e.data),this.view.displayNotifications(r),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("Error loading notifications:",t.t0),this.view.showError("Gagal memuat notifikasi");case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return o.apply(this,arguments)})},{key:"formatNotifications",value:function(t){var e=this;return t.map((function(t){return{id:t._id,icon:e.getNotificationIcon(t.type),title:e.getNotificationTitle(t.type),message:t.message,type:t.type,read:t.read,createdAt:t.createdAt,storyId:t.storyId,commentId:t.commentId,fromUsername:t.fromUsername}}))}},{key:"getNotificationTitle",value:function(t){return{comment:"Komentar Baru",reply:"Balasan Komentar",like:"Suka",story:"Story Baru",follow:"Pengikut Baru",reminder:"Pengingat",system:"Sistem"}[t]||"Notifikasi"}},{key:"getNotificationIcon",value:function(t){return{comment:"images/logo.png",reply:"images/logo.png",like:"images/logo.png",story:"images/logo.png",follow:"images/logo.png",reminder:"images/logo.png",system:"images/logo.png"}[t]||"images/logo.png"}},{key:"markAsRead",value:(n=Ke(Je().mark((function t(e){var r;return Je().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,bt(e);case 3:if(!(r=t.sent).error){t.next=7;break}return console.error("Error marking notification as read:",r.message),t.abrupt("return",!1);case 7:return this.view.updateNotificationReadStatus(e),t.abrupt("return",!0);case 11:return t.prev=11,t.t0=t.catch(0),console.error("Error marking notification as read:",t.t0),t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t){return n.apply(this,arguments)})},{key:"markAllAsRead",value:(r=Ke(Je().mark((function t(){var e;return Je().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("Presenter: Marking all notifications as read"),t.next=4,kt();case 4:if(!(e=t.sent).error){t.next=14;break}if(console.error("Error marking all notifications as read:",e.message),!e.message.includes("terhubung ke server")){t.next=12;break}return console.warn("Network error - updating all notifications UI optimistically"),this.view.updateAllNotificationsReadStatus(),this.view.showSuccessMessage("Semua notifikasi ditandai sebagai dibaca (offline)"),t.abrupt("return",!0);case 12:return this.view.showError(e.message),t.abrupt("return",!1);case 14:return console.log("Successfully marked all notifications as read"),this.view.updateAllNotificationsReadStatus(),this.view.showSuccessMessage("Semua notifikasi ditandai sebagai dibaca"),t.abrupt("return",!0);case 20:return t.prev=20,t.t0=t.catch(0),console.error("Error marking all notifications as read:",t.t0),this.view.showError("Gagal menandai semua notifikasi sebagai dibaca"),t.abrupt("return",!1);case 25:case"end":return t.stop()}}),t,this,[[0,20]])}))),function(){return r.apply(this,arguments)})}],e&&Ve(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function Qe(t){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qe(t)}function Ze(){Ze=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==Qe(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Qe(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function tr(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function er(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){tr(i,n,o,a,s,"next",t)}function s(t){tr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function rr(){return nr.apply(this,arguments)}function nr(){return(nr=er(Ze().mark((function t(){var e;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Notification"in window){t.next=3;break}return console.error("Notification API unsupported."),t.abrupt("return",!1);case 3:if("granted"!==Notification.permission){t.next=5;break}return t.abrupt("return",!0);case 5:return t.next=7,Notification.requestPermission();case 7:if("denied"!==(e=t.sent)){t.next=11;break}return alert("Izin notifikasi ditolak."),t.abrupt("return",!1);case 11:if("default"!==e){t.next=14;break}return alert("Izin notifikasi ditutup atau diabaikan."),t.abrupt("return",!1);case 14:return t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function or(){return ir.apply(this,arguments)}function ir(){return(ir=er(Ze().mark((function t(){var e;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.serviceWorker.getRegistration();case 2:return e=t.sent,t.next=5,e.pushManager.getSubscription();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ar(){return sr.apply(this,arguments)}function sr(){return(sr=er(Ze().mark((function t(){return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,or();case 2:return t.abrupt("return",!!t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ur(){return cr.apply(this,arguments)}function cr(){return(cr=er(Ze().mark((function t(){var e,r,n,o,i,a,s,u;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,rr();case 2:if(t.sent){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,ar();case 6:if(!t.sent){t.next=9;break}return alert("Sudah berlangganan push notification."),t.abrupt("return");case 9:return console.log("Mulai berlangganan push notification..."),e="Langganan push notification gagal diaktifkan.",r="Langganan push notification berhasil diaktifkan.",t.prev=12,t.next=15,navigator.serviceWorker.getRegistration();case 15:return o=t.sent,t.next=18,o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:l("BH25fzqLGh8WAEAkneThLf5ngeFv88HtEVcFrzH2W_cwDYFmFHr6hmtXrS8zsRUrxKweRWAFhxi9uNR37c66gfU")});case 18:return n=t.sent,i=n.toJSON(),a=i.endpoint,s=i.keys,t.next=22,St({endpoint:a,keys:s});case 22:if(u=t.sent,console.log({endpoint:a,keys:s}),!u.error){t.next=30;break}return console.error("subscribe: response:",u),alert(e),t.next=29,n.unsubscribe();case 29:return t.abrupt("return");case 30:console.log("subscribe: response:",u),alert(r),t.next=40;break;case 34:return t.prev=34,t.t0=t.catch(12),console.error("subscribe: error:",t.t0),alert(e),t.next=40,n.unsubscribe();case 40:case"end":return t.stop()}}),t,null,[[12,34]])})))).apply(this,arguments)}function lr(){return hr.apply(this,arguments)}function hr(){return(hr=er(Ze().mark((function t(){var e,r,n,o,i,a,s;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="Langganan push notification gagal dinonaktifkan.",r="Langganan push notification berhasil dinonaktifkan.",t.prev=2,t.next=5,or();case 5:if(n=t.sent){t.next=9;break}return alert("Tidak bisa memutus langganan push notification karena belum berlangganan sebelumnya."),t.abrupt("return");case 9:return o=n.toJSON(),i=o.endpoint,a=o.keys,t.next=12,Pt({endpoint:i});case 12:if(!(s=t.sent).error){t.next=17;break}return alert(e),console.error("unsubscribe: response:",s),t.abrupt("return");case 17:return t.next=19,n.unsubscribe();case 19:if(t.sent){t.next=25;break}return alert(e),t.next=24,St({endpoint:i,keys:a});case 24:return t.abrupt("return");case 25:alert(r),t.next=32;break;case 28:t.prev=28,t.t0=t.catch(2),alert(e),console.error("unsubscribe: error:",t.t0);case 32:case"end":return t.stop()}}),t,null,[[2,28]])})))).apply(this,arguments)}function fr(t){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fr(t)}function dr(){dr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==fr(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(fr(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function pr(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function vr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){pr(i,n,o,a,s,"next",t)}function s(t){pr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function mr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yr(n.key),n)}}function yr(t){var e=function(t){if("object"!=fr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=fr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==fr(e)?e:e+""}var gr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.presenter=new Xe(this),this.notifications=[],this.isSubscribed=!1,this.isSupported=!1,this.currentPage=1,this.itemsPerPage=8,this.totalPages=1},e=[{key:"render",value:(i=vr(dr().mark((function t(){return dr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="lg:p-8 p-6 pt-2 md:p-6 pb-20">\n        <div class="max-w-xl w-full ml-0 md:ml-16 lg:ml-24 text-left">\n          <div class="flex justify-between items-center mb-8 mt-3">\n            <h1 class="text-2xl font-semibold">Pemberitahuan</h1>     \n          </div>\n\n        <div class="flex justify-between items-center mb-6"> \n          <div id="push-notification-container">\n            \x3c!-- Push notification button akan di-render di sini --\x3e\n          </div>\n          <button id="mark-all-read-btn" class="text-sm text-third hover:text-third/80 hidden">\n            Tandai Semua Dibaca\n          </button>\n        </div>\n         \n          \n          <div id="notification-loading" class="text-center py-8">\n            <p class="text-gray-500">Memuat notifikasi...</p>\n          </div>\n          \n          <div id="notification-container" class="hidden">\n            <div id="notification-list">\n            </div>\n            \n            <div id="pagination-container" class="flex justify-between items-center mt-6 pt-4 border-t border-gray-200 hidden">\n              <button id="prev-btn" class="px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed" disabled>\n                \x3c!-- Desktop: Text lengkap --\x3e\n                <span class="hidden sm:inline"> Sebelumnya</span>\n                \x3c!-- Mobile: Simbol --\x3e\n                <span class="sm:hidden text-lg"></span>\n              </button>\n              \n              <span id="page-info" class="text-sm text-gray-600 font-medium">\n                <span class="sm:hidden">1/1</span>\n                <span class="hidden sm:inline">Halaman 1 dari 1</span>\n              </span>\n              \n              <button id="next-btn" class="px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed" disabled>\n                \x3c!-- Desktop: Text lengkap --\x3e\n                <span class="hidden sm:inline">Selanjutnya </span>\n                \x3c!-- Mobile: Simbol --\x3e\n                <span class="sm:hidden text-lg"></span>\n              </button>\n            </div>\n          \n          <div id="notification-error" class="hidden text-center py-8">\n            <p class="text-red-500">Gagal memuat notifikasi</p>\n            <button id="retry-btn" class="mt-4 px-4 py-2 bg-third text-white rounded-lg">Coba Lagi</button>\n          </div>\n\n          <div id="success-message" class="hidden bg-third/10 border border-third text-third px-4 py-3 rounded mb-4">\n            <p></p>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(o=vr(dr().mark((function t(){return dr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.setupPushNotificationButton();case 2:return t.next=4,this.presenter.loadNotifications();case 4:this.attachEventListeners();case 5:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"setupPushNotificationButton",value:(n=vr(dr().mark((function t(){var e,r;return dr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.getElementById("push-notification-container"),t.prev=1,t.next=4,ar();case 4:r=t.sent,e.innerHTML=r?'\n          <button id="push-notification-btn" class="px-4 py-2 bg-red-500 text-white text-sm rounded-lg hover:bg-red-600 transition-colors" data-action="unsubscribe">\n            Nonaktifkan Push Notifikasi\n          </button>\n        ':'\n          <button id="push-notification-btn" class="px-4 py-2 bg-third text-white text-sm rounded-lg hover:bg-third/90 transition-colors" data-action="subscribe">\n            Aktifkan Push Notifikasi\n          </button>\n        ',t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.error("Error checking subscription status:",t.t0),e.innerHTML='\n        <button id="push-notification-btn" class="px-4 py-2 bg-third text-white text-sm rounded-lg hover:bg-third/90 transition-colors" data-action="subscribe">\n          Aktifkan Push Notifikasi\n        </button>\n      ';case 12:case"end":return t.stop()}}),t,null,[[1,8]])}))),function(){return n.apply(this,arguments)})},{key:"handlePushNotificationToggle",value:(r=vr(dr().mark((function t(){var e,r,n;return dr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.getElementById("push-notification-btn"),r=e.dataset.action,n=e.textContent,e.disabled=!0,e.textContent="Memproses...",t.prev=5,"subscribe"!==r){t.next=15;break}return t.next=9,ur();case 9:this.showSuccessMessage("Push notification berhasil diaktifkan!"),e.textContent="Nonaktifkan Push Notifikasi",e.className="px-4 py-2 bg-red-500 text-white text-sm rounded-lg hover:bg-red-600 transition-colors",e.dataset.action="unsubscribe",t.next=21;break;case 15:return t.next=17,lr();case 17:this.showSuccessMessage("Push notification berhasil dinonaktifkan!"),e.textContent="Aktifkan Push Notifikasi",e.className="px-4 py-2 bg-third text-white text-sm rounded-lg hover:bg-third/90 transition-colors",e.dataset.action="subscribe";case 21:t.next=28;break;case 23:t.prev=23,t.t0=t.catch(5),console.error("Error toggling push notification:",t.t0),"subscribe"===r?alert("Gagal mengaktifkan push notification: "+t.t0.message):alert("Gagal menonaktifkan push notification: "+t.t0.message),e.textContent=n;case 28:return t.prev=28,e.disabled=!1,t.finish(28);case 31:case"end":return t.stop()}}),t,this,[[5,23,28,31]])}))),function(){return r.apply(this,arguments)})},{key:"displayNotifications",value:function(t){this.notifications=t,this.currentPage=1,this.totalPages=Math.ceil(t.length/this.itemsPerPage);var e=document.getElementById("notification-container"),r=document.getElementById("notification-loading"),n=document.getElementById("notification-error");r.classList.add("hidden"),n.classList.add("hidden"),0===t.length?(document.getElementById("notification-list").innerHTML='\n        <div class="text-center py-8">\n          <p class="text-gray-500">Belum ada notifikasi</p>\n        </div>\n      ',this.hidePagination(),this.hideMarkAllButton()):(this.renderCurrentPage(),this.updatePagination(),this.updateMarkAllButtonVisibility()),e.classList.remove("hidden")}},{key:"renderCurrentPage",value:function(){var t=(this.currentPage-1)*this.itemsPerPage,e=t+this.itemsPerPage,r=this.notifications.slice(t,e);document.getElementById("notification-list").innerHTML='\n        <div class="">\n            <div>\n                '.concat(r.map(v).join(""),"\n            </div>\n        </div>\n    "),this.attachNotificationClickListeners()}},{key:"updatePagination",value:function(){var t=document.getElementById("pagination-container"),e=document.getElementById("prev-btn"),r=document.getElementById("next-btn"),n=document.getElementById("page-info");this.totalPages<=1?this.hidePagination():(t.classList.remove("hidden"),n.textContent="Halaman ".concat(this.currentPage," dari ").concat(this.totalPages),e.disabled=1===this.currentPage,r.disabled=this.currentPage===this.totalPages)}},{key:"hidePagination",value:function(){document.getElementById("pagination-container").classList.add("hidden")}},{key:"goToPreviousPage",value:function(){this.currentPage>1&&(this.currentPage--,this.renderCurrentPage(),this.updatePagination(),document.getElementById("notification-list").scrollIntoView({behavior:"smooth"}))}},{key:"goToNextPage",value:function(){this.currentPage<this.totalPages&&(this.currentPage++,this.renderCurrentPage(),this.updatePagination(),document.getElementById("notification-list").scrollIntoView({behavior:"smooth"}))}},{key:"attachEventListeners",value:function(){var t=this,e=document.getElementById("retry-btn");e&&e.addEventListener("click",(function(){t.showLoading(),t.presenter.loadNotifications()}));var r=document.getElementById("mark-all-read-btn");r&&r.addEventListener("click",(function(){t.handleMarkAllAsRead()}));var n=document.getElementById("push-notification-btn");n&&n.addEventListener("click",(function(){t.handlePushNotificationToggle()}));var o=document.getElementById("prev-btn");o&&o.addEventListener("click",(function(){t.goToPreviousPage()}));var i=document.getElementById("next-btn");i&&i.addEventListener("click",(function(){t.goToNextPage()})),this.attachNotificationClickListeners()}},{key:"updateNotificationReadStatus",value:function(t){var e=this.notifications.find((function(e){return e.id===t}));e&&(e.read=!0),this.renderCurrentPage(),this.updateMarkAllButtonVisibility()}},{key:"updateAllNotificationsReadStatus",value:function(){this.notifications.forEach((function(t){t.read=!0})),this.renderCurrentPage(),this.hideMarkAllButton()}},{key:"hideMarkAllButton",value:function(){var t=document.getElementById("mark-all-read-btn");t&&t.classList.add("hidden")}},{key:"attachNotificationClickListeners",value:function(){var t=this;document.querySelectorAll("[data-notification-id]").forEach((function(e){e.removeEventListener("click",t.handleNotificationClickBound),t.handleNotificationClickBound=function(e){var r=e.currentTarget.dataset.notificationId;t.handleNotificationClick(r)},e.addEventListener("click",t.handleNotificationClickBound)}))}},{key:"handleMarkAllAsRead",value:function(){var t=document.getElementById("mark-all-read-btn");t.disabled=!0,t.textContent="Memproses...",this.presenter.markAllAsRead().then((function(){t.disabled=!1,t.textContent="Tandai Semua Dibaca"}))}},{key:"showLoading",value:function(){var t=document.getElementById("notification-container"),e=document.getElementById("notification-loading"),r=document.getElementById("notification-error"),n=document.getElementById("mark-all-read-btn");t.classList.add("hidden"),r.classList.add("hidden"),n.classList.add("hidden"),e.classList.remove("hidden")}},{key:"showError",value:function(t){var e=document.getElementById("notification-container"),r=document.getElementById("notification-loading"),n=document.getElementById("notification-error"),o=n.querySelector("p");r.classList.add("hidden"),e.classList.add("hidden"),o.textContent=t,n.classList.remove("hidden")}},{key:"showSuccessMessage",value:function(t){var e=document.getElementById("success-message");e.querySelector("p").textContent=t,e.classList.remove("hidden"),setTimeout((function(){e.classList.add("hidden")}),3e3)}},{key:"handleNotificationClick",value:function(t){var e=this.notifications.find((function(e){return e.id===t}));if(e){var r=!e.read;r&&this.updateNotificationReadStatus(t),"comment"===e.type&&e.storyId||"reply"===e.type&&e.storyId?window.location.hash="#/story/".concat(e.storyId):"reminder"===e.type&&(window.location.hash="#/calendar"),r&&this.presenter.markAsRead(t).catch((function(t){console.warn("Failed to mark notification as read on server, but UI updated locally:",t)}))}}},{key:"updateMarkAllButtonVisibility",value:function(){var t=document.getElementById("mark-all-read-btn");t&&(this.notifications.some((function(t){return!t.read}))?t.classList.remove("hidden"):t.classList.add("hidden"))}}],e&&mr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}();function wr(t){return wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wr(t)}function br(){br=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==wr(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(wr(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function xr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function kr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?xr(Object(r),!0).forEach((function(e){Er(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Er(t,e,r){return(e=_r(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sr(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function jr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Sr(i,n,o,a,s,"next",t)}function s(t){Sr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Pr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_r(n.key),n)}}function _r(t){var e=function(t){if("object"!=wr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=wr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==wr(e)?e:e+""}function Or(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function Tr(t,e){return t.get(Cr(t,e))}function Ir(t,e,r){return t.set(Cr(t,e),r),r}function Cr(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Nr=new WeakMap,Lr=new WeakMap,Gr=new WeakMap,Ar=function(){return t=function t(e){var r=e.view,n=e.authModel;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Or(this,Nr,void 0),Or(this,Lr,void 0),Or(this,Gr,[]),Ir(Nr,this,r),Ir(Lr,this,n)},e=[{key:"loadUserProfile",value:(a=jr(br().mark((function t(){var e,r,n;return br().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(e=JSON.parse(localStorage.getItem("user"))||{}).username){t.next=5;break}throw console.warn("User data not found in localStorage for profile page."),new Error("User data not found. Please log in.");case 5:return t.next=7,ct(e.username);case 7:if(!(r=t.sent).error){t.next=10;break}throw new Error(r.message);case 10:return e=kr(kr({},e),r.data),localStorage.setItem("user",JSON.stringify(e)),"function"==typeof Tr(Nr,this).updateProfileHeaderDisplay&&Tr(Nr,this).updateProfileHeaderDisplay(e),t.next=15,it();case 15:if(!(n=t.sent).error){t.next=18;break}throw new Error(n.message);case 18:return Ir(Gr,this,(n.data||[]).filter((function(t){return!t.isAnonymous&&t.username===e.username})).map((function(t){var r,n;return kr(kr({},t),{},{likeCount:(null===(r=t.likes)||void 0===r?void 0:r.length)||0,commentCount:(null===(n=t.comments)||void 0===n?void 0:n.length)||0,profilePicture:e.profilePicture||"./images/image.png",name:e.name})}))),Tr(Nr,this).showUserStories(Tr(Gr,this)),t.abrupt("return",!0);case 23:return t.prev=23,t.t0=t.catch(0),console.error("Failed to load profile:",t.t0),t.abrupt("return",!1);case 27:case"end":return t.stop()}}),t,this,[[0,23]])}))),function(){return a.apply(this,arguments)})},{key:"updateProfile",value:(i=jr(br().mark((function t(e){var r,n,o;return br().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,mt(e);case 3:if(!(r=t.sent).error){t.next=6;break}throw new Error(r.message);case 6:return n=JSON.parse(localStorage.getItem("user"))||{},o=kr(kr(kr({},n),r.data),{},{profilePicture:r.data.profilePicture||n.profilePicture}),localStorage.setItem("user",JSON.stringify(o)),document.dispatchEvent(new CustomEvent("profileUpdated",{detail:o})),"function"==typeof Tr(Nr,this).updateProfileHeaderDisplay&&Tr(Nr,this).updateProfileHeaderDisplay(o),t.abrupt("return",r);case 14:throw t.prev=14,t.t0=t.catch(0),console.error("Failed to update profile:",t.t0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(t){return i.apply(this,arguments)})},{key:"isStoryOnProfile",value:function(t){return Tr(Gr,this).some((function(e){return e.id===t||e._id===t}))}},{key:"likeStory",value:function(){var t=jr(br().mark((function t(e){var r,n,o,i,a,s;return br().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}throw new Error("Invalid story ID");case 3:return t.next=5,ft(e);case 5:if(!(o=t.sent).error){t.next=8;break}throw new Error(o.message);case 8:return i=Array.isArray(null===(r=o.data)||void 0===r?void 0:r.likes)?o.data.likes.length:"number"==typeof o.data?o.data:0,-1!==(a=Tr(Gr,this).findIndex((function(t){return t.id===e||t._id===e})))&&(Tr(Gr,this)[a].likeCount=i,Array.isArray(null===(s=o.data)||void 0===s?void 0:s.likes)&&(Tr(Gr,this)[a].likes=o.data.likes)),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:e,action:"liked",newLikeCount:i,likes:null===(n=o.data)||void 0===n?void 0:n.likes}})),t.abrupt("return",i);case 15:throw t.prev=15,t.t0=t.catch(0),console.error("ProfilePresenter: Failed to like story:",t.t0),t.t0;case 19:case"end":return t.stop()}}),t,this,[[0,15]])})));return function(e){return t.apply(this,arguments)}}()},{key:"addComment",value:(o=jr(br().mark((function t(e,r){var n,o,i,a,s;return br().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e&&r){t.next=3;break}throw new Error("Invalid data for comment");case 3:return t.next=5,pt(e,r);case 5:if(!(o=t.sent).error){t.next=8;break}throw new Error(o.message);case 8:return-1!==(i=Tr(Gr,this).findIndex((function(t){return t.id===e||t._id===e})))&&(Tr(Gr,this)[i].comments=(null===(a=o.data)||void 0===a?void 0:a.comments)||[],Tr(Gr,this)[i].commentCount=((null===(s=o.data)||void 0===s?void 0:s.comments)||[]).length),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:e,action:"commented",comments:o.data.comments}})),t.abrupt("return",((null===(n=o.data)||void 0===n?void 0:n.comments)||[]).length);case 14:throw t.prev=14,t.t0=t.catch(0),console.error("ProfilePresenter: Failed to add comment:",t.t0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(t,e){return o.apply(this,arguments)})},{key:"editStory",value:(n=jr(br().mark((function t(e,r){var n,o;return br().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r&&"string"==typeof r&&""!==r.trim()){t.next=3;break}throw new Error("Content is required");case 3:return t.next=5,Ot(e,r.trim());case 5:if(!(n=t.sent).error){t.next=8;break}throw new Error(n.message);case 8:return-1!==(o=Tr(Gr,this).findIndex((function(t){return t.id===e||t._id===e})))&&(Tr(Gr,this)[o]=kr(kr({},Tr(Gr,this)[o]),{},{content:n.data.content,updatedAt:n.data.updatedAt})),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:e,action:"edited",updatedStory:n.data}})),t.abrupt("return",!0);case 14:throw t.prev=14,t.t0=t.catch(0),console.error("ProfilePresenter: Failed to edit story:",t.t0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(t,e){return n.apply(this,arguments)})},{key:"deleteStory",value:(r=jr(br().mark((function t(e){var r;return br().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Tt(e);case 3:if(!(r=t.sent).error){t.next=6;break}throw new Error(r.message);case 6:return Ir(Gr,this,Tr(Gr,this).filter((function(t){return t.id!==e&&t._id!==e}))),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:e,action:"deleted"}})),t.abrupt("return",!0);case 11:throw t.prev=11,t.t0=t.catch(0),console.error("ProfilePresenter: Failed to delete story:",t.t0),t.t0;case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t){return r.apply(this,arguments)})},{key:"handleLogout",value:function(){Tr(Lr,this).getLogout(),Tr(Nr,this).logoutSuccess()}}],e&&Pr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a}();function Br(t){return Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Br(t)}function Mr(){Mr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==Br(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Br(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Dr(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Fr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Dr(i,n,o,a,s,"next",t)}function s(t){Dr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Hr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ur(n.key),n)}}function Ur(t){var e=function(t){if("object"!=Br(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Br(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Br(e)?e:e+""}function zr(t,e,r){qr(t,e),e.set(t,r)}function qr(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rr(t,e){return t.get(Jr(t,e))}function Wr(t,e,r){return t.set(Jr(t,e),r),r}function Jr(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yr=new WeakMap,Kr=new WeakMap,Vr=new WeakMap,$r=new WeakMap,Xr=new WeakMap,Qr=new WeakSet,Zr=function(){return t=function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),qr(this,e=Qr),e.add(this),zr(this,Yr,null),zr(this,Kr,null),zr(this,Vr,null),zr(this,$r,null),zr(this,Xr,null)},r=[{key:"render",value:(o=Fr(Mr().mark((function t(){return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Wr(Kr,this,JSON.parse(localStorage.getItem("user"))||{}),t.abrupt("return",(e=Rr(Kr,this),'\n    <div class="ml-16 min-h-screen p-10">\n    <div class="max-w">\n      <h1 class="text-2xl font-semibold text-gray-900 mb-10">Profil</h1>\n          \n      <div class="mt-8">\n      <div class="flex items-center justify-between mb-8">\n        <div class="flex items-center gap-4">\n        <div class="w-24 h-24 rounded-full overflow-hidden">\n          <img src="'.concat(e.profilePicture||"/images/image.png",'" alt="Foto Profil" class="w-full h-full object-cover">\n        </div>\n        <div>\n          <div class="text-lg font-medium">').concat(e.name||"Nama Pengguna",'</div>\n        <div class="text-gray-500">@').concat(e.username||"namapengguna",'</div>\n      </div>\n      </div>\n                \n      <div class="flex gap-4">\n        <button id="editProfileBtn" class="w-25 border border-primary rounded-lg text-primary mt-2 justify-end">Sunting</button>\n        <button id="logoutBtn" class="w-25 bg-red-300 text-white py-2 rounded-lg mt-2 justify-end">Keluar</button>\n        </div>\n        </div>\n      </div>\n\n      <hr class="my-4 border-gray-300">\n\n      <div class="bg-none">\n        <h2 class="text-lg font-medium mb-4">Unggahan</h2>\n        <div id="user-stories-container" class="mt-6">\n        <p class="text-gray-500 text-center py-8">Belum ada unggahan</p>\n        </div>\n        </div>\n        </div>\n    </div>\n  ')));case 2:case"end":return t.stop()}var e}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(n=Fr(Mr().mark((function t(){return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Wr(Yr,this,new Ar({view:this,authModel:e})),Jr(Qr,this,en).call(this),Jr(Qr,this,rn).call(this),Jr(Qr,this,tn).call(this),t.next=6,Rr(Yr,this).loadUserProfile();case 6:Jr(Qr,this,nn).call(this);case 7:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"destroy",value:function(){Rr(Vr,this)&&(document.removeEventListener("storyDataChanged",Rr(Vr,this)),Wr(Vr,this,null)),Rr($r,this)&&(document.removeEventListener("showEditStoryModalRequest",Rr($r,this)),Wr($r,this,null)),Rr(Xr,this)&&(document.removeEventListener("profileUpdated",Rr(Xr,this)),Wr(Xr,this,null)),console.log("ProfilePage destroyed and listeners cleaned up.")}},{key:"showUserStories",value:function(t){var e=this,r=document.getElementById("user-stories-container");r?(Wr(Kr,this,JSON.parse(localStorage.getItem("user"))||{}),t&&0!==t.length?(r.innerHTML=t.map((function(t){var r,n,o=t.id||t._id,i=t.isAnonymous?"Pengguna":t.name||Rr(Kr,e).name,a=t.isAnonymous?"Anonim":"@".concat(t.username||Rr(Kr,e).username),s=t.isAnonymous?"./images/image.png":t.profilePicture||Rr(Kr,e).profilePicture||"./images/image.png",u=!t.isAnonymous&&t.username===Rr(Kr,e).username;return m({username:i,handle:a,content:t.content,isAnonymous:t.isAnonymous,storyId:o,likeCount:(null===(r=t.likes)||void 0===r?void 0:r.length)||t.likeCount||0,commentCount:(null===(n=t.comments)||void 0===n?void 0:n.length)||t.commentCount||0,viewCount:t.viewCount||t.views||0,profilePicture:s,createdAt:t.createdAt,isOwner:u})})).join(""),Rr(Yr,this)&&(te(Rr(Yr,this),"user-stories-container"),ae(Rr(Yr,this),"user-stories-container"))):r.innerHTML='<p class="text-gray-500 text-center py-8">Belum ada unggahan</p>'):console.error("Element with ID 'user-stories-container' not found.")}},{key:"updateProfileHeaderDisplay",value:function(t){var e=document.querySelector(".ml-16.min-h-screen.p-10");if(e){var r=e.querySelector(".w-24.h-24 img"),n=e.querySelector(".text-lg.font-medium"),o=e.querySelector("div > .text-gray-500");r&&(r.src=t.profilePicture||"/images/image.png"),n&&(n.textContent=t.name||"Nama Pengguna"),o&&(o.textContent="@".concat(t.username||"namapengguna"))}}},{key:"logoutSuccess",value:function(){window.location.hash="/login"}}],r&&Hr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n,o}();function tn(){var t=this;Wr($r,this,(function(e){var r=e.detail,n=r.storyId,o=r.currentContent;Rr(Yr,t)&&"function"==typeof Rr(Yr,t).isStoryOnProfile?Rr(Yr,t).isStoryOnProfile(n)?le(n,o,Rr(Yr,t)):console.log("Edit request for story ".concat(n," ignored: not on this profile.")):console.warn("Presenter or isStoryOnProfile method not available. Cannot verify story context for edit.")})),document.addEventListener("showEditStoryModalRequest",Rr($r,this))}function en(){var t=this;Wr(Vr,this,function(){var e=Fr(Mr().mark((function e(r){var n,o,i,a,s,u;return Mr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.detail,o=n.storyId,i=n.action,a=n.newStory,n.updatedStory,s=JSON.parse(localStorage.getItem("user"))||{},u=!1,"posted"===i&&(null==a?void 0:a.username)===s.username?u=!0:["edited","deleted"].includes(i)?Rr(Yr,t)&&"function"==typeof Rr(Yr,t).isStoryOnProfile&&Rr(Yr,t).isStoryOnProfile(o)&&(u=!0):["liked","commented"].includes(i)&&Rr(Yr,t)&&"function"==typeof Rr(Yr,t).isStoryOnProfile&&Rr(Yr,t).isStoryOnProfile(o)&&(u=!0),!u){e.next=8;break}return console.log("ProfilePage: Reloading user profile due to storyDataChanged",{action:i,storyId:o}),e.next=8,Rr(Yr,t).loadUserProfile();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),document.addEventListener("storyDataChanged",Rr(Vr,this))}function rn(){var t=this;Wr(Xr,this,(function(e){var r=e.detail;Wr(Kr,t,r),console.log("ProfilePage: profileUpdated event received, local currentUser updated.",r)})),document.addEventListener("profileUpdated",Rr(Xr,this))}function nn(){var t=this,e=document.getElementById("logoutBtn");e&&e.addEventListener("click",(function(){Rr(Yr,t)&&Rr(Yr,t).handleLogout()}));var r=document.getElementById("editProfileBtn");r&&r.addEventListener("click",(function(){var e=JSON.parse(localStorage.getItem("user"))||Rr(Kr,t)||{};Jr(Qr,t,on).call(t,e)}))}function on(t){var e=this,r=document.getElementById("editProfileModal");r&&r.remove(),document.body.insertAdjacentHTML("beforeend",function(t){return'\n    <div id="editProfileModal" class="fixed inset-0 items-center justify-center bg-black/40 z-50 hidden">\n    <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">\n    <div class="flex justify-between items-center mb-4">\n        <h3 class="text-lg font-semibold">Edit Profil</h3>\n        <button id="closeEditProfileModalBtn" class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>\n        </div>\n      <hr class="my-4 border-gray-300">\n        \n      <form id="editProfileForm" class="space-y-4">\n      <div>\n        <label class="block text-sm font-medium text-gray-700 mb-1">Nama Lengkap</label>\n        <input type="text" name="name" value="'.concat(t.name||"",'" \n        class="w-full border border-gray-300 rounded-lg p-2">\n      </div>\n          \n      <div>\n        <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>\n        <input type="text" name="username" value="').concat(t.username||"",'" \n        class="w-full border border-gray-300 rounded-lg p-2">\n        </div>\n          \n      <div>\n      <label class="block text-sm font-medium text-gray-700 mb-1">Foto Profil</label>\n      <div class="flex items-center gap-4">\n        <div class="w-16 h-16 rounded-full overflow-hidden border border-gray-300">\n          <img id="profileImagePreview" src="').concat(t.profilePicture||"/images/image.png",'" \n          alt="Preview Foto Profil" class="w-full h-full object-cover">\n          </div>\n          <input type="file" id="profilePictureInput" accept="image/*" class="hidden">\n          <button type="button" id="changePhotoBtn" \n            class="text-sm text-primary border border-primary rounded-lg px-3 py-1">\n            Ganti Foto\n        </button>\n      </div>\n      </div>\n          \n      <div class="flex justify-end gap-3 pt-4">\n      <button type="button" id="cancelEditBtn" \n        class="w-25 border border-gray-300 py-2 rounded-lg mt-2 justify-end text-gray-700">Batal</button>\n        <button type="submit" class="w-25 bg-third text-white py-2 rounded-lg mt-2 justify-end">Simpan</button>\n        </div>\n        </form>\n      </div>\n    </div>\n  ')}(t));var n=document.getElementById("editProfileModal"),o=document.getElementById("closeEditProfileModalBtn"),i=document.getElementById("cancelEditBtn"),a=document.getElementById("editProfileForm"),s=document.getElementById("changePhotoBtn"),u=document.getElementById("profilePictureInput"),c=document.getElementById("profileImagePreview");if(!(n&&o&&i&&a&&s&&u&&c))return console.error("One or more edit profile modal elements not found."),void(n&&n.remove());n.classList.remove("hidden"),n.classList.add("flex");var l=function(){return Jr(Qr,e,an).call(e,n)};o.addEventListener("click",l),i.addEventListener("click",l),n.addEventListener("click",(function(t){t.target===n&&l()})),s.addEventListener("click",(function(){u.click()})),u.addEventListener("change",(function(t){var e=t.target.files[0];if(e){var r=new FileReader;r.onload=function(t){c.src=t.target.result},r.readAsDataURL(e)}})),a.addEventListener("submit",function(){var t=Fr(Mr().mark((function t(r){var n,o,i,s,c,h;return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),n=a.querySelector('button[type="submit"]'),o=n.textContent,n.disabled=!0,n.textContent="Menyimpan...",i=new FormData(a),s={name:i.get("name"),username:i.get("username")},!u.files[0]){t.next=27;break}if(!((c=u.files[0]).size>2097152)){t.next=14;break}return alert("Ukuran gambar terlalu besar. Maksimal 2MB"),n.disabled=!1,n.textContent=o,t.abrupt("return");case 14:return t.prev=14,t.next=17,Jr(Qr,e,sn).call(e,c);case 17:s.profilePicture=t.sent,t.next=27;break;case 20:return t.prev=20,t.t0=t.catch(14),console.error("Error converting image to Base64:",t.t0),alert("Gagal memproses gambar. Silakan coba lagi."),n.disabled=!1,n.textContent=o,t.abrupt("return");case 27:if(t.prev=27,!Rr(Yr,e)){t.next=33;break}return t.next=31,Rr(Yr,e).updateProfile(s);case 31:(h=t.sent)&&!h.error?l():h&&h.message?alert(h.message):alert("Gagal memperbarui profil. Respons tidak diketahui.");case 33:t.next=38;break;case 35:t.prev=35,t.t1=t.catch(27),alert(t.t1.message||"Gagal memperbarui profil.");case 38:return t.prev=38,n.disabled=!1,n.textContent=o,t.finish(38);case 42:case"end":return t.stop()}}),t,null,[[14,20],[27,35,38,42]])})));return function(e){return t.apply(this,arguments)}}())}function an(t){t&&(t.classList.add("hidden"),t.classList.remove("flex"),setTimeout((function(){return t.remove()}),300))}function sn(t){return un.apply(this,arguments)}function un(){return(un=Fr(Mr().mark((function t(e){return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(t){return r(t)}})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function cn(t){return cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cn(t)}function ln(){ln=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==cn(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(cn(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function hn(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function fn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dn(n.key),n)}}function dn(t){var e=function(t){if("object"!=cn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=cn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==cn(e)?e:e+""}function pn(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function vn(t,e){return t.get(yn(t,e))}function mn(t,e,r){return t.set(yn(t,e),r),r}function yn(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var gn=new WeakMap,wn=new WeakMap,bn=new WeakMap,xn=function(){return t=function t(e){var r=e.view,n=e.model,o=e.authModel;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),pn(this,gn,void 0),pn(this,wn,void 0),pn(this,bn,void 0),mn(gn,this,r),mn(wn,this,n),mn(bn,this,o)},e=[{key:"getLogin",value:function(){var t,e=(t=ln().mark((function t(e){var r,n,o;return ln().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.usernameOrEmail,n=e.password,vn(gn,this).showSubmitLoadingButton(),t.prev=2,t.next=5,vn(wn,this).getLogin(r,n);case 5:(o=t.sent).error||o.status>=400?vn(gn,this).loginFailed(o.message):(localStorage.setItem("user",JSON.stringify(o.data)),vn(gn,this).loginSuccessfully(o.message),window.location.hash="#/",vn(bn,this).putAccessToken(o.data.token)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),vn(gn,this).loginFailed(t.t0.message);case 12:return t.prev=12,vn(gn,this).hideSubmitLoadingButton(),t.finish(12);case 15:case"end":return t.stop()}}),t,this,[[2,9,12,15]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){hn(i,n,o,a,s,"next",t)}function s(t){hn(i,n,o,a,s,"throw",t)}a(void 0)}))});return function(t){return e.apply(this,arguments)}}()}],e&&fn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function kn(t){return kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kn(t)}function En(){En=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==kn(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(kn(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Sn(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function jn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Sn(i,n,o,a,s,"next",t)}function s(t){Sn(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Pn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_n(n.key),n)}}function _n(t){var e=function(t){if("object"!=kn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=kn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==kn(e)?e:e+""}function On(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tn(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var In=new WeakMap,Cn=new WeakSet,Nn=function(){return t=function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),On(this,e=Cn),e.add(this),function(t,e){On(t,e),e.set(t,null)}(this,In)},n=[{key:"render",value:(i=jn(En().mark((function t(){return En().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n         <div class="flex items-center justify-center min-h-screen bg-white">\n            <div class="w-full max-w-xs">\n                <div class="flex items-center justify-center mb-4 gap-3">\n                    <img src="images/logo.png" alt="Logo" class="w-13 h-13 mb-2">\n                    <h1 class="text-2xl font-semibold text-gray-800 mb-2">MindBlown</h1>\n                </div>\n                <form id="login-form" class="bg-[#F7F7F7] rounded-xl shadow p-6 border border-gray-400">\n                    <p class="mb-3 text-gray-700 text-sm">Masuk untuk ngobrolin apa pun yang kamu rasakan.</p>\n                    <input id="email-input" placeholder="Email / Username" class="w-full mb-3 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n                    <input id="password-input" type="password" placeholder="Kata sandi" class="w-full mb-4 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n                    <div id="errorMessage" class="hidden text-red-500 text-center text-sm" role="alert"></div>\n\n                    <div id="submit-button-container" class="mt-3">\n                        <button class="w-full bg-third text-white text-sm py-2 rounded hover:bg-teal-600 transition" type="submit">Masuk</button>\n                    </div>\n                    \n                    <div class="flex justify-center mt-4">\n                        <p class="text-sm text-gray-500 ">Belum punya akun? <a href="#/register" class="text-third font-semibold hover:underline">Daftar</a></p>\n                    </div>\n                </form>\n            </div>\n        </div>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(o=jn(En().mark((function t(){return En().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=In,o=new xn({view:this,model:r,authModel:e}),n.set(Tn(n,this),o),Tn(Cn,this,Ln).call(this);case 2:case"end":return t.stop()}var n,o}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"loginSuccessfully",value:function(t){console.log(t),location.hash="/"}},{key:"loginFailed",value:function(t){var e=document.getElementById("errorMessage");e.textContent=t,e.classList.remove("hidden"),setTimeout((function(){e.classList.add("hidden")}),3e3)}},{key:"showSubmitLoadingButton",value:function(){document.getElementById("submit-button-container").innerHTML='\n            <button class="w-full bg-teal-500 text-white text-sm py-2 rounded hover:bg-teal-600 transition flex items-center justify-center gap-2" type="submit" disabled>\n                Loading...\n            </button>\n        '}},{key:"hideSubmitLoadingButton",value:function(){document.getElementById("submit-button-container").innerHTML='\n            <button class="w-full bg-teal-500 text-white text-sm py-2 rounded hover:bg-teal-600 transition" type="submit">Masuk</button>\n        '}}],n&&Pn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,o,i}();function Ln(){var t=this;document.getElementById("login-form").addEventListener("submit",function(){var e=jn(En().mark((function e(r){var n;return En().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),n={usernameOrEmail:document.getElementById("email-input").value,password:document.getElementById("password-input").value},e.next=4,(o=In,i=t,o.get(Tn(o,i))).getLogin(n);case 4:case"end":return e.stop()}var o,i}),e)})));return function(t){return e.apply(this,arguments)}}())}function Gn(t){return Gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gn(t)}function An(){An=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==Gn(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Gn(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Bn(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Mn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dn(n.key),n)}}function Dn(t){var e=function(t){if("object"!=Gn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Gn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Gn(e)?e:e+""}function Fn(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function Hn(t,e){return t.get(zn(t,e))}function Un(t,e,r){return t.set(zn(t,e),r),r}function zn(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var qn=new WeakMap,Rn=new WeakMap,Wn=function(){return t=function t(e){var r=e.view,n=e.model;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Fn(this,qn,void 0),Fn(this,Rn,void 0),Un(qn,this,r),Un(Rn,this,n)},e=[{key:"getRegistered",value:(r=An().mark((function t(e){var r,n,o,i,a;return An().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.username,n=e.name,o=e.email,i=e.password,Hn(qn,this).showSubmitLoadingButton(),t.prev=2,console.log(r,n,o,i),t.next=6,Hn(Rn,this).getRegister(r,n,o,i);case 6:(a=t.sent).error||a.status>=400?Hn(qn,this).registeredFailed(a.message):Hn(qn,this).registeredSuccessfully(a.message),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),Hn(qn,this).registeredFailed(t.t0.message);case 13:return t.prev=13,Hn(qn,this).hideSubmitLoadingButton(),t.finish(13);case 16:case"end":return t.stop()}}),t,this,[[2,10,13,16]])})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){Bn(i,n,o,a,s,"next",t)}function s(t){Bn(i,n,o,a,s,"throw",t)}a(void 0)}))},function(t){return n.apply(this,arguments)})}],e&&Mn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Jn(t){return Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jn(t)}function Yn(){Yn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==Jn(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Jn(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Kn(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Vn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Kn(i,n,o,a,s,"next",t)}function s(t){Kn(i,n,o,a,s,"throw",t)}a(void 0)}))}}function $n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xn(n.key),n)}}function Xn(t){var e=function(t){if("object"!=Jn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Jn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Jn(e)?e:e+""}function Qn(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zn(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var to=new WeakMap,eo=new WeakSet,ro=function(){return t=function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Qn(this,e=eo),e.add(this),function(t,e){Qn(t,e),e.set(t,null)}(this,to)},e=[{key:"render",value:(o=Vn(Yn().mark((function t(){return Yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n        <div class="flex items-center justify-center min-h-screen bg-white">\n            <div class="w-full max-w-xs">\n                <div class="flex items-center justify-center mb-4 gap-3">\n                    <img src="images/logo.png" alt="Logo" class="w-13 h-13 mb-2">\n                    <h1 class="text-2xl font-semibold text-gray-800 mb-2">MindBlown</h1>\n                </div>\n                <form id="register-form" class="bg-[#F7F7F7] rounded-xl shadow p-5 border border-gray-400 sm:p-7">\n                    <p class="mb-3 text-gray-700 text-sm">Daftar untuk ngobrolin apa pun yang kamu rasakan.</p>\n                    <input id="username-input" type="text" placeholder="Nama Pengguna" class="w-full mb-3 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n                    <input id="name-input" type="text" placeholder="Nama Lengkap" class="w-full mb-3 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n                    <input id="email-input" type="email" placeholder="Email" class="w-full mb-3 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n                    <input id="password-input" type="password" placeholder="Kata sandi" class="w-full mb-3 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n                    <input id="passwordConfirm-input" type="password" placeholder="Konfirmasi kata sandi" class="w-full mb-4 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n\n                    <div id="errorMessage" class="hidden text-red-500 text-center text-sm" role="alert"></div>   \n\n                    <div id="submit-button-container" class="mt-3">\n                        <button class="w-full bg-third text-white text-sm py-2 rounded hover:bg-teal-600 transition" type="submit">Daftar</button>\n                    </div>\n                    <div class="flex justify-center mt-4">\n                        <p class="text-sm text-gray-500 ">Sudah punya akun? <a href="#/login" class="text-third font-semibold hover:underline">Masuk</a></p>\n                    </div>\n                </form>\n            </div>\n        </div>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(n=Vn(Yn().mark((function t(){return Yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=to,n=new Wn({view:this,model:r}),e.set(Zn(e,this),n),Zn(eo,this,no).call(this);case 2:case"end":return t.stop()}var e,n}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"registeredSuccessfully",value:function(t){console.log(t),location.hash="/login"}},{key:"registeredFailed",value:function(t){var e=document.getElementById("errorMessage");e.textContent=t,e.classList.remove("hidden"),setTimeout((function(){e.classList.add("hidden")}),3e3)}},{key:"showSubmitLoadingButton",value:function(){document.getElementById("submit-button-container").innerHTML='\n            <button class="w-full bg-teal-500 text-white text-sm py-2 rounded hover:bg-teal-600 transition" type="submit" disabled>\n                Loading...\n            </button>\n        '}},{key:"hideSubmitLoadingButton",value:function(){document.getElementById("submit-button-container").innerHTML='\n            <button class="w-full bg-teal-500 text-white text-sm py-2 rounded hover:bg-teal-600 transition" type="submit">\n                Daftar akun\n            </button>\n        '}}],e&&$n(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,o}();function no(){var t=this;document.getElementById("register-form").addEventListener("submit",function(){var e=Vn(Yn().mark((function e(r){var n,o,i,a,s,u;return Yn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),n=document.getElementById("username-input").value,o=document.getElementById("name-input").value,i=document.getElementById("email-input").value,a=document.getElementById("password-input").value,s=document.getElementById("passwordConfirm-input").value,a===s){e.next=9;break}return t.registeredFailed("Konfirmasi kata sandi tidak sama dengan kata sandi!"),e.abrupt("return");case 9:return u={username:n,name:o,email:i,password:a},e.next=12,(c=to,l=t,c.get(Zn(c,l))).getRegistered(u);case 12:case"end":return e.stop()}var c,l}),e)})));return function(t){return e.apply(this,arguments)}}())}function oo(t){return oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oo(t)}function io(){io=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==oo(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(oo(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function ao(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function so(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ao(i,n,o,a,s,"next",t)}function s(t){ao(i,n,o,a,s,"throw",t)}a(void 0)}))}}function uo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,co(n.key),n)}}function co(t){var e=function(t){if("object"!=oo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=oo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==oo(e)?e:e+""}var lo=new WeakSet,ho=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,lo),this.sessionId=localStorage.getItem("sessionId")||function(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}(lo,this,fo).call(this),localStorage.setItem("sessionId",this.sessionId)},e=[{key:"render",value:(n=so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n       <section class="ml-0 md:ml-8 lg:ml-16 min-h-screen flex">\n        <div class="w-full flex items-center pb-20"> \n            <div class="max-w-2xl w-full mx-auto text-center">\n                \n                <div id="chat-container" class="flex flex-col gap-2 px-6 lg:px-4 overflow-y-auto max-h-[75vh] md:max-h[80vh] lg:max-h-[75vh]">\n                </div>\n                \n                <form id="chat-form" class="fixed bottom-24 lg:bottom-6 z-50 w-full lg:w-full md:max-w-2xl lg:max-w-2xl mx-auto px-4 lg:px-0 flex gap-2">\n                    <textarea \n                      id="chat-input"\n                      class="text-[#8c8c8c] w-full h-16 md:h-20 lg:h-24 px-4 py-3 pr-14 rounded-3xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent overflow-hidden placeholder:leading-[2rem] md:placeholder:leading-[3rem] lg:placeholder:leading-[4rem]"\n                      placeholder="Cerita sedikit..."></textarea>\n                    <button class="absolute right-6 lg:right-3 top-1/2 transform -translate-y-1/2 rounded-full bg-[#eee] p-2 flex items-center justify-center hover:bg-third focus:bg-third transition cursor-pointer">\n                        <svg xmlns="http://www.w3.org/2000/svg"  class="w-6 h-6 text-white" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="white" id="Send--Streamline-Mynaui" height="16" width="16">\n                        <path d="m8.75 6.25 -1.875 1.875m5.805 -6.230625a0.33437500000000003 0.33437500000000003 0 0 1 0.42500000000000004 0.42562500000000003l-3.7025 10.58125a0.33437500000000003 0.33437500000000003 0 0 1 -0.62125 0.025l-2.011875 -4.52625a0.33375 0.33375 0 0 0 -0.169375 -0.169375l-4.52625 -2.0125a0.33437500000000003 0.33437500000000003 0 0 1 0.025 -0.620625z" stroke-width="1"></path>\n                    </svg>\n                    </button>\n                </form>\n            </div>\n        </div>\n      </section>\n        ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=so(io().mark((function t(){var e,r,n,o,i;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=function(){requestAnimationFrame((function(){e.scrollTop=e.scrollHeight}))},e=document.getElementById("chat-container"),r=document.getElementById("chat-form"),(n=document.getElementById("chat-input")).addEventListener("input",(function(){return s(n)})),(i=localStorage.getItem("pendingChatMessage"))&&(e.insertAdjacentHTML("beforeend",f(i)),localStorage.removeItem("pendingChatMessage"),o(),setTimeout((function(){e.insertAdjacentHTML("beforeend",d("Hai, terima kasih sudah cerita! Aku di sini untuk mendengarkan.")),o()}),500)),r.addEventListener("submit",function(){var t=so(io().mark((function t(r){var i;return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),i=n.value.trim()){t.next=4;break}return t.abrupt("return");case 4:e.insertAdjacentHTML("beforeend",f(i)),o(),n.value="",n.style.height="",setTimeout(so(io().mark((function t(){return io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.insertAdjacentHTML("beforeend",d("Ini balasan dari bot ipsom lorem alemet aku anjay mabar!")),o();case 3:case"end":return t.stop()}}),t)}))),1e3);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 8:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&uo(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function fo(){return Date.now().toString(36)+Math.random().toString(36).substr(2,9)}function po(t){return po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},po(t)}function vo(){vo=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==po(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(po(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function mo(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function yo(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){mo(i,n,o,a,s,"next",t)}function s(t){mo(i,n,o,a,s,"throw",t)}a(void 0)}))}}function go(t,e,r){return wo.apply(this,arguments)}function wo(){return(wo=yo(vo().mark((function t(e,r,n){var o,i,a;return vo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.disabled){t.next=2;break}return t.abrupt("return");case 2:return o=n.innerHTML,n.disabled=!0,t.prev=4,t.next=7,e.likeExistingComment(r);case 7:(i=t.sent).error?(alert("Gagal menyukai komentar: ".concat(i.message)),n.innerHTML=o):((a=n.querySelector(".comment-like-count"))&&(a.textContent=i.likeCount),n.querySelector("svg path"),i.message.includes("disukai")),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(4),console.error("Error handling comment like:",t.t0),alert("Gagal menyukai komentar: "+(t.t0.message||"Terjadi kesalahan")),n.innerHTML=o;case 16:return t.prev=16,n.disabled=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[4,11,16,19]])})))).apply(this,arguments)}var bo=function(t,e){var r=document.getElementById(e);if(r){var n="_commentInteractionHandler_".concat(e);r[n]&&r.removeEventListener("click",r[n]),r[n]=function(){var e=yo(vo().mark((function e(r){var n,o,i;return vo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.target.closest(".comment-item-container")){e.next=3;break}return e.abrupt("return");case 3:if(o=n.dataset.commentId){e.next=6;break}return e.abrupt("return");case 6:if(!(i=r.target.closest(".comment-like-btn"))){e.next=13;break}return r.stopPropagation(),r.preventDefault(),e.next=12,go(t,o,i);case 12:return e.abrupt("return");case 13:if(!r.target.closest(".comment-actions-menu")&&!r.target.closest(".comment-menu-btn")){e.next=15;break}return e.abrupt("return");case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.addEventListener("click",r[n])}};function xo(t){return xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xo(t)}function ko(){ko=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==xo(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(xo(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Eo(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}var So=function(t,e){var r=document.getElementById(e);if(r){var n=null;r.addEventListener("click",(function(t){var r=t.target.closest(".comment-menu-btn");if(r){t.stopPropagation();var o=r.nextElementSibling;document.querySelectorAll("#".concat(e," .comment-menu")).forEach((function(t){t===o||t.classList.contains("hidden")||t.classList.add("hidden")})),o.classList.toggle("hidden"),n=o.classList.contains("hidden")?null:o}})),r.addEventListener("click",(function(t){n&&!n.classList.contains("hidden")&&(n.contains(t.target)||t.target.closest(".comment-menu-btn")||(n.classList.add("hidden"),n=null))}),!0),r.addEventListener("click",function(){var e,r=(e=ko().mark((function e(r){var o,i,a,s;return ko().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=r.target.closest(".delete-comment-btn"))){e.next=18;break}if(r.stopPropagation(),(i=o.closest(".comment-menu"))&&i.classList.add("hidden"),n=null,a=o.dataset.commentId,!confirm("Apakah Anda yakin ingin menghapus komentar ini?")){e.next=18;break}return e.prev=8,e.next=11,t.deleteExistingComment(a);case 11:(s=e.sent).error&&alert("Gagal menghapus komentar: ".concat(s.message)),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),alert("Gagal menghapus komentar: "+(e.t0.message||"Terjadi kesalahan"));case 18:case"end":return e.stop()}}),e,null,[[8,15]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(t){Eo(i,n,o,a,s,"next",t)}function s(t){Eo(i,n,o,a,s,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}())}};function jo(t){return jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jo(t)}function Po(){Po=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==jo(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(jo(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function _o(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Oo(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){_o(i,n,o,a,s,"next",t)}function s(t){_o(i,n,o,a,s,"throw",t)}a(void 0)}))}}function To(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,No(n.key),n)}}function Io(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Co(t,e,r){return(e=No(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function No(t){var e=function(t){if("object"!=jo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=jo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==jo(e)?e:e+""}function Lo(t,e){return t.get(Ao(t,e))}function Go(t,e,r){return t.set(Ao(t,e),r),r}function Ao(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Bo=new WeakMap,Mo=new WeakSet,Do=function(){return t=function t(e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Io(this,r=Mo),r.add(this),Co(this,"_storyId",null),Co(this,"_presenter",null),Co(this,"_storyDataChangedHandler",null),Co(this,"_currentUser",null),function(t,e){Io(t,e),e.set(t,null)}(this,Bo),this._storyId=e,this._presenter=new Vt(this),this._setupStoryDataChangedListener(),Ao(Mo,this,Fo).call(this)},e=[{key:"render",value:(n=Oo(Po().mark((function t(){var e,r,n,o;return Po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this._presenter?this._presenter.getCurrentUser():JSON.parse(localStorage.getItem("user"))||{},r=(null==e?void 0:e.name)||"Nama Pengguna",n=null!=e&&e.username?"@".concat(e.username):"@namapengguna",o=(null==e?void 0:e.profilePicture)||"./images/image.png",t.abrupt("return",'\n      <div class="ml-16 min-h-screen p-10">\n        <div class="mb-1">\n          <h1 class="text-2xl font-semibold text-gray-900 mb-2">Detail Story</h1>\n          <p class="text-gray-600">Cerita lengkap dan komentar.</p>\n          <hr class="mt-4 text-gray-300">\n        </div>\n\n        <div class="grid grid-cols-2 gap-4 h-screen">\n          <div class="overflow-y-auto p-6 mr-10 border-gray-200">\n            <div id="story-detail-container" class="space-y-6"></div>\n            <div id="comments-container" class="mt-8 space-y-6">\n              <h3 class="text-lg font-semibold text-gray-900 mb-4">Komentar</h3>\n              <div id="comments-list" class="space-y-4">\n                </div>\n            </div>\n          </div>\n\n          <div class="p-6">\n            <div class="space-y-6 mt-4">\n              '.concat(g({username:r,handle:n,profilePicture:o}),"\n            </div>\n          </div>\n        </div>\n      </div>\n    "));case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=Oo(Po().mark((function t(){return Po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._presenter){t.next=3;break}return console.error("Presenter not initialized in afterRender."),t.abrupt("return");case 3:return t.next=5,this._presenter.loadStoryDetail(this._storyId);case 5:this.setupEventListeners(),this._setupStoryDataChangedListener(),Ao(Mo,this,Fo).call(this);case 8:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"_setupStoryDataChangedListener",value:function(){var t=this;this._storyDataChangedHandler=function(){var e=Oo(Po().mark((function e(r){var n,o,i,a;return Po().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.detail,o=n.storyId,i=n.action,n.entityId,a=n.parentId,o!==t._storyId&&(a!==t._storyId||"commented"!==i)&&"commentLiked"!==i&&"commentDeleted"!==i&&"replied"!==i){e.next=6;break}if(console.log("StoryDetailPage: storyDataChanged event, reloading story details.",r.detail),!t._presenter){e.next=6;break}return e.next=6,t._presenter.loadStoryDetail(t._storyId);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),document.addEventListener("storyDataChanged",this._storyDataChangedHandler),document.addEventListener("commentDataChanged",this._storyDataChangedHandler)}},{key:"destroy",value:function(){this._storyDataChangedHandler&&(document.removeEventListener("storyDataChanged",this._storyDataChangedHandler),this._storyDataChangedHandler=null),Lo(Bo,this)&&(document.removeEventListener("showEditStoryModalRequest",Lo(Bo,this)),Go(Bo,this,null)),console.log("StoryDetailPage destroyed and listeners cleaned up.")}},{key:"showStoryDetail",value:function(t){var e,r,n=document.getElementById("story-detail-container");if(n){var o=JSON.parse(localStorage.getItem("user"))||{},i=!t.isAnonymous&&t.username===o.username,a=t._id||t.id||this._storyId;n.innerHTML=m({username:t.isAnonymous?"Pengguna":t.name,handle:t.isAnonymous?"Anonim":"@".concat(t.username),content:t.content,isAnonymous:t.isAnonymous,likeCount:t.likeCount||(null===(e=t.likes)||void 0===e?void 0:e.length)||0,commentCount:t.commentCount||(null===(r=t.comments)||void 0===r?void 0:r.length)||0,viewCount:t.viewCount||t.views||0,storyId:a,profilePicture:t.profilePicture,createdAt:t.createdAt,isOwner:i}),this._presenter&&(te(this._presenter,"story-detail-container"),ae(this._presenter,"story-detail-container"));var s=document.getElementById("comments-list");s?(t.comments&&t.comments.length>0?this._renderCommentsRecursive(t.comments,s,0):s.innerHTML='<p class="text-gray-500 text-sm">Belum ada komentar.</p>',bo(this._presenter,"comments-list"),So(this._presenter,"comments-list")):console.error("Element 'comments-list' not found in StoryDetailPage.")}else console.error("Element with ID 'story-detail-container' not found.")}},{key:"_renderCommentsRecursive",value:function(t,e,r){var n=this;if(t&&0!==t.length){this._currentUser=this._presenter.getCurrentUser();var o="";t.forEach((function(t){var e,i,a,s=(null===(e=n._currentUser)||void 0===e?void 0:e.username)===t.username,u=w({commentId:t.id||t._id,username:t.username||"Pengguna",content:t.content,profilePicture:t.profilePicture||"./images/image.png",createdAt:t.createdAt,likeCount:(null===(i=t.likes)||void 0===i?void 0:i.length)||t.likeCount||0,replyCount:(null===(a=t.replies)||void 0===a?void 0:a.length)||t.replyCount||0,isOwner:s}),c=document.createElement("div");c.innerHTML=u;var l=c.querySelector(".replies-container");l&&t.replies&&t.replies.length>0&&n._renderCommentsRecursive(t.replies,l,r+1),o+=c.innerHTML})),e.innerHTML=o}else r>0&&(e.innerHTML='<p class="text-gray-400 text-xs pl-4">Tidak ada balasan.</p>')}},{key:"showComments",value:function(t){var e=document.getElementById("comments-list");e&&(e.innerHTML=t.map((function(t){return w({username:t.username||"Pengguna",content:t.content,timestamp:t.createdAt||(new Date).toISOString(),profilePicture:t.profilePicture||"./images/image.png"})})).join(""))}},{key:"setupEventListeners",value:function(){var t=this,e=document.getElementById("comment-form");e&&e.addEventListener("submit",function(){var r=Oo(Po().mark((function r(n){var o,i;return Po().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.preventDefault(),o=document.getElementById("comment-input"),(i=e.querySelector('button[type="submit"]')).textContent,o&&o.value.trim()){r.next=7;break}return alert("Silakan masukkan komentar"),r.abrupt("return");case 7:if(i.disabled=!0,i.textContent="Mengunggah...",r.prev=9,!t._presenter){r.next=15;break}return r.next=13,t._presenter.addComment(t._storyId,o.value.trim());case 13:r.sent&&(o.value="",t._showToast("Komentar berhasil ditambahkan!"));case 15:r.next=21;break;case 17:r.prev=17,r.t0=r.catch(9),console.error("Error submitting comment:",r.t0),alert("Gagal mengunggah komentar: "+(r.t0.message||"Terjadi kesalahan"));case 21:return r.prev=21,i.disabled=!1,i.textContent="Unggah",r.finish(21);case 25:case"end":return r.stop()}}),r,null,[[9,17,21,25]])})));return function(t){return r.apply(this,arguments)}}())}},{key:"_showToast",value:function(t){var e="toast-notification",r=document.getElementById(e);r&&r.remove(),(r=document.createElement("div")).id=e,r.className="fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded shadow-lg z-[1000]",r.textContent=t,document.body.appendChild(r),setTimeout((function(){r.remove()}),3e3)}},{key:"showError",value:function(t){var e=document.getElementById("story-detail-container");if(e)e.innerHTML='\n        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">\n          <strong class="font-bold">Error!</strong>\n          <span class="block sm:inline">'.concat(t,"</span>\n        </div>");else{var r=document.querySelector(".ml-16.min-h-screen.p-10");r?r.innerHTML='<p class="text-red-500 p-6">'.concat(t,"</p>"):alert(t)}}}],e&&To(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Fo(){var t=this;Go(Bo,this,(function(e){var r=e.detail,n=r.storyId,o=r.currentContent;n===t._storyId&&(t._presenter&&"function"==typeof t._presenter.editStory?le(n,o,t._presenter):console.error("StoryDetailPage: Presenter or presenter.editStory method is not available."))})),document.addEventListener("showEditStoryModalRequest",Lo(Bo,this))}function Ho(t){return Ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ho(t)}function Uo(){Uo=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==Ho(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ho(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function zo(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function qo(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){zo(i,n,o,a,s,"next",t)}function s(t){zo(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Ro(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wo(n.key),n)}}function Wo(t){var e=function(t){if("object"!=Ho(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ho(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ho(e)?e:e+""}var Jo=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.title="404 - Halaman Tidak Ditemukan"},e=[{key:"render",value:(n=qo(Uo().mark((function t(){return Uo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="min-h-screen flex items-center justify-center bg-gray-50">\n        <div class="text-center px-6 py-12 max-w-md mx-auto">\n          <div class="mb-8">\n            <div class="text-9xl font-bold text-third mb-6">404</div>\n          </div>\n\n          <h1 class="text-3xl font-bold text-gray-900 mb-4">\n            Halaman Tidak Ditemukan\n          </h1>\n          \n          <p class="text-gray-600 mb-8 leading-relaxed">\n            Maaf, halaman yang Anda cari tidak dapat ditemukan.\n          </p>\n\n          <div class="space-y-4">\n            <button \n              id="go-home" \n              class="w-full bg-third text-white py-3 px-6 rounded-lg font-medium hover:bg-third/90 transition-colors">\n              Kembali ke Beranda\n            </button>\n            \n            <button \n              id="go-back" \n              class="w-full border border-gray-300 text-gray-700 py-3 px-6 rounded-lg font-medium hover:bg-gray-50 transition-colors">\n              Kembali ke Halaman Sebelumnya\n            </button>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=qo(Uo().mark((function t(){return Uo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.attachEventListeners();case 1:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"attachEventListeners",value:function(){var t=document.getElementById("go-home"),e=document.getElementById("go-back");t&&t.addEventListener("click",(function(){window.location.hash="#/"})),e&&e.addEventListener("click",(function(){window.history.length>1?window.history.back():window.location.hash="#/"}))}}],e&&Ro(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Yo(t){return Yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yo(t)}function Ko(){Ko=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==Yo(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Yo(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function Vo(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function $o(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Vo(i,n,o,a,s,"next",t)}function s(t){Vo(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Xo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zo(n.key),n)}}function Qo(t,e,r){return(e=Zo(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zo(t){var e=function(t){if("object"!=Yo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Yo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Yo(e)?e:e+""}var ti=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Qo(this,"_commentId",null),Qo(this,"_presenter",null),Qo(this,"_commentDataChangedHandler",null),Qo(this,"_currentUser",null),this._commentId=e,this._presenter=new Vt(this),this._currentUser=this._presenter.getCurrentUser()},e=[{key:"render",value:(n=$o(Ko().mark((function t(){var e,r,n,o,i,a;return Ko().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=(null===(e=this._currentUser)||void 0===e?void 0:e.name)||"Nama Pengguna",i=null!==(r=this._currentUser)&&void 0!==r&&r.username?"@".concat(this._currentUser.username):"@namapengguna",a=(null===(n=this._currentUser)||void 0===n?void 0:n.profilePicture)||"./images/image.png",t.abrupt("return",'\n      <div class="ml-16 min-h-screen p-10">\n        <div class="mb-1">\n            <h1 class="text-2xl font-semibold text-gray-900 mb-2">Detail Komentar</h1>\n            <p class="text-gray-600">Lihat komentar dan balasannya.</p>\n            <hr class="mt-4 text-gray-300">\n        </div>\n\n        <div class="grid grid-cols-2 gap-4 h-screen">\n            <div class="overflow-y-auto p-6 mr-10 border-gray-200">\n            <div id="parent-comment-container" class="space-y-6"></div>\n\n            <div id="replies-list-container" class="mt-8 space-y-6">\n                <h3 class="text-lg font-semibold text-gray-900 mb-4">Semua Balasan</h3>\n            </div>\n            </div>\n\n            <div class="p-6">\n            <div class="space-y-6 mt-4">\n                '.concat(b({parentCommentId:this._commentId,username:o,handle:i,profilePicture:a}),"\n            </div>\n            </div>\n        </div>\n        </div>\n    "));case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=$o(Ko().mark((function t(){return Ko().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._presenter){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this._presenter.loadCommentDetail(this._commentId);case 4:this._setupReplyFormSubmit(),this._setupCommentDataChangedListener();case 6:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"_setupReplyFormSubmit",value:function(){var t=this,e=document.getElementById("reply-form-".concat(this._commentId));e&&e.addEventListener("submit",function(){var r=$o(Ko().mark((function r(n){var o,i,a,s;return Ko().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.preventDefault(),o=document.getElementById("reply-input-".concat(t._commentId)),i=e.querySelector('button[type="submit"]'),a=i.textContent,o&&o.value.trim()){r.next=7;break}return alert("Silakan masukkan balasan."),r.abrupt("return");case 7:return i.disabled=!0,i.textContent="Mengirim...",r.prev=9,r.next=12,t._presenter.addReplyToComment(t._commentId,o.value.trim());case 12:(s=r.sent).error?alert("Gagal mengirim balasan: ".concat(s.message)):o.value="",r.next=20;break;case 16:r.prev=16,r.t0=r.catch(9),console.error("Error submitting reply:",r.t0),alert("Gagal mengirim balasan: "+(r.t0.message||"Terjadi kesalahan"));case 20:return r.prev=20,i.disabled=!1,i.textContent=a,r.finish(20);case 24:case"end":return r.stop()}}),r,null,[[9,16,20,24]])})));return function(t){return r.apply(this,arguments)}}())}},{key:"_setupCommentDataChangedListener",value:function(){var t=this;this._commentDataChangedHandler=function(){var e=$o(Ko().mark((function e(r){var n,o,i,a;return Ko().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.detail,o=n.entityId,i=n.action,a=n.parentId,o!==t._commentId&&a!==t._commentId&&("replied"!==i||r.detail.storyId!==t._commentId)){e.next=6;break}if(console.log("CommentDetailPage: commentDataChanged event for current comment or its replies, reloading.",r.detail),!t._presenter){e.next=6;break}return e.next=6,t._presenter.loadCommentDetail(t._commentId);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),document.addEventListener("commentDataChanged",this._commentDataChangedHandler)}},{key:"showCommentDetail",value:function(t){var e,r,n,o,i=document.getElementById("parent-comment-container"),a=document.getElementById("replies-list-container");i&&a?(this._currentUser=this._presenter.getCurrentUser(),!t.isCommentAnonymous&&(null===(e=this._currentUser)||void 0===e||e.username,t.authorActualUsername),i.innerHTML=w({commentId:t.id,username:t.username||"Pengguna",content:t.content,profilePicture:t.profilePicture||"./images/image.png",createdAt:t.createdAt,likeCount:(null===(r=t.likes)||void 0===r?void 0:r.length)||t.likeCount||0,replyCount:(null===(n=t.replies)||void 0===n?void 0:n.length)||t.replyCount||0,isOwner:(null===(o=this._currentUser)||void 0===o?void 0:o.username)===t.username}),t.replies&&t.replies.length>0?this._renderCommentsRecursive(t.replies,a,1):a.innerHTML='<p class="text-gray-500 text-sm">Belum ada balasan untuk komentar ini.</p>',bo(this._presenter,i.id),So(this._presenter,i.id),bo(this._presenter,a.id),So(this._presenter,a.id)):console.error("Comment detail page containers not found.")}},{key:"_renderCommentsRecursive",value:function(t,e,r){var n=this;if(t&&0!==t.length){var o="";t.forEach((function(t){var e,i,a,s=(null===(e=n._currentUser)||void 0===e?void 0:e.username)===t.username,u=w({commentId:t.id,username:t.username||"Pengguna",content:t.content,profilePicture:t.profilePicture||"./images/image.png",createdAt:t.createdAt,likeCount:(null===(i=t.likes)||void 0===i?void 0:i.length)||t.likeCount||0,replyCount:(null===(a=t.replies)||void 0===a?void 0:a.length)||t.replyCount||0,isOwner:s}),c=document.createElement("div");c.innerHTML=u;var l=c.querySelector(".replies-container");l&&t.replies&&t.replies.length>0&&n._renderCommentsRecursive(t.replies,l,r+1),o+=c.innerHTML})),e.innerHTML=o}else e.innerHTML=1===r?'<p class="text-gray-500 text-sm">Belum ada balasan.</p>':""}},{key:"showError",value:function(t){var e=document.getElementById("parent-comment-container");e?e.innerHTML='<p class="text-red-500 p-4 text-center">'.concat(t,"</p>"):alert(t)}},{key:"destroy",value:function(){this._commentDataChangedHandler&&(document.removeEventListener("commentDataChanged",this._commentDataChangedHandler),this._commentDataChangedHandler=null),console.log("CommentDetailPage destroyed and listeners cleaned up.")}}],e&&Xo(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const ei={"/login":function(){return O(new Nn)},"/register":function(){return O(new ro)},"/":function(){return new H},"/story":function(){return I(new Pe)},"/calendar":function(){return I(new Re)},"/notification":function(){return I(new gr)},"/profile":function(){return I(new Zr)},"/chatbot":function(){return new ho},"/story/:id":function(t){return I(new Do(t))},"/404":function(){return new Jo},"/comment/:id":function(){return new ti}};function ri(t){return ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ri(t)}function ni(){ni=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==ri(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ri(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function oi(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function ii(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){oi(i,n,o,a,s,"next",t)}function s(t){oi(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ai(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,si(n.key),n)}}function si(t){var e=function(t){if("object"!=ri(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ri(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ri(e)?e:e+""}function ui(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function ci(t,e){return t.get(hi(t,e))}function li(t,e,r){return t.set(hi(t,e),r),r}function hi(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var fi=new WeakMap,di=new WeakMap,pi=new WeakMap,vi=new WeakMap,mi=new WeakMap,yi=new WeakMap;const gi=function(){return t=function t(e){var r=e.content,n=e.sidebar,o=e.sidebarToggle,i=e.sidebarToggleIcon,a=e.sidebarToggleContainer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ui(this,fi,null),ui(this,di,null),ui(this,pi,null),ui(this,vi,null),ui(this,mi,null),ui(this,yi,!1),li(fi,this,r),li(di,this,n),li(pi,this,o),li(vi,this,i),li(mi,this,a),this.setupSidebarToggle(),this.setupNavigationLinks()},e=[{key:"setupSidebarToggle",value:function(){var t=this;ci(pi,this)&&ci(vi,this)&&ci(di,this)&&ci(pi,this).addEventListener("click",(function(){console.log("clicked"),li(yi,t,!ci(yi,t)),ci(yi,t)?t.expandSidebar():t.collapseSidebar()}))}},{key:"setupNavigationLinks",value:function(){var t=this;document.querySelectorAll("nav a").forEach((function(e){e.addEventListener("click",(function(){ci(yi,t)&&t.collapseSidebar()}))}));var e=document.querySelector('a[href="#/"]');e&&e.addEventListener("click",(function(){ci(yi,t)&&t.collapseSidebar()})),this.updateActiveNavLink()}},{key:"collapseSidebar",value:function(){li(yi,this,!1),ci(di,this).classList.remove("w-56"),ci(di,this).classList.add("w-16"),ci(mi,this).classList.remove("ml-54"),ci(vi,this).innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="18" viewBox="0 0 24 24" width="18"><path d="M24 24H0V0h24v24z" fill="none" opacity=".87"/><path d="M7.38 21.01c.49.49 1.28.49 1.77 0l8.31-8.31c.39-.39.39-1.02 0-1.41L9.15 2.98c-.49-.49-1.28-.49-1.77 0s-.49 1.28 0 1.77L14.62 12l-7.25 7.25c-.48.48-.48 1.28.01 1.76z"/></svg>',document.querySelectorAll(".sidebar-label").forEach((function(t){return t.classList.add("hidden")}))}},{key:"expandSidebar",value:function(){li(yi,this,!0),ci(di,this).classList.remove("w-16"),ci(di,this).classList.add("w-56"),ci(mi,this).classList.add("ml-54"),ci(vi,this).innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="18" viewBox="0 0 24 24" width="18"><path d="M24 24H0V0h24v24z" fill="none" opacity=".87"/><path d="M16.62 2.99c-.49-.49-1.28-.49-1.77 0l-8.31 8.31c-.39.39-.39 1.02 0 1.41l8.31 8.31c.49.49 1.28.49 1.77 0s.49-1.28 0-1.77L9.38 12l7.25-7.25c.48-.48.48-1.28-.01-1.76z"/></svg>',document.querySelectorAll(".sidebar-label").forEach((function(t){return t.classList.remove("hidden")}))}},{key:"updateActiveNavLink",value:function(){var t=window.location.hash||"#/";document.querySelectorAll("nav a").forEach((function(e){var r=e.getAttribute("href"),n=e.querySelector("svg");r===t?(e.classList.add("text-[#00ADB5]"),n&&n.classList.add("text-[#00ADB5]")):(e.classList.remove("text-[#00ADB5]"),n&&n.classList.remove("text-[#00ADB5]"))}))}},{key:"renderPage",value:(r=ii(ni().mark((function t(){var e,r,n,o,i=this;return ni().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=x(),(r=ei[e])||(r=ei["/404"]),n=r()){t.next=6;break}return t.abrupt("return");case 6:o=a({updateDOM:function(){var t=ii(ni().mark((function t(){return ni().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.render();case 2:ci(fi,i).innerHTML=t.sent,n.afterRender(),i.updateActiveNavLink();case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}),o.ready.catch(console.error),o.updateCallbackDone.then((function(){scrollTo({top:0,behavior:"instant"})}));case 9:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&ai(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function wi(t){return wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wi(t)}function bi(){bi=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(e,r,n,o){var i=r&&r.prototype instanceof f?r:f,a=Object.create(i.prototype);return u(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var u=x(s,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var c=l(e,r,n);if("normal"===c.type){if(o=n.done?4:2,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=4,n.method="throw",n.arg=c.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h={};function f(){}function d(){}function p(){}var v={};u(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(j([])));y&&y!==r&&n.call(y,i)&&(v=y);var g=p.prototype=f.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==wi(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,h;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(wi(e)+" is not iterable")}return d.prototype=p,u(g,"constructor",p),u(p,"constructor",d),d.displayName=u(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},w(b.prototype),u(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),u(g,s,"Generator"),u(g,i,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,u=i[1],c=i[2];if(-1===i[0])return n("end"),!1;if(!u&&!c)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<u)return this.method="next",this.arg=t,n(u),!0;if(s<c)return n(c),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),h}},e}function xi(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function ki(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){xi(i,n,o,a,s,"next",t)}function s(t){xi(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Ei(){var t=window.location.hash.replace("#","")||"/",e=document.getElementById("navbar-container"),r=document.getElementById("mobile-navbar"),n=x(),o=void 0!==ei[n];["/login","/register","/404"].includes(t)||!o?(e&&(e.style.display="none"),r&&(r.style.display="none")):(e&&(e.style.display=""),r&&(r.style.display=""))}document.addEventListener("DOMContentLoaded",ki(bi().mark((function t(){var e;return bi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new gi({content:document.querySelector("#main-content"),sidebar:document.querySelector("#sidebar"),sidebarToggle:document.querySelector("#sidebar-toggle"),sidebarToggleIcon:document.querySelector("#sidebar-toggle-icon"),sidebarToggleContainer:document.querySelector("#sidebar-toggle-container")}),t.next=3,e.renderPage();case 3:return t.next=5,u();case 5:console.log("Berhasil mendaftarkan service worker."),Ei(),window.addEventListener("hashchange",ki(bi().mark((function t(){return bi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.renderPage();case 2:Ei();case 3:case"end":return t.stop()}}),t)}))));case 8:case"end":return t.stop()}}),t)}))))})();