/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{checkAuthenticatedRoute:()=>A,checkProtectedRoute:()=>M,checkUnauthenticatedRouteOnly:()=>N,getAccessToken:()=>T,getLogout:()=>G,putAccessToken:()=>L,removeAccessToken:()=>C});var r={};function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){o=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function d(e,r,n,o){var i=r&&r.prototype instanceof p?r:p,a=Object.create(i.prototype);return l(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=h(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new _(o||[])),!0),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var f={};function p(){}function m(){}function v(){}var y={};l(y,s,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(P([])));b&&b!==r&&i.call(b,s)&&(y=b);var w=v.prototype=p.prototype=Object.create(y);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,a,s,c){var u=h(t[o],t,a);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==n(d)&&i.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,s,c)}),(function(t){r("throw",t,s,c)})):e.resolve(d).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,c)}))}c(u.arg)}var o;l(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function E(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=h(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,f;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function S(t){this.tryEntries.push(t)}function j(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function _(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function P(e){if(null!=e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(i.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return m.prototype=v,l(w,"constructor",v),l(v,"constructor",m),m.displayName=l(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,u,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},x(k.prototype),l(k.prototype,c,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(d(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(w),l(w,u,"Generator"),l(w,s,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=P,_.prototype={constructor:_,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),j(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:P(e),r,n},"next"===this.method&&(this.arg=t),f}},e}function i(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function a(t){var e=t.skipTransition,r=void 0!==e&&e,n=t.updateDOM;if(r||!document.startViewTransition){var o=Promise.resolve(n()).then((function(){}));return{ready:Promise.reject(Error("View transitions unsupported")),updateCallbackDone:o,finished:o}}return document.startViewTransition(n)}function s(t){t.style.height="auto",t.style.height=t.scrollHeight+"px"}function c(){return u.apply(this,arguments)}function u(){var t;return t=o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("serviceWorker"in navigator){t.next=3;break}return console.log("Service Worker API unsupported"),t.abrupt("return");case 3:return t.prev=3,t.next=6,navigator.serviceWorker.register("/sw.bundle.js");case 6:e=t.sent,console.log("Service worker telah terpasang",e),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),console.log("Failed to install service worker:",t.t0);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})),u=function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function s(t){i(a,n,o,s,c,"next",t)}function c(t){i(a,n,o,s,c,"throw",t)}s(void 0)}))},u.apply(this,arguments)}function l(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=atob(e),n=new Uint8Array(r.length),o=0;o<r.length;o++)n[o]=r.charCodeAt(o);return n}t.r(r),t.d(r,{checkTodayEntry:()=>it,commentOnStory:()=>kt,deleteCommentApi:()=>Rt,deleteStory:()=>Gt,editStory:()=>Mt,getChatHistory:()=>Xt,getCommentDetail:()=>Ut,getEntryByDate:()=>st,getLogin:()=>nt,getNotifications:()=>_t,getRegister:()=>et,getStories:()=>ft,getStoryDetail:()=>bt,getUserProfile:()=>yt,getUserRecommendations:()=>Jt,getWeeklyTrackerEntries:()=>dt,likeComment:()=>Ht,likeStory:()=>wt,markAllNotificationsAsRead:()=>Tt,markNotificationAsRead:()=>Ot,postStory:()=>mt,regenerateRecommendations:()=>Kt,replyToComment:()=>Dt,saveEntry:()=>ut,subscribePushNotification:()=>Ct,unsubscribePushNotification:()=>Nt,updateProfile:()=>St});var d=function(){return'\n    <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">\n        <h2 class="text-2xl font-semibold mb-4">Login Diperlukan</h2>\n        <p class="text-gray-600 mb-6">Silakan login untuk mengakses fitur ini.</p>\n        <div class="flex justify-end gap-4">\n            <button id="cancel-login" class="px-4 py-2 text-gray-600 hover:text-gray-800">Batal</button>\n            <button id="go-to-login" class="px-4 py-2 bg-third text-white rounded-lg hover:bg-third/80">Login</button>\n        </div>\n    </div>\n'};function h(t){return'\n        <div class="flex justify-end mb-3">\n            <div class="flex flex-row-reverse items-start gap-2 max-w-[80%]">\n                <div class="bg-[#7de3e1] px-4 py-2 rounded-lg text-sm text-gray-800 text-left">\n                    '.concat(t,"\n                </div>\n            </div>\n        </div>\n    ")}function f(t){return'\n        <div class="flex justify-start mb-3">\n            <div class="flex items-start gap-2 max-w-[90%] lg:max-w-[80%]">\n                <div class="w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0">\n                    <img src="images/logo.png" alt="MindBlown" class="w-4 h-4 object-contain">\n                </div>\n                <div class="bg-white px-3 py-2 rounded-lg text-xs lg:text-sm text-gray-800 text-left">\n                    '.concat(t,"\n                </div>\n            </div>\n        </div>\n    ")}function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{weekRange:{},entries:[]};if(!t.entries||0===t.entries.length)return'\n      <div class="bg-white rounded-xl border border-gray-200 p-4 mt-6 mb-8">\n        <div class="text-center py-4 text-gray-500">\n          <p>Belum ada data mood tracker untuk minggu ini.</p>\n        </div>\n      </div>\n    ';var e=t.entries,r=t.weekRange,n=new Date(r.start),o=new Date(r.end),i="".concat(n.toLocaleDateString("id-ID",{day:"numeric"})," - ").concat(o.toLocaleDateString("id-ID",{day:"numeric"})," ").concat(o.toLocaleDateString("id-ID",{month:"long",year:"numeric"})),a=e.filter((function(t){return t.hasEntry})).length>0,s=e.map((function(t){return t.hasEntry?{joy:20,neutral:45,sadness:70,anger:70}[t.mood]||45:40})),c=Math.max(500,100*(e.length-1)+40),u=60*(e.length-1)+80,l=e.filter((function(t){return t.hasEntry})).map((function(t,r){var n=e.findIndex((function(e){return e.date===t.date})),o=20+100*n,i=s[n];return"".concat(o,",").concat(i)})).join(" "),d=e.filter((function(t){return t.hasEntry})).map((function(t,r){var n=e.findIndex((function(e){return e.date===t.date})),o=20+60*n,i=s[n];return"".concat(o,",").concat(i)})).join(" ");return a?'\n    <div class="bg-white rounded-xl border border-gray-200 p-4 mt-6 mb-8">\n      <div class="mb-2">\n        <h3 class="text-base font-medium text-gray-700">Mood dalam 1 Minggu</h3>\n        <p class="text-xs text-gray-500">'.concat(i,'</p>\n      </div>\n      \n      <div class="flex items-center justify-between">\n        <button class="rounded-full border border-gray-300 w-8 h-8 flex items-center justify-center text-gray-500 hover:bg-gray-100" id="moodPrevBtn" aria-label="Sebelumnya">\n          &larr;\n        </button>\n        \n        \x3c!-- Desktop View --\x3e\n        <div class="flex-1 hidden lg:block overflow-hidden">\n          <div class="relative w-full" style="height:').concat(120,'px;">\n            <div style="position:relative; width:').concat(c,"px; height:").concat(120,'px; margin:0 auto;">\n              ').concat(l?'\n              <svg width="'.concat(c,'" height="').concat(80,'" style="position:absolute;top:0;left:0;">\n                <polyline\n                  fill="none"\n                  stroke="#333"\n                  stroke-width="2"\n                  points="').concat(l,'"\n                />\n              </svg>\n              '):"","\n              \n              ").concat(e.map((function(t,e){var r=new Date(t.date),n=r.toLocaleDateString("id-ID",{weekday:"short"}),o=r.getDate(),i=r.toLocaleDateString("id-ID",{month:"short"}),a="".concat(n,", ").concat(o," ").concat(i),c=20+100*e,u=s[e],l="‚ùì",d="";return t.hasEntry&&(l=m(t.mood),d="cursor-pointer"),'\n                  <div style="position:absolute;left:'.concat(c-18,"px;top:").concat(u-18,'px;width:36px;height:36px;display:flex;flex-direction:column;align-items:center;"\n                      class="').concat(d,'" \n                      data-date="').concat(t.date,'" \n                      data-mood="').concat(t.mood||"",'"\n                      data-progress="').concat(t.progress||"",'">\n                    <span style="font-size:2rem;line-height:1;">').concat(l,'</span>\n                  </div>\n                  <div style="position:absolute;left:').concat(c-30,"px;top:").concat(85,'px;width:60px;text-align:center;font-size:10px;color:#666;">\n                    ').concat(a,"\n                  </div>\n                ")})).join(""),'\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- Mobile View - Using main arrows only --\x3e\n        <div class="flex-1 lg:hidden">\n          <div class="mood-mobile-carousel relative w-full" style="height:').concat(120,'px;">\n            <div class="mood-mobile-carousel-inner" style="position:relative; width:').concat(200,"px; height:").concat(120,'px; margin:0 auto; overflow:hidden;">\n              <div class="mood-mobile-carousel-slides" style="position:absolute; top:0; left:0; width:').concat(u,"px; height:").concat(120,'px; transition: transform 0.3s ease;">\n                ').concat(d?'\n                <svg width="'.concat(u,'" height="').concat(80,'" style="position:absolute;top:0;left:0;">\n                  <polyline\n                    fill="none"\n                    stroke="#333"\n                    stroke-width="2"\n                    points="').concat(d,'"\n                  />\n                </svg>\n                '):"","\n                \n                ").concat(e.map((function(t,e){var r=new Date(t.date),n=r.toLocaleDateString("id-ID",{weekday:"short"}),o=r.getDate(),i=r.toLocaleDateString("id-ID",{month:"short"}),a="".concat(n,", ").concat(o," ").concat(i.slice(0,3)),c=20+60*e,u=s[e],l="‚ùì",d="";return t.hasEntry&&(l=m(t.mood),d="cursor-pointer"),'\n                    <div style="position:absolute;left:'.concat(c-18,"px;top:").concat(u-18,'px;width:36px;height:36px;display:flex;flex-direction:column;align-items:center;"\n                        class="').concat(d,'" \n                        data-date="').concat(t.date,'" \n                        data-mood="').concat(t.mood||"",'"\n                        data-progress="').concat(t.progress||"",'">\n                      <span style="font-size:1.5rem;line-height:1;">').concat(l,'</span>\n                    </div>\n                    <div style="position:absolute;left:').concat(c-30,"px;top:").concat(85,'px;width:60px;text-align:center;font-size:9px;color:#666;">\n                      ').concat(a,"\n                    </div>\n                  ")})).join(""),'\n              </div>\n              \n              \x3c!-- Mobile navigation indicator dots --\x3e\n              <div class="absolute bottom-0 left-0 right-0 flex justify-center gap-1 pt-1">\n                ').concat(Array.from({length:Math.ceil(e.length/3)}).map((function(t,e){return'<span class="mobile-carousel-dot w-1.5 h-1.5 rounded-full bg-gray-300 '.concat(0===e?"active bg-third":"",'" data-index="').concat(e,'"></span>')})).join(""),'\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <button class="rounded-full border border-gray-300 w-8 h-8 flex items-center justify-center text-gray-500 hover:bg-gray-100" id="moodNextBtn" aria-label="Selanjutnya">\n          &rarr;\n        </button>\n      </div>\n      \n      <div class="text-xs text-gray-500 text-right mt-2">\n        Tap emoji untuk detail\n      </div>\n    </div>\n  '):'\n      <div class="bg-white rounded-xl border border-gray-200 p-4 mt-6 mb-8">\n        <div class="text-center py-4 text-gray-500">\n          <p>Belum ada data mood yang direkam minggu ini.</p>\n          <p class="text-xs mt-1">Rekam mood harianmu untuk melihat grafik.</p>\n        </div>\n      </div>\n    '}function m(t){return{joy:"üòÑ",neutral:"üòê",sadness:"üòî",anger:"üò†"}[t]||"‚ùì"}function v(t){var e,r,n,o,i,a=t.id,s=void 0===a?"":a,c=t.icon,u=void 0===c?"images/logo.png":c,l=t.title,d=void 0===l?"":l,h=t.message,f=void 0===h?"":h,p=t.read,m=void 0!==p&&p,v=t.createdAt,y=void 0===v?"":v,g=y?(e=new Date(y),r=new Date-e,n=Math.floor(r/6e4),o=Math.floor(r/36e5),i=Math.floor(r/864e5),n<1?"Baru saja":n<60?"".concat(n," menit yang lalu"):o<24?"".concat(o," jam yang lalu"):i<7?"".concat(i," hari yang lalu"):e.toLocaleDateString("id-ID")):"";return'\n    <div class="flex items-start gap-3 py-4 border-b border-gray-200 cursor-pointer hover:bg-gray-50 '.concat(m?"opacity-60":"",'" \n         data-notification-id="').concat(s,'">\n      <div class="w-8 h-8 flex-shrink-0 flex items-center justify-center">\n        <img src="').concat(u,'" alt="icon" class="w-7 h-7 object-cover">\n      </div>\n      <div class="text-left flex-1">\n        <div class="flex justify-between items-start">\n          <div class="font-semibold text-base text-gray-800 mb-1">').concat(d,"</div>\n          ").concat(m?"":'<div class="w-2 h-2 bg-third rounded-full flex-shrink-0"></div>','\n        </div>\n        <div class="text-sm text-gray-700 leading-snug mb-1">').concat(f,"</div>\n        ").concat(g?'<div class="text-xs text-gray-500">'.concat(g,"</div>"):"","\n      </div>\n    </div>\n  ")}function y(t){var e=t.username,r=void 0===e?"Pengguna":e,n=t.handle,o=void 0===n?"Anonim":n,i=t.content,a=void 0===i?"":i,s=(t.isAnonymous,t.likeCount),c=void 0===s?0:s,u=t.commentCount,l=void 0===u?0:u,d=t.viewCount,h=void 0===d?0:d,f=t.storyId,p=void 0===f?"":f,m=t.profilePicture,v=void 0===m?"./images/image.png":m,y=t.createdAt,g=void 0===y?"":y,b=t.isOwner,w=void 0!==b&&b,x=t.userLiked,k=void 0!==x&&x,E=t.isLiked,S=void 0!==E&&E,j="";if(g)try{var _=new Date(g);j=isNaN(_.getTime())?"Tanggal tidak valid":_.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){j="Gagal memuat tanggal"}var P=k||S,O=P?"liked":"",I=P?"fill-red-500 text-red-500":"fill-none text-gray-500",T=P?"text-red-500 font-semibold":"text-gray-600",L=parseInt(c)||0;return'\n    <div class="story-container flex items-start gap-3 py-3 border-b border-gray-200 max-w-2xl" data-story-id="'.concat(p,'">\n      <div class="w-10 h-10 flex-shrink-0 user-info">\n        <img src="').concat(v,'" alt="icon" class="w-10 h-10 object-cover rounded-full" />\n      </div>\n\n      <div class="flex flex-col text-left story-content w-full">\n        <div class="flex justify-between items-start">\n          <div class="user-info">\n            <div class="font-semibold text-base text-gray-800">').concat(r,'</div>\n            <div class="text-sm text-gray-500">').concat(o,"</div>\n          </div>\n\n          ").concat(w?'\n          <div class="relative">\n            <button class="story-menu-btn p-1 text-gray-500 hover:text-gray-700">\n              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                <circle cx="12" cy="12" r="1"></circle>\n                <circle cx="12" cy="5" r="1"></circle>\n                <circle cx="12" cy="19" r="1"></circle>\n              </svg>\n            </button>\n\n            <div class="story-menu hidden absolute right-0 mt-1 w-32 bg-white rounded-md shadow-lg z-10 border border-gray-200">\n              <button class="edit-story-btn w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" data-story-id="'.concat(p,'">Sunting</button>\n              <button class="delete-story-btn w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100" data-story-id="').concat(p,'">Hapus</button>\n            </div>\n          </div>\n          '):"",'\n        </div>\n\n        <p class="text-gray-700 mt-3 text-sm leading-relaxed">').concat(a,"</p>\n\n        ").concat(j?'\n          <div class="text-xs text-gray-400 mt-2">\n            '.concat(j,"\n          </div>\n          "):"",'\n\n        <div class="flex items-center justify-between md:justify-start md:gap-8 mt-3">\n          <button class="like-btn flex items-center gap-1 ').concat(O,'" data-story-id="').concat(p,'">\n            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="').concat(I,'"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>\n            <span class="like-count text-sm ').concat(T,'" style="display:inline-block; min-width:16px; padding-left:4px;">').concat(L,'</span>\n          </button>\n          <button class="comment-btn flex items-center gap-1" data-story-id="').concat(p,'">\n            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>\n            <span class="comment-count text-sm">').concat(l,'</span>\n          </button>\n          <button class="view-btn flex items-center gap-1" data-story-id="').concat(p,'">\n            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 flex-shrink-0" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 17c-.55 0-1-.45-1-1v-5c0-.55.45-1 1-1s1 .45 1 1v5c0 .55-.45 1-1 1zm4 0c-.55 0-1-.45-1-1V8c0-.55.45-1 1-1s1 .45 1 1v8c0 .55-.45 1-1 1zm4 0c-.55 0-1-.45-1-1v-2c0-.55.45-1 1-1s1 .45 1 1v2c0 .55-.45 1-1 1zm2 2H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h12c.55 0 1 .45 1 1v12c0 .55-.45 1-1 1zm1-16H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/></svg>\n            <span class="view-count text-sm">').concat(h,"</span>\n          </button>\n        </div>\n      </div>\n    </div>\n  ")}function g(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.username,r=void 0===e?"Nama Pengguna":e,n=t.handle,o=void 0===n?"@namapengguna":n,i=t.timestamp,a=void 0===i?"":i,s=t.profilePicture,c=void 0===s?"./images/image.png":s;return new Date(a).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),'\n    <form id="chat-form" class="mt-auto sticky">\n    <div class="flex items-start gap-3 py-4 border-gray-200 max-w-2xl">\n    <div class="w-10 h-10 flex-shrink-0">\n        <img src="'.concat(c,'" alt="icon" class="w-10 h-10 object-cover rounded-full" />\n      </div>\n\n      <div class="flex flex-col text-left w-full">\n      <div>\n        <div class="font-semibold text-base text-gray-800">').concat(r,'</div>\n        <div class="text-sm text-gray-500 mb-4">').concat(o,'</div>\n      </div>\n      <div class="relative w-full z-50 w-full max-w-2xl mx-auto">\n        <textarea \n          id="chat-input"\n          class="text-[#8c8c8c] w-full h-24 px-4 py-3 pr-14 rounded-3xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent overflow-hidden"\n          placeholder="Ada cerita apa?..."></textarea>\n        <button class="absolute right-3 top-1/2 transform -translate-y-1/2 rounded-full bg-[#eee] p-2 w-25 text-white py-2 mt-2 hover:bg-third focus:bg-third justify-end" type="submit">Unggah</button>\n      </div>\n      <div class="mt-2 flex items-center">\n        <input type="checkbox" id="post-anonymously" class="mr-2">\n        <label for="post-anonymously" class="text-sm text-gray-600">Unggah sebagai anonim</label>\n      </div>\n    </div>\n    </form>\n  ')}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.username,r=void 0===e?"Nama Pengguna":e,n=t.handle,o=void 0===n?"@namapengguna":n,i=t.profilePicture;return'\n    <form id="comment-form" class="sticky top-4">\n      <div class="flex items-start gap-3 py-4 border-gray-200 max-w-2xl">\n        <div class="w-10 h-10 flex-shrink-0">\n          <img src="'.concat(void 0===i?"./images/image.png":i,'" alt="icon" class="w-10 h-10 object-cover rounded-full" />\n        </div>\n\n        <div class="flex flex-col text-left w-full">\n          <div>\n            <div class="font-semibold text-base text-gray-800">').concat(r,'</div>\n            <div class="text-sm text-gray-500 mb-4">').concat(o,'</div>\n          </div>\n          <div class="relative w-full z-50">\n            <textarea \n              id="comment-input"\n              class="text-[#8c8c8c] w-full h-24 px-4 py-3 pr-14 rounded-3xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent overflow-hidden"\n              placeholder="Unggah komentarmu..."></textarea>\n            <button class="absolute right-3 top-1/2 transform -translate-y-1/2 rounded-full bg-[#eee] p-2 w-25 text-white py-2 mt-2 hover:bg-teal-500 focus:bg-teal-500 justify-end" type="submit">Unggah</button>\n          </div>\n        </div>\n      </div>\n    </form>\n  ')}function w(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.commentId,r=void 0===e?"":e,n=t.username,o=void 0===n?"Pengguna":n,i=t.handle,a=void 0===i?"Anonim":i,s=t.content,c=void 0===s?"":s,u=t.profilePicture,l=void 0===u?"./images/image.png":u,d=t.createdAt,h=void 0===d?"":d,f=t.likeCount,p=void 0===f?0:f,m=t.replyCount,v=void 0===m?0:m,y=t.isOwner,g=void 0!==y&&y,b=t.userLiked,w=void 0!==b&&b,x=t.isLiked,k=void 0!==x&&x,E="";if(h)try{var S=new Date(h);E=isNaN(S.getTime())?"Tanggal tidak valid":S.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){E="Gagal memuat tanggal"}var j=parseInt(p)||0,_=w||k,P=_?"liked":"",O=_?"fill-red-500 text-red-500":"fill-none text-gray-500",I=_?"text-red-500 font-semibold":"text-gray-600";return'\n    <div class="comment-item-container flex items-start gap-3 py-3 border-b border-gray-200" data-comment-id="'.concat(r,'">\n      <div class="w-8 h-8 flex-shrink-0 user-info">\n        <img src="').concat(l,'" alt="icon" class="w-8 h-8 object-cover rounded-full" />\n      </div>\n\n      <div class="flex flex-col text-left comment-content w-full">\n        <div class="flex justify-between items-start">\n        <div class="user-info">\n          <div class="font-semibold text-sm text-gray-800 username-comment">').concat(o,'</div>\n          <div class="text-sm text-gray-500 mb-3 handle-comment">').concat(a,"</div>\n        </div>\n          ").concat(g?'\n            <div class="relative comment-actions-menu">\n              <button class="comment-menu-btn p-1 text-gray-500 hover:text-gray-700">\n                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                <circle cx="12" cy="12" r="1"></circle>\n                <circle cx="12" cy="5" r="1"></circle>\n                <circle cx="12" cy="19" r="1"></circle>\n              </svg>\n              </button>\n              <div class="comment-menu hidden absolute right-0 mt-1 w-32 bg-white rounded-md shadow-lg z-10 border border-gray-200">\n                <button class="delete-comment-btn w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100" data-comment-id="'.concat(r,'">Hapus</button>\n              </div>\n            </div>\n          '):"",'\n        </div>\n\n        <p class="text-gray-700 mt-1 text-sm leading-relaxed">').concat(c,"</p>\n\n        ").concat(E?'<div class="text-xs text-gray-400">'.concat(E,"</div>"):"",'\n\n        <div class="flex items-center gap-4 mt-2">\n          <button class="comment-like-btn flex items-center gap-1 text-xs ').concat(P,'" data-comment-id="').concat(r,'">\n            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="').concat(O,'"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>\n            <span class="comment-like-count ').concat(I,'">').concat(j,'</span>\n          </button>\n          <a href="#/comment/').concat(r,'" class="comment-reply-link flex items-center gap-1 text-xs text-gray-500 hover:text-teal-500">\n            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>\n            <span class="comment-reply-count">').concat(v,'</span>\n          </a>\n        </div>\n        <div class="replies-container mt-4 pl-4 border-l-2 border-gray-200 space-y-4" hidden>\n        </div>\n      </div>\n    </div>\n  ')}function x(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.parentCommentId,r=void 0===e?"":e,n=t.username,o=void 0===n?"Nama Pengguna":n,i=t.handle,a=void 0===i?"@namapengguna":i,s=t.profilePicture,c=void 0===s?"./images/image.png":s;return'\n    <form id="reply-form-'.concat(r,'" class="sticky top-4 reply-form-container" data-parent-comment-id="').concat(r,'">\n      <div class="flex items-start gap-3 py-4 border-gray-200 max-w-2xl">\n        <div class="w-10 h-10 flex-shrink-0">\n          <img src="').concat(c,'" alt="icon" class="w-10 h-10 object-cover rounded-full" />\n        </div>\n        <div class="flex flex-col text-left w-full">\n          <div>\n            <div class="font-semibold text-base text-gray-800">').concat(o,'</div>\n            <div class="text-sm text-gray-500 mb-2">').concat(a,'</div>\n          </div>\n          <div class="relative w-full z-10">\n            <textarea\n              id="reply-input-').concat(r,'"\n              class="text-[#8c8c8c] w-full h-24 px-4 py-3 pr-14 rounded-3xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent overflow-hidden"\n              placeholder="Tulis balasanmu..."></textarea>\n            <button class="absolute right-3 top-1/2 transform -translate-y-1/2 rounded-full bg-[#eee] p-2 w-25 text-white py-2 mt-2 hover:bg-teal-500 justify-end" type="submit">Unggah</button>\n          </div>\n        </div>\n      </div>\n    </form>\n  ')}function k(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t&&0!==t.length?'\n    <div class="mt-6">\n      <div class="flex items-center justify-between mb-3">\n        <h3 class="text-left font-medium text-gray-800">Rekomendasi Aktivitas Untukmu</h3>\n        <button id="regenerate-recommendations" class="text-sm text-third hover:text-third/80 flex items-center">\n          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">\n            <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />\n          </svg>\n          Rekomendasi Lain\n        </button>\n      </div>\n      <div class="space-y-3">\n        '.concat(t.map((function(t){return'\n          <div class="bg-gray-50 border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow">\n            <div class="flex items-center mb-2">\n              <span class="bg-third/10 text-third text-xs px-2 py-1 rounded-md">'.concat(t.category,'</span>\n              <span class="ml-2 text-xs text-gray-500">').concat(t.duration,'</span>\n            </div>\n            <h4 class="font-medium text-sm text-left">').concat(t.name,'</h4>\n            <div class="flex items-center mt-2">\n              <span class="bg-gray-100 text-xs px-2 py-1 rounded-md flex items-center">\n                <span class="text-gray-600">').concat({Rendah:"Cocok untuk energi terbatas",Sedang:"Membutuhkan energi sedang",Tinggi:"Membutuhkan energi penuh","Rendah-Sedang":"Cocok untuk energi rendah ke sedang","Sedang-Lama":"Membutuhkan energi sedang untuk waktu yang lebih lama",Lama:"Membutuhkan waktu lama untuk menyelesaikan"}[e=t.energy_needed]||e,"</span>\n              </span>\n            </div>\n          </div>\n        ");var e})).join(""),"\n      </div>\n    </div>\n  "):'\n      <div class="mt-6">\n        <div class="flex items-center justify-between mb-3">\n          <h3 class="text-left font-medium text-gray-800">Rekomendasi Aktivitas Untukmu</h3>\n          <button id="regenerate-recommendations" class="text-sm text-third hover:text-third/80 flex items-center">\n            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor">\n              <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" />\n            </svg>\n            Rekomendasi Lain\n          </button>\n        </div>\n        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 text-center text-gray-500">\n          Belum ada rekomendasi aktivitas untuk ditampilkan.\n        </div>\n      </div>\n    '}function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",r=document.getElementById("toast-notification");r&&r.remove();var n='\n        <div id="toast-notification" class="fixed bottom-4 right-4 '.concat("success"===e?"bg-green-500":"bg-red-500",' text-white py-2 px-4 rounded-md shadow-lg flex items-center z-50 transform transition-all duration-300 opacity-0 translate-y-2">\n            ').concat("success"===e?'<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>\n                </svg>':'<svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>\n                </svg>',"\n            <span>").concat(t,"</span>\n        </div>\n    ");document.body.insertAdjacentHTML("beforeend",n);var o=document.getElementById("toast-notification");setTimeout((function(){o.classList.remove("opacity-0","translate-y-2"),o.classList.add("opacity-100","translate-y-0")}),10),setTimeout((function(){o.classList.add("opacity-0","translate-y-2"),setTimeout((function(){o.remove()}),300)}),3e3)}function S(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sedang mengetik...",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e?"typing-".concat(e):"typing-indicator";return'\n    <div id="'.concat(r,'" class="flex justify-start mb-4">\n        <div class="bg-gray-100 rounded-2xl p-3 px-4 max-w-[75%] text-left">\n            <div class="flex items-center">\n                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse mr-1"></div>\n                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse delay-75 mr-1"></div>\n                <div class="w-2 h-2 bg-gray-400 rounded-full animate-pulse delay-150"></div>\n            </div>\n            <div class="text-xs text-gray-500 mt-1">').concat(t,"</div>\n        </div>\n    </div>\n    ")}function j(t){var e=t.split("/");return{resource:e[1]||null,id:e[2]||null}}function _(){return location.hash.replace("#","")||"/"}function P(){return t=j(_()),e="",t.resource&&(e=e.concat("/".concat(t.resource))),t.id&&(e=e.concat("/:id")),e||"/";var t,e}var O="accessToken",I="https://backend-mindblown-production.up.railway.app";function T(){try{var t=localStorage.getItem(O);return"null"===t||"undefined"===t?null:t}catch(t){return console.error("getAccessToken: error:",t),null}}function L(t){try{return localStorage.setItem(O,t),!0}catch(t){return console.error("putAccessToken: error:",t),!1}}function C(){try{return localStorage.removeItem(O),!0}catch(t){return console.error("getLogout: error:",t),!1}}var B=["/login","/register"];function N(t){var e=P(),r=!!T();return B.includes(e)&&r?(location.hash="/",null):t}function A(t){return T()?t:(location.hash="/login",null)}function M(t){var e;return T()?t:(window.location.hash,(e=document.createElement("div")).className="fixed inset-0 bg-black/70 flex items-center justify-center z-50",e.innerHTML=d(),document.body.appendChild(e),document.getElementById("cancel-login").addEventListener("click",(function(){e.remove(),window.history.back()})),document.getElementById("go-to-login").addEventListener("click",(function(){e.remove(),window.location.hash="/login"})),null)}function G(){C()}function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function F(){F=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==D(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(D(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function H(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function q(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){H(i,n,o,a,s,"next",t)}function s(t){H(i,n,o,a,s,"throw",t)}a(void 0)}))}}function R(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,z(n.key),n)}}function z(t){var e=function(t){if("object"!=D(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==D(e)?e:e+""}function U(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var W=new WeakSet,J=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,W),this.isProcessing=!1},e=[{key:"render",value:(n=q(F().mark((function t(){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="md:ml-16 h-150 md:h-screen lg:min-h-screen flex items-center">\n        <div class="w-full flex items-center pb-20"> \n            <div class="max-w-2xl w-full mx-auto text-center">\n                <img src="images/logo.png" alt="Logo" class="w-27 h-27 mx-auto mb-3 lg:mb-10 mt-30">\n                <h1 class="text-primary lg:text-3xl text-2xl font-semibold mb-1">Hai, aku MindBlown!</h1>\n                <p class="text-secondary mb-8 lg:text-lg text-sm px-10 lg:px-0">Apa pun yang kamu rasain sekarang, itu valid. Mau cerita sedikit?</p>\n\n                <div id="chat-container" class="flex flex-col gap-2 px-4"></div>\n                \n                <form id="chat-form" class="relative mx-4 lg:mx-0 flex flex-col gap-2">\n                    <textarea \n                      id="chat-input"\n                      class="text-[#8c8c8c] w-full h-16 lg:h-24 px-4 py-3 pr-14 rounded-3xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent overflow-hidden   placeholder:leading-[2rem] lg:placeholder:leading-[4rem]"\n                      placeholder="Cerita sedikit..."></textarea>\n                    <button class="absolute right-3 top-1/2 transform -translate-y-1/2 rounded-full bg-[#eee] p-2 flex items-center justify-center hover:bg-third focus:bg-third transition cursor-pointer">\n                       <svg xmlns="http://www.w3.org/2000/svg"  class="w-6 h-6 text-white" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="white" id="Send--Streamline-Mynaui" height="16" width="16">\n                        <path d="m8.75 6.25 -1.875 1.875m5.805 -6.230625a0.33437500000000003 0.33437500000000003 0 0 1 0.42500000000000004 0.42562500000000003l-3.7025 10.58125a0.33437500000000003 0.33437500000000003 0 0 1 -0.62125 0.025l-2.011875 -4.52625a0.33375 0.33375 0 0 0 -0.169375 -0.169375l-4.52625 -2.0125a0.33437500000000003 0.33437500000000003 0 0 1 0.025 -0.620625z" stroke-width="1"></path>\n                    </svg>\n                    </button>\n                </form>\n            </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=q(F().mark((function t(){var e,r,n;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:T()||sessionStorage.getItem("welcomeModalShown")||U(W,this,K).call(this),e=document.getElementById("chat-input"),r=document.getElementById("chat-form"),n=document.getElementById("chat-container"),e.addEventListener("input",(function(){return s(e)})),localStorage.getItem("pendingChatMessage")&&localStorage.removeItem("pendingChatMessage"),U(W,this,Y).call(this,n,e,r);case 8:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],e&&R(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Y(t,e,r){var n=this,o=function(){requestAnimationFrame((function(){t.scrollTop=t.scrollHeight}))};r.addEventListener("submit",(function(i){if(i.preventDefault(),!n.isProcessing){var a=e.value.trim();if(a){n.isProcessing=!0,e.disabled=!0;var s=r.querySelector("button");s&&(s.disabled=!0),t.insertAdjacentHTML("beforeend",h(a)),o(),e.value="",e.style.height="",t.insertAdjacentHTML("beforeend",S("Mengarahkan ke chatbot...")),o(),localStorage.setItem("pendingChatMessage",a),localStorage.setItem("hasInteractedWithChatbot","true"),window.location.hash="/chatbot"}}}))}function K(){if(!document.getElementById("welcome-modal")){var t=document.createElement("div");t.id="welcome-modal",t.innerHTML='\n  <div class="fixed inset-0 bg-black/70 flex items-center justify-center z-50">\n    <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 text-center">\n      <h2 class="text-2xl font-semibold mb-2">Selamat Datang</h2>\n      <p class="text-gray-600 mb-5 text-sm">\n         Masuk atau daftar untuk menikmati lebih banyak fitur unggulan dari kami ...\n      </p>\n      <button id="welcome-login" class="w-full py-2 mb-3 rounded-full bg-third text-white font-semibold border-2 border-third hover:bg-third/80 transition">Log in</button>\n      <button id="welcome-signup" class="w-full py-2 mb-3 rounded-full border-2 border-third text-black font-semibold hover:bg-gray-100 transition">Sign up</button>\n      <a href="#" id="welcome-stay-logged-out" class="text-gray-500 underline text-sm">Lewati untuk sekarang</a>\n    </div>\n  </div>\n',document.body.appendChild(t),sessionStorage.setItem("welcomeModalShown","true"),document.getElementById("welcome-login").onclick=function(){t.remove(),window.location.hash="/login"},document.getElementById("welcome-signup").onclick=function(){t.remove(),window.location.hash="/register"},document.getElementById("welcome-stay-logged-out").onclick=function(e){e.preventDefault(),t.remove()}}}function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function X(){X=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==V(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(V(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function $(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Q(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){$(i,n,o,a,s,"next",t)}function s(t){$(i,n,o,a,s,"throw",t)}a(void 0)}))}}var Z="/mind-tracker",tt="/recommendations";function et(t,e,r,n,o){return rt.apply(this,arguments)}function rt(){return(rt=Q(X().mark((function t(e,r,n,o,i){var a,s,c;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=JSON.stringify({username:e,name:r,preferences:n,email:o,password:i}),t.next=3,fetch("".concat(I).concat("/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:a});case 3:return s=t.sent,t.next=6,s.json();case 6:return c=t.sent,t.abrupt("return",c);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function nt(t,e){return ot.apply(this,arguments)}function ot(){return(ot=Q(X().mark((function t(e,r){var n,o,i;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.stringify({usernameOrEmail:e,password:r}),t.next=3,fetch("".concat(I).concat("/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:n});case 3:return o=t.sent,t.next=6,o.json();case 6:return i=t.sent,t.abrupt("return",i);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function it(){return at.apply(this,arguments)}function at(){return(at=Q(X().mark((function t(){var e,r,n,o,i;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=localStorage.getItem("accessToken")){t.next=3;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 3:return r=new Date,n=r.toISOString().split("T")[0],t.next=7,fetch("".concat(I).concat("/mind-tracker/check","/").concat(n),{headers:{Authorization:"Bearer ".concat(e)}});case 7:return o=t.sent,t.next=10,o.json();case 10:if(i=t.sent,!o.error){t.next=13;break}throw new Error(i.message||"Terjadi kesalahan saat mengecek data");case 13:return t.abrupt("return",i);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function st(t){return ct.apply(this,arguments)}function ct(){return(ct=Q(X().mark((function t(e){var r,n,o,i;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=localStorage.getItem("accessToken")){t.next=3;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 3:return n=new Date(e),o=n.toISOString().split("T")[0],t.next=7,fetch("".concat(I).concat(Z,"/").concat(o),{headers:{Authorization:"Bearer ".concat(r)}});case 7:return i=t.sent,t.next=10,i.json();case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ut(t){return lt.apply(this,arguments)}function lt(){return(lt=Q(X().mark((function t(e){var r,n,o;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=localStorage.getItem("accessToken")){t.next=3;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 3:return t.next=5,fetch("".concat(I).concat(Z),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(e)});case 5:return n=t.sent,t.next=8,n.json();case 8:if(o=t.sent,!n.error){t.next=11;break}throw new Error(o.message||"Terjadi kesalahan saat menyimpan data");case 11:return t.abrupt("return",o);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function dt(){return ht.apply(this,arguments)}function ht(){return ht=Q(X().mark((function t(){var e,r,n,o,i,a=arguments;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=a.length>0&&void 0!==a[0]?a[0]:0,t.prev=1,r=T()){t.next=5;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 5:return n="".concat(I).concat("/mind-tracker/weekly"),0!==e&&(n+="?offset=".concat(e)),t.next=9,fetch(n,{headers:{Authorization:"Bearer ".concat(r)}});case 9:return o=t.sent,t.next=12,o.json();case 12:if(i=t.sent,o.ok){t.next=15;break}throw new Error(i.message||"Terjadi kesalahan saat mengambil data tracker mingguan");case 15:return t.abrupt("return",i);case 18:return t.prev=18,t.t0=t.catch(1),console.error("Error fetching weekly tracker entries:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal mengambil data tracker mingguan",data:{weeklyDetails:[]}});case 22:case"end":return t.stop()}}),t,null,[[1,18]])}))),ht.apply(this,arguments)}function ft(){return pt.apply(this,arguments)}function pt(){return(pt=Q(X().mark((function t(){var e,r;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=T(),t.prev=1,t.next=4,fetch("".concat(I,"/stories"),{headers:{Authorization:"Bearer ".concat(e)}});case 4:return r=t.sent,t.next=7,r.json();case 7:return t.abrupt("return",t.sent);case 10:return t.prev=10,t.t0=t.catch(1),console.error("Error fetching stories:",t.t0),t.abrupt("return",{error:!0,message:"Gagal menampilkan cerita"});case 14:case"end":return t.stop()}}),t,null,[[1,10]])})))).apply(this,arguments)}function mt(t){return vt.apply(this,arguments)}function vt(){return vt=Q(X().mark((function t(e){var r,n,o,i,a=arguments;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a.length>1&&void 0!==a[1]&&a[1],t.prev=1,n=T()){t.next=5;break}throw new Error("No authentication token found");case 5:return t.next=7,fetch("".concat(I,"/stories"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({content:e,isAnonymous:r})});case 7:return o=t.sent,t.next=10,o.json();case 10:if(i=t.sent,o.ok){t.next=13;break}throw new Error(i.message||"Gagal mengunggah cerita");case 13:return t.abrupt("return",i);case 16:throw t.prev=16,t.t0=t.catch(1),console.error("Error posting story:",t.t0),t.t0;case 20:case"end":return t.stop()}}),t,null,[[1,16]])}))),vt.apply(this,arguments)}function yt(t){return gt.apply(this,arguments)}function gt(){return(gt=Q(X().mark((function t(e){var r,n,o;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=T()){t.next=3;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 3:return t.next=5,fetch("".concat(I,"/profile/").concat(e),{headers:{Authorization:"Bearer ".concat(r)}});case 5:return n=t.sent,t.next=8,n.json();case 8:if(o=t.sent,!n.error){t.next=11;break}throw new Error(o.message||"Terjadi kesalahan saat mengambil profil");case 11:return t.abrupt("return",o);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var bt=function(){var t=Q(X().mark((function t(e){var r,n,o,i;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e&&"undefined"!==e){t.next=3;break}return t.abrupt("return",{error:!0,message:"Invalid story ID. Story ID is required."});case 3:return t.next=5,fetch("".concat(I,"/stories/").concat(e),{headers:{Authorization:"Bearer ".concat(T())}});case 5:if(r=t.sent,(n=r.headers.get("content-type"))&&n.includes("application/json")){t.next=12;break}return t.next=10,r.text();case 10:throw o=t.sent,new Error("Expected JSON but got: ".concat(o.substring(0,100),"..."));case 12:return t.next=14,r.json();case 14:if(i=t.sent,r.ok){t.next=17;break}return t.abrupt("return",{error:!0,message:i.message||"Failed to fetch story"});case 17:return t.abrupt("return",i);case 20:return t.prev=20,t.t0=t.catch(0),console.error("Error fetching story detail:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Network error while fetching story"});case 24:case"end":return t.stop()}}),t,null,[[0,20]])})));return function(e){return t.apply(this,arguments)}}();function wt(t){return xt.apply(this,arguments)}function xt(){return(xt=Q(X().mark((function t(e){var r,n,o;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}throw new Error("Invalid story ID");case 3:if(r=T()){t.next=6;break}throw new Error("Authentication required");case 6:return t.next=8,fetch("".concat(I,"/stories/").concat(e,"/likes"),{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});case 8:return n=t.sent,t.next=11,n.json();case 11:if(o=t.sent,n.ok){t.next=14;break}throw new Error(o.message||"Failed to like story");case 14:return t.abrupt("return",o);case 17:throw t.prev=17,t.t0=t.catch(0),console.error("Failed to like story:",t.t0),t.t0;case 21:case"end":return t.stop()}}),t,null,[[0,17]])})))).apply(this,arguments)}function kt(t,e){return Et.apply(this,arguments)}function Et(){return(Et=Q(X().mark((function t(e,r){var n;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(I,"/stories/").concat(e,"/comments"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(T())},body:JSON.stringify({content:r})});case 2:return n=t.sent,t.next=5,n.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function St(t){return jt.apply(this,arguments)}function jt(){return(jt=Q(X().mark((function t(e){var r,n,o;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(r=localStorage.getItem("accessToken"))&&"string"==typeof r&&r.includes(".")){t.next=4;break}throw new Error("Invalid token structure");case 4:return t.next=6,fetch("".concat(I,"/profile"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(e)});case 6:return n=t.sent,t.next=9,n.json();case 9:if(o=t.sent,n.ok){t.next=12;break}return t.abrupt("return",{error:!0,message:o.message||"Failed to update profile"});case 12:return t.abrupt("return",o);case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",{error:!0,message:t.t0.message||"Network error occurred"});case 18:case"end":return t.stop()}}),t,null,[[0,15]])})))).apply(this,arguments)}function _t(){return Pt.apply(this,arguments)}function Pt(){return(Pt=Q(X().mark((function t(){var e,r,n;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=T()){t.next=4;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 4:return t.next=6,fetch("".concat(I).concat("/notifications"),{headers:{Authorization:"Bearer ".concat(e)}});case 6:return r=t.sent,t.next=9,r.json();case 9:if(n=t.sent,r.ok){t.next=12;break}throw new Error(n.message||"Terjadi kesalahan saat mengambil notifikasi");case 12:return t.abrupt("return",n);case 15:return t.prev=15,t.t0=t.catch(0),console.error("Error fetching notifications:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal mengambil notifikasi"});case 19:case"end":return t.stop()}}),t,null,[[0,15]])})))).apply(this,arguments)}function Ot(t){return It.apply(this,arguments)}function It(){return(It=Q(X().mark((function t(e){var r,n,o,i,a,s;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=T()){t.next=4;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 4:return n="".concat(I).concat("/notifications","/").concat(e,"/read"),t.next=7,fetch(n,{method:"PUT",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});case 7:if(o=t.sent,!(i=o.headers.get("content-type"))||!i.includes("application/json")){t.next=15;break}return t.next=12,o.json();case 12:a=t.sent,t.next=19;break;case 15:return t.next=17,o.text();case 17:throw s=t.sent,new Error("Server returned non-JSON response: ".concat(s));case 19:if(o.ok){t.next=29;break}if(403!==o.status){t.next=24;break}throw new Error("Anda tidak memiliki akses untuk menandai notifikasi ini");case 24:if(404!==o.status){t.next=28;break}throw new Error("Notifikasi tidak ditemukan");case 28:throw new Error(a.message||"Terjadi kesalahan saat menandai notifikasi");case 29:return t.abrupt("return",a);case 32:return t.prev=32,t.t0=t.catch(0),console.error("Error message:",t.t0.message),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal menandai notifikasi sebagai dibaca"});case 36:case"end":return t.stop()}}),t,null,[[0,32]])})))).apply(this,arguments)}function Tt(){return Lt.apply(this,arguments)}function Lt(){return(Lt=Q(X().mark((function t(){var e,r,n,o,i;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=T()){t.next=4;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 4:return t.next=6,fetch("".concat(I).concat("/notifications/read-all"),{method:"PUT",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});case 6:if(r=t.sent,!(n=r.headers.get("content-type"))||!n.includes("application/json")){t.next=14;break}return t.next=11,r.json();case 11:o=t.sent,t.next=18;break;case 14:return t.next=16,r.text();case 16:throw i=t.sent,new Error("Server returned non-JSON response: ".concat(i));case 18:if(r.ok){t.next=20;break}throw new Error(o.message||"Terjadi kesalahan saat menandai semua notifikasi");case 20:return t.abrupt("return",o);case 23:if(t.prev=23,t.t0=t.catch(0),console.error("Error marking all notifications as read:",t.t0),console.error("Error type:",t.t0.constructor.name),console.error("Error message:",t.t0.message),!(t.t0 instanceof TypeError&&t.t0.message.includes("Failed to fetch"))){t.next=30;break}return t.abrupt("return",{error:!0,message:"Tidak dapat terhubung ke server. Periksa koneksi internet Anda dan pastikan server berjalan."});case 30:return t.abrupt("return",{error:!0,message:t.t0.message||"Gagal menandai semua notifikasi sebagai dibaca"});case 31:case"end":return t.stop()}}),t,null,[[0,23]])})))).apply(this,arguments)}function Ct(t){return Bt.apply(this,arguments)}function Bt(){return(Bt=Q(X().mark((function t(e){var r,n,o;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=T()){t.next=4;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 4:return t.next=6,fetch("".concat(I).concat("/notifications/push/subscribe"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({subscription:e})});case 6:return n=t.sent,t.next=9,n.json();case 9:if(o=t.sent,n.ok){t.next=12;break}throw new Error(o.message||"Gagal menyimpan subscription push notification");case 12:return t.abrupt("return",o);case 15:return t.prev=15,t.t0=t.catch(0),console.error("Error subscribing push notification:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal berlangganan push notification"});case 19:case"end":return t.stop()}}),t,null,[[0,15]])})))).apply(this,arguments)}function Nt(){return At.apply(this,arguments)}function At(){return(At=Q(X().mark((function t(){var e,r,n;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=T()){t.next=4;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 4:return t.next=6,fetch("".concat(I).concat("/notifications/push/unsubscribe"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});case 6:return r=t.sent,t.next=9,r.json();case 9:if(n=t.sent,r.ok){t.next=12;break}throw new Error(n.message||"Gagal menghapus subscription push notification");case 12:return t.abrupt("return",n);case 15:return t.prev=15,t.t0=t.catch(0),console.error("Error unsubscribing push notification:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal berhenti berlangganan push notification"});case 19:case"end":return t.stop()}}),t,null,[[0,15]])})))).apply(this,arguments)}var Mt=function(){var t=Q(X().mark((function t(e,r){var n,o,i;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=T()){t.next=4;break}throw new Error("Authentication token not found");case 4:if(e){t.next=6;break}throw new Error("Story ID is required for editing");case 6:return t.next=8,fetch("".concat(I,"/stories/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({content:r})});case 8:return o=t.sent,t.next=11,o.json();case 11:if(i=t.sent,o.ok){t.next=15;break}throw console.error("Error editing story ".concat(e," - Status: ").concat(o.status),i),new Error(i.message||"Failed to edit story. Status: ".concat(o.status));case 15:return t.abrupt("return",i);case 18:throw t.prev=18,t.t0=t.catch(0),console.error("Error editing story (catch block) for ID ".concat(e,":"),t.t0),t.t0;case 22:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(e,r){return t.apply(this,arguments)}}(),Gt=function(){var t=Q(X().mark((function t(e){var r,n,o;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=T()){t.next=4;break}throw new Error("Authentication token not found");case 4:if(e){t.next=6;break}throw new Error("Story ID is required for deleting");case 6:return t.next=8,fetch("".concat(I,"/stories/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r)}});case 8:if((n=t.sent).ok){t.next=22;break}return o={message:"Failed to delete story. Status: ".concat(n.status)},t.prev=11,t.next=14,n.json();case 14:o=t.sent,t.next=20;break;case 17:t.prev=17,t.t0=t.catch(11),console.warn("Could not parse error response as JSON for deleteStory");case 20:throw console.error("Error deleting story ".concat(e," - Status: ").concat(n.status),o),new Error(o.message||"Failed to delete story. Status: ".concat(n.status));case 22:if(204!==n.status){t.next=24;break}return t.abrupt("return",{success:!0,message:"Story deleted successfully."});case 24:return t.next=26,n.json();case 26:return t.abrupt("return",t.sent);case 29:throw t.prev=29,t.t1=t.catch(0),console.error("Error deleting story (catch block) for ID ".concat(e,":"),t.t1),t.t1;case 33:case"end":return t.stop()}}),t,null,[[0,29],[11,17]])})));return function(e){return t.apply(this,arguments)}}();function Dt(t,e){return Ft.apply(this,arguments)}function Ft(){return(Ft=Q(X().mark((function t(e,r){var n;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(I,"/comments/").concat(e,"/replies"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(T())},body:JSON.stringify({content:r})});case 2:return n=t.sent,t.next=5,n.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ht(t){return qt.apply(this,arguments)}function qt(){return(qt=Q(X().mark((function t(e){var r;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(I,"/comments/").concat(e,"/likes"),{method:"POST",headers:{Authorization:"Bearer ".concat(T())}});case 2:return r=t.sent,t.next=5,r.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Rt(t){return zt.apply(this,arguments)}function zt(){return(zt=Q(X().mark((function t(e){var r;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(I,"/comments/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(T())}});case 2:return r=t.sent,t.next=5,r.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ut(t){return Wt.apply(this,arguments)}function Wt(){return(Wt=Q(X().mark((function t(e){var r;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(I,"/comments/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(T())}});case 2:if((r=t.sent).ok){t.next=5;break}throw new Error("Failed to fetch comment detail: ".concat(r.statusText));case 5:return t.next=7,r.json();case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Jt(t){return Yt.apply(this,arguments)}function Yt(){return(Yt=Q(X().mark((function t(e){var r,n,o;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}throw new Error("Username is required");case 3:if(r=T()){t.next=6;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 6:return t.next=8,fetch("".concat(I).concat(tt,"/").concat(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});case 8:return n=t.sent,t.next=11,n.json();case 11:if(o=t.sent,n.ok){t.next=14;break}throw new Error(o.message||"Error ".concat(n.status,": Terjadi kesalahan saat mengambil rekomendasi"));case 14:return t.abrupt("return",o);case 17:return t.prev=17,t.t0=t.catch(0),console.error("Error fetching recommendations:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal mengambil rekomendasi aktivitas",data:{recommendations:[]}});case 21:case"end":return t.stop()}}),t,null,[[0,17]])})))).apply(this,arguments)}function Kt(t){return Vt.apply(this,arguments)}function Vt(){return(Vt=Q(X().mark((function t(e){var r,n,o;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}throw new Error("Username is required");case 3:if(r=T()){t.next=6;break}throw new Error("Anda belum login. Silakan login terlebih dahulu.");case 6:return t.next=8,fetch("".concat(I).concat(tt,"/").concat(e,"/regenerate"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});case 8:return n=t.sent,t.next=11,n.json();case 11:if(o=t.sent,n.ok){t.next=14;break}throw new Error(o.message||"Error ".concat(n.status,": Terjadi kesalahan saat meregenerasi rekomendasi"));case 14:return t.abrupt("return",o);case 17:return t.prev=17,t.t0=t.catch(0),console.error("Error regenerating recommendations:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal meregenerasi rekomendasi aktivitas"});case 21:case"end":return t.stop()}}),t,null,[[0,17]])})))).apply(this,arguments)}function Xt(){return $t.apply(this,arguments)}function $t(){return($t=Q(X().mark((function t(){var e,r,n;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=T()){t.next=4;break}return t.abrupt("return",{error:!1,message:"User not logged in",data:{chats:[],total:0}});case 4:return t.next=6,fetch("".concat(I).concat("/chatbot/history"),{headers:{Authorization:"Bearer ".concat(e)}});case 6:return r=t.sent,t.next=9,r.json();case 9:if(n=t.sent,r.ok){t.next=13;break}return console.warn("API error ".concat(r.status,":"),n.message),t.abrupt("return",{error:!0,message:n.message||"Error ".concat(r.status,": Terjadi kesalahan saat mengambil riwayat chat"),data:{chats:[],total:0}});case 13:return t.abrupt("return",n);case 16:return t.prev=16,t.t0=t.catch(0),console.warn("Error fetching chat history:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message||"Gagal mengambil riwayat chat",data:{chats:[],total:0}});case 20:case"end":return t.stop()}}),t,null,[[0,16]])})))).apply(this,arguments)}function Qt(t){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(t)}function Zt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return te(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?te(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function te(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ee(){ee=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Qt(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Qt(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function re(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ne(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?re(Object(r),!0).forEach((function(e){oe(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function oe(t,e,r){return(e=ce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ie(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function ae(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ie(i,n,o,a,s,"next",t)}function s(t){ie(i,n,o,a,s,"throw",t)}a(void 0)}))}}function se(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ce(n.key),n)}}function ce(t){var e=function(t){if("object"!=Qt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Qt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Qt(e)?e:e+""}var ue=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._view=e,this._stories=[]},e=[{key:"loadStories",value:(p=ae(ee().mark((function t(){var e;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._view._showLoading(),t.next=4,ft();case 4:(e=t.sent).error?console.error("Error loading stories:",e.message):(this._stories=(e.data||[]).map((function(t){var e;return ne(ne({},t),{},{likeCount:t.likeCount,commentCount:(null===(e=t.comments)||void 0===e?void 0:e.length)||0})})),this._view.showStories(this._stories)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Failed to load stories:",t.t0);case 11:return t.prev=11,this._view._hideLoading(),t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[0,8,11,14]])}))),function(){return p.apply(this,arguments)})},{key:"postNewStory",value:(f=ae(ee().mark((function t(e,r){var n,o,i,a;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this._view._showLoading(),e&&"string"==typeof e&&""!==e.trim()){t.next=4;break}throw new Error("Content is required");case 4:return t.next=6,mt(e,r);case 6:if(!(n=t.sent).error){t.next=11;break}throw o=n.message||"Gagal mengunggah cerita. Respons server tidak valid.",console.error("Error posting story:",o,n),new Error(o);case 11:if((i=n.data)&&(i.id||i._id)){t.next=15;break}throw console.error("API response for new story is missing a story ID in data.",n),new Error("Cerita berhasil diunggah, namun ID cerita tidak diterima dari server.");case 15:return a={id:i._id||i.id,name:r?"Pengguna":i.name,username:r?null:i.username,content:i.content,isAnonymous:i.isAnonymous,likes:i.likes||[],comments:i.comments||[],createdAt:i.createdAt,views:i.views||0,likeCount:(i.likes||[]).length,commentCount:(i.comments||[]).length},this._stories.unshift(a),this._view.showStories(this._stories),this._view.clearForm(),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{action:"posted"}})),t.abrupt("return",!0);case 23:return t.prev=23,t.t0=t.catch(0),console.error("Failed to post story:",t.t0),t.t0.message.includes("Content is required")?alert("Content tidak boleh kosong"):t.t0.message.includes("Gagal mengunggah cerita")||t.t0.message.includes("ID cerita tidak diterima")?alert("Gagal mengunggah cerita: "+t.t0.message):alert("Terjadi kesalahan. Silakan coba lagi."),t.abrupt("return",!1);case 28:return t.prev=28,this._view._hideLoading(),t.finish(28);case 31:case"end":return t.stop()}}),t,this,[[0,23,28,31]])}))),function(t,e){return f.apply(this,arguments)})},{key:"getCurrentUser",value:function(){try{return JSON.parse(localStorage.getItem("user"))||{}}catch(t){return console.error("Error getting user data:",t),null}}},{key:"getCompleteUserData",value:(h=ae(ee().mark((function t(e){var r,n,o,i;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}return t.abrupt("return",null);case 3:return t.next=5,yt(e);case 5:if(!(i=t.sent).error){t.next=9;break}return console.error("Error getting user profile:",i.message),t.abrupt("return",null);case 9:return t.abrupt("return",{name:(null===(r=i.data)||void 0===r?void 0:r.name)||"Pengguna",username:(null===(n=i.data)||void 0===n?void 0:n.username)||null,profilePicture:(null===(o=i.data)||void 0===o?void 0:o.profilePicture)||"./images/image.png"});case 12:return t.prev=12,t.t0=t.catch(0),console.error("Error getting user data:",t.t0),t.abrupt("return",null);case 16:case"end":return t.stop()}}),t,null,[[0,12]])}))),function(t){return h.apply(this,arguments)})},{key:"loadStoryDetail",value:(d=ae(ee().mark((function t(e){var r,n,o,i,a,s,c,u,l,d,h,f;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(r=e)&&"undefined"!==r){t.next=11;break}if(n=window.location.hash,!(o=n.match(/#\/story\/([a-f0-9]+)/i))||!o[1]){t.next=9;break}r=o[1],t.next=11;break;case 9:return console.error("Invalid story ID provided to loadStoryDetail:",r),t.abrupt("return");case 11:return t.next=13,bt(r);case 13:if("string"!=typeof(i=t.sent)||!i.startsWith("<!DOCTYPE")){t.next=16;break}throw new Error("Server returned HTML instead of JSON");case 16:if(i&&!i.error){t.next=21;break}return a=(null==i?void 0:i.message)||"Failed to load story details",console.error("Error loading story detail:",a),this._view.showError("Gagal memuat detail story. Silakan coba lagi."),t.abrupt("return");case 21:if((s=i.data).isAnonymous||!s.username){t.next=30;break}return t.next=25,this.getCompleteUserData(s.username);case 25:c=t.sent,s.profilePicture=(null==c?void 0:c.profilePicture)||"./images/image.png",s.name=(null==c?void 0:c.name)||s.name,t.next=32;break;case 30:s.profilePicture="./images/image.png",s.name="Pengguna";case 32:if(!(s.comments&&s.comments.length>0)){t.next=65;break}u=Zt(s.comments),t.prev=34,u.s();case 36:if((l=u.n()).done){t.next=57;break}if((d=l.value).isCommentAnonymous=!0,d.authorActualUsername=null,!d.username){t.next=52;break}return h=d.username,d.authorActualUsername=h,t.next=45,this.getCompleteUserData(h);case 45:f=t.sent,d.profilePicture=(null==f?void 0:f.profilePicture)||"./images/image.png",d.displayName=(null==f?void 0:f.name)||h,d.handleName="@".concat(h),d.isCommentAnonymous=!1,t.next=55;break;case 52:d.profilePicture="./images/image.png",d.displayName="Pengguna",d.handleName="Anonim";case 55:t.next=36;break;case 57:t.next=62;break;case 59:t.prev=59,t.t0=t.catch(34),u.e(t.t0);case 62:return t.prev=62,u.f(),t.finish(62);case 65:this._view.showStoryDetail(s),t.next=72;break;case 68:t.prev=68,t.t1=t.catch(0),console.error("Failed to load story detail:",t.t1),this._view.showError("Terjadi kesalahan saat memuat detail story.");case 72:case"end":return t.stop()}}),t,this,[[0,68],[34,59,62,65]])}))),function(t){return d.apply(this,arguments)})},{key:"getStoryById",value:(l=ae(ee().mark((function t(e){var r;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,bt(e);case 3:if((r=t.sent).error){t.next=6;break}return t.abrupt("return",r.data);case 6:throw new Error(r.message||"Failed to get story");case 9:throw t.prev=9,t.t0=t.catch(0),console.error("Error getting story:",t.t0),t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,9]])}))),function(t){return l.apply(this,arguments)})},{key:"likeStory",value:(u=ae(ee().mark((function t(e){var r;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}throw new Error("Invalid story ID");case 3:return t.next=5,wt(e);case 5:if(!(r=t.sent).error){t.next=8;break}throw new Error(r.message||"Failed to like story");case 8:return t.abrupt("return",r);case 11:throw t.prev=11,t.t0=t.catch(0),console.error("Failed to like story:",t.t0),t.t0;case 15:case"end":return t.stop()}}),t,null,[[0,11]])}))),function(t){return u.apply(this,arguments)})},{key:"addComment",value:(c=ae(ee().mark((function t(e,r){var n,o,i,a;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r&&"string"==typeof r&&""!==r.trim()){t.next=3;break}throw new Error("Content is required");case 3:if((n=e)&&"undefined"!==n){t.next=12;break}if(o=window.location.hash,!(i=o.match(/#\/story\/([a-f0-9]+)/i))||!i[1]){t.next=11;break}n=i[1],t.next=12;break;case 11:throw new Error("Invalid story ID");case 12:return t.next=14,kt(n,r);case 14:if((a=t.sent).error){t.next=23;break}if("function"!=typeof this._view.showStoryDetail){t.next=19;break}return t.next=19,this.loadStoryDetail(n);case 19:return document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:n,action:"commented",newCommentId:a.commentId,currentCommentCount:a.commentCount,message:a.message}})),t.abrupt("return",!0);case 23:throw new Error(a.message||"Failed to post comment");case 24:t.next=30;break;case 26:throw t.prev=26,t.t0=t.catch(0),console.error("Failed to post comment in addComment:",t.t0),t.t0;case 30:case"end":return t.stop()}}),t,this,[[0,26]])}))),function(t,e){return c.apply(this,arguments)})},{key:"loadCommentDetail",value:(s=ae(ee().mark((function t(e){var r;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e&&"string"==typeof e&&""!==e.trim()){t.next=5;break}return console.error("StoryPresenter: Attempted to load comment detail with invalid ID:",e),this._view.showError("ID komentar tidak valid untuk dimuat."),t.abrupt("return");case 5:return t.next=7,Ut(e);case 7:!(r=t.sent).error&&r.data?this._view.showCommentDetail(r.data):(console.error("Error loading comment detail in presenter:",r.message),this._view.showError(r.message||"Gagal memuat detail komentar.")),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("Failed to load comment detail in presenter (exception):",t.t0),this._view.showError(t.t0.message||"Terjadi kesalahan saat memuat detail komentar.");case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t){return s.apply(this,arguments)})},{key:"addReplyToComment",value:(a=ae(ee().mark((function t(e,r){var n;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r&&"string"==typeof r&&""!==r.trim()){t.next=3;break}throw new Error("Konten balasan tidak boleh kosong");case 3:return t.next=5,Dt(e,r.trim());case 5:if(!(n=t.sent).error){t.next=8;break}throw new Error(n.message||"Gagal menambahkan balasan.");case 8:return document.dispatchEvent(new CustomEvent("commentDataChanged",{detail:{action:"replied",parentId:e,replyId:n.replyId}})),t.abrupt("return",n);case 12:throw t.prev=12,t.t0=t.catch(0),console.error("Failed to add reply:",t.t0),t.t0;case 16:case"end":return t.stop()}}),t,null,[[0,12]])}))),function(t,e){return a.apply(this,arguments)})},{key:"likeExistingComment",value:(i=ae(ee().mark((function t(e){var r,n,o;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ht(e);case 3:if(!(n=t.sent).error){t.next=6;break}throw new Error(n.message||"Gagal menyukai komentar.");case 6:return o=(null===(r=n.data)||void 0===r?void 0:r.comment)||{},document.dispatchEvent(new CustomEvent("commentDataChanged",{detail:{action:"commentLiked",entityId:e,userLiked:o.userLiked,newLikeCount:o.likeCount,message:n.message}})),t.abrupt("return",n);case 11:throw t.prev=11,t.t0=t.catch(0),console.error("Failed to like comment:",t.t0),t.t0;case 15:case"end":return t.stop()}}),t,null,[[0,11]])}))),function(t){return i.apply(this,arguments)})},{key:"deleteExistingComment",value:(o=ae(ee().mark((function t(e){var r,n,o,i,a,s,c;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Rt(e);case 3:if(!(r=t.sent).error){t.next=6;break}throw new Error(r.message||"Gagal menghapus komentar.");case 6:return n=window.location.hash,o=n.includes("/comment/"),i=o?n.split("/").pop():null,a=i===e,document.dispatchEvent(new CustomEvent("commentDataChanged",{detail:{action:"commentDeleted",entityId:e}})),a&&(c=null===(s=r.data)||void 0===s?void 0:s.storyId,window.location.hash=c?"/story/".concat(c):"/story"),t.abrupt("return",r);case 15:throw t.prev=15,t.t0=t.catch(0),console.error("Failed to delete comment:",t.t0),t.t0;case 19:case"end":return t.stop()}}),t,null,[[0,15]])}))),function(t){return o.apply(this,arguments)})},{key:"editStory",value:(n=ae(ee().mark((function t(e,r){var n,o;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r&&"string"==typeof r&&""!==r.trim()){t.next=3;break}throw new Error("Content is required");case 3:return t.next=5,Mt(e,r.trim());case 5:if(!(n=t.sent).error){t.next=8;break}throw new Error(n.message);case 8:return-1!==(o=this._stories.findIndex((function(t){return t.id===e||t._id===e})))&&(this._stories[o]=ne(ne({},this._stories[o]),{},{content:n.data.content,updatedAt:n.data.updatedAt})),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:e,action:"edited",updatedStory:n.data}})),t.abrupt("return",!0);case 14:throw t.prev=14,t.t0=t.catch(0),console.error("Failed to edit story:",t.t0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(t,e){return n.apply(this,arguments)})},{key:"deleteStory",value:(r=ae(ee().mark((function t(e){var r;return ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Gt(e);case 3:if(!(r=t.sent).error){t.next=6;break}throw new Error(r.message);case 6:return this._stories=this._stories.filter((function(t){return t.id!==e&&t._id!==e})),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:e,action:"deleted"}})),t.abrupt("return",!0);case 11:throw t.prev=11,t.t0=t.catch(0),console.error("Failed to delete story:",t.t0),t.t0;case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t){return r.apply(this,arguments)})}],e&&se(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s,c,u,l,d,h,f,p}();function le(t){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},le(t)}function de(){de=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==le(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(le(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function he(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function fe(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){he(i,n,o,a,s,"next",t)}function s(t){he(i,n,o,a,s,"throw",t)}a(void 0)}))}}var pe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"stories-container",r=document.getElementById(e);if(r){var n="_storyInteractionHandler_".concat(e);r[n]&&(r.removeEventListener("click",r[n]),delete r[n]);var o=function(){var e=fe(de().mark((function e(r){var n,o,i;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.target.closest(".story-container")){e.next=3;break}return e.abrupt("return");case 3:if(o=n.dataset.storyId){e.next=6;break}return e.abrupt("return");case 6:if(!(i=r.target.closest(".like-btn"))){e.next=13;break}return r.preventDefault(),r.stopPropagation(),e.next=12,me(t,o,i);case 12:return e.abrupt("return");case 13:if(!r.target.closest(".comment-btn")){e.next=18;break}return r.stopPropagation(),window.location.hash="#/story/".concat(o),e.abrupt("return");case 18:if(!r.target.closest(".view-btn")){e.next=23;break}return r.stopPropagation(),window.location.hash="#/story/".concat(o),e.abrupt("return");case 23:if(!(r.target.closest(".story-menu-btn")||r.target.closest(".story-menu")||r.target.closest(".three-dots-menu"))){e.next=25;break}return e.abrupt("return");case 25:if(!r.target.closest(".user-info")){e.next=27;break}return e.abrupt("return");case 27:r.target.closest(".like-btn")||r.target.closest(".comment-btn")||r.target.closest(".view-btn")||(window.location.hash="#/story/".concat(o));case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r[n]=o,r.addEventListener("click",o)}else console.error("Container with ID '".concat(e,"' not found"))},me=function(){var t=fe(de().mark((function t(e,r,n){var o,i,a,s,c,u,l;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n.querySelector("svg"),i=n.querySelector(".like-count"),o&&i){t.next=5;break}return console.error("Like button elements not found"),t.abrupt("return");case 5:if(!n.disabled){t.next=7;break}return t.abrupt("return");case 7:return a=n.classList.contains("liked"),s=parseInt(i.textContent)||0,n.disabled=!0,n.style.pointerEvents="none",t.prev=11,ve(n,o,i,!a,a?s-1:s+1),a||(o.classList.add("like-heart-beat"),setTimeout((function(){return o.classList.remove("like-heart-beat")}),600)),t.next=16,e.likeStory(r);case 16:null!=(u=t.sent)&&null!==(c=u.data)&&void 0!==c&&c.story&&(l=u.data.story,ve(n,o,i,l.userLiked||!1,l.likeCount||0)),t.next=25;break;case 20:t.prev=20,t.t0=t.catch(11),console.error("Failed to like/unlike story:",t.t0),ve(n,o,i,a,s),alert(t.t0.message||"Gagal melakukan like/unlike");case 25:return t.prev=25,setTimeout((function(){n.disabled=!1,n.style.pointerEvents=""}),500),t.finish(25);case 28:case"end":return t.stop()}}),t,null,[[11,20,25,28]])})));return function(e,r,n){return t.apply(this,arguments)}}(),ve=function(t,e,r,n,o){n?(t.classList.add("liked"),e.classList.add("fill-red-500","text-red-500"),e.classList.remove("fill-none","text-gray-500"),r.classList.add("text-red-500","font-semibold"),r.classList.remove("text-gray-600")):(t.classList.remove("liked"),e.classList.add("fill-none","text-gray-500"),e.classList.remove("fill-red-500","text-red-500"),r.classList.add("text-gray-600"),r.classList.remove("text-red-500","font-semibold")),r.textContent=Math.max(0,o)};function ye(t){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(t)}function ge(){ge=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==ye(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ye(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function be(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function we(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){be(i,n,o,a,s,"next",t)}function s(t){be(i,n,o,a,s,"throw",t)}a(void 0)}))}}var xe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"stories-container",r=document.getElementById(e);if(r){var n=null;r.addEventListener("click",(function(t){var e=t.target.closest(".story-menu-btn");if(e){t.stopPropagation();var r=e.nextElementSibling;document.querySelectorAll(".story-menu").forEach((function(t){t===r||t.classList.contains("hidden")||t.classList.add("hidden")})),r.classList.toggle("hidden"),n=r.classList.contains("hidden")?null:r}})),document.addEventListener("click",(function(t){n&&!n.classList.contains("hidden")&&(n.contains(t.target)||t.target.closest(".story-menu-btn")||(n.classList.add("hidden"),n=null))})),r.addEventListener("click",function(){var t=we(ge().mark((function t(e){var r,o,i,a,s,c;return ge().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=e.target.closest(".edit-story-btn"))){t.next=18;break}if(e.stopPropagation(),(o=r.closest(".story-menu"))&&o.classList.add("hidden"),n=null,i=r.dataset.storyId,a=r.closest(".story-container")){t.next=11;break}return console.error("Story container not found for edit button:",r),t.abrupt("return");case 11:if(s=a.querySelector(".story-content p")){t.next=16;break}return console.error("Content paragraph not found within story container for story ID:",i,a),alert("Tidak dapat menemukan konten cerita untuk diedit."),t.abrupt("return");case 16:c=s.textContent,document.dispatchEvent(new CustomEvent("showEditStoryModalRequest",{detail:{storyId:i,currentContent:c}}));case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),r.addEventListener("click",function(){var e=we(ge().mark((function e(o){var i,a,s,c,u;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=o.target.closest(".delete-story-btn"))){e.next=24;break}if(o.stopPropagation(),(a=i.closest(".story-menu"))&&a.classList.add("hidden"),n=null,s=i.dataset.storyId,c=i.closest(".story-container"),!confirm("Apakah Anda yakin ingin menghapus cerita ini?")){e.next=24;break}return e.prev=9,e.next=12,t.deleteStory(s);case 12:if(!(u=e.sent)||u.error){e.next=17;break}c?(c.style.transition="opacity 0.3s ease",c.style.opacity="0",setTimeout((function(){var t,e;c.remove(),0===r.querySelectorAll(".story-container").length&&(r.innerHTML='<p class="text-gray-500 text-center py-8">Belum ada cerita untuk ditampilkan.</p>'),t="Cerita berhasil dihapus",(e=document.createElement("div")).className="fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-green-500 text-white px-4 py-2 rounded shadow-lg z-50",e.textContent=t,document.body.appendChild(e),setTimeout((function(){e.style.opacity="0",e.style.transition="opacity 0.5s ease",setTimeout((function(){return e.remove()}),500)}),3e3)}),300)):window.location.reload(),e.next=18;break;case 17:throw new Error((null==u?void 0:u.message)||"Gagal menghapus cerita");case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(9),console.error("Error deleting story:",e.t0),alert(e.t0.message||"Gagal menghapus cerita");case 24:case"end":return e.stop()}}),e,null,[[9,20]])})));return function(t){return e.apply(this,arguments)}}())}};function ke(t){return ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ke(t)}function Ee(){Ee=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==ke(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ke(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function Se(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function je(t,e,r){var n=document.getElementById("editStoryModal");n&&n.remove();var o='\n    <div id="editStoryModal" class="fixed inset-0 items-center justify-center bg-black/40 z-50 hidden">\n      <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">\n        <div class="flex justify-between items-center mb-4">\n          <h3 class="text-lg font-semibold">Edit Cerita</h3>\n          <button id="closeEditStoryModalBtn" class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>\n        </div>\n        <hr class="my-4 border-gray-300">\n        <form id="editStoryForm" class="space-y-4">\n          <div>\n            <label for="storyContentInput" class="block text-sm font-medium text-gray-700 mb-1">Konten Cerita</label>\n            <textarea id="storyContentInput" name="content" rows="6"\n              class="w-full border border-gray-300 rounded-lg p-2 focus:ring-teal-500 focus:border-teal-500"\n              placeholder="Tuliskan ceritamu di sini...">'.concat({content:e}.content||"",'</textarea>\n          </div>\n          <div class="flex justify-end gap-3 pt-4">\n            <button type="button" id="cancelEditStoryBtn"\n              class="w-auto border border-gray-300 py-2 px-4 rounded-lg text-gray-700 hover:bg-gray-50">Batal</button>\n            <button type="submit"\n              class="w-auto bg-teal-500 text-white py-2 px-4 rounded-lg hover:bg-teal-600">Simpan Perubahan</button>\n          </div>\n        </form>\n      </div>\n    </div>\n  ');document.body.insertAdjacentHTML("beforeend",o);var i=document.getElementById("editStoryModal"),a=document.getElementById("closeEditStoryModalBtn"),s=document.getElementById("cancelEditStoryBtn"),c=document.getElementById("editStoryForm"),u=document.getElementById("storyContentInput"),l=c?c.querySelector('button[type="submit"]'):null;if(!(i&&a&&s&&c&&u&&l))return console.error("Error: One or more elements for the edit story modal were not found in the DOM. Template IDs might be incorrect."),void(i&&i.remove());i.classList.remove("hidden"),i.classList.add("flex");var d=function(){i.classList.add("hidden"),i.classList.remove("flex"),setTimeout((function(){i.remove()}),300)};a.addEventListener("click",d),s.addEventListener("click",d),i.addEventListener("click",(function(t){t.target===i&&d()})),c.addEventListener("submit",function(){var e,n=(e=Ee().mark((function e(n){var o,i;return Ee().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),o=u.value.trim()){e.next=5;break}return alert("Konten cerita tidak boleh kosong."),e.abrupt("return");case 5:return i=l.textContent,l.disabled=!0,l.textContent="Menyimpan...",e.prev=8,e.next=11,r.editStory(t,o);case 11:d(),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(8),console.error("Failed to edit story:",e.t0),alert(e.t0.message||"Gagal menyimpan perubahan cerita.");case 18:return e.prev=18,l.disabled=!1,l.textContent=i,e.finish(18);case 22:case"end":return e.stop()}}),e,null,[[8,14,18,22]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(t){Se(i,n,o,a,s,"next",t)}function s(t){Se(i,n,o,a,s,"throw",t)}a(void 0)}))});return function(t){return n.apply(this,arguments)}}())}function _e(t){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_e(t)}function Pe(){Pe=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==_e(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(_e(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function Oe(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Ie(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Oe(i,n,o,a,s,"next",t)}function s(t){Oe(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Te(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ne(n.key),n)}}function Le(t,e,r){Ce(t,e),e.set(t,r)}function Ce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Be(t,e,r){return(e=Ne(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ne(t){var e=function(t){if("object"!=_e(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=_e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_e(e)?e:e+""}function Ae(t,e){return t.get(Ge(t,e))}function Me(t,e,r){return t.set(Ge(t,e),r),r}function Ge(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var De=new WeakMap,Fe=new WeakMap,He=new WeakSet,qe=function(){return t=function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ce(this,e=He),e.add(this),Be(this,"_presenter",null),Be(this,"_currentUser",null),Le(this,De,null),Le(this,Fe,null),this._presenter=new ue(this)},e=[{key:"render",value:(i=Ie(Pe().mark((function t(){var e,r,n,o,i,a;return Pe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._currentUser=JSON.parse(localStorage.getItem("user"))||{},o=(null===(e=this._currentUser)||void 0===e?void 0:e.name)||"Nama Pengguna",i=null!==(r=this._currentUser)&&void 0!==r&&r.username?"@".concat(this._currentUser.username):"@namapengguna",a=(null===(n=this._currentUser)||void 0===n?void 0:n.profilePicture)||"./images/image.png",t.abrupt("return",'\n        <div class="md:ml-16 lg:ml-16 min-h-screen p-6 lg:p-10 pb-20 lg:pb-10">\n          <div class="mb-1">\n            <h1 class="text-2xl font-semibold text-gray-900 mb-2">Story MindBlown</h1>\n            <p class="text-gray-600">Berbagi cerita, temukan makna.</p>\n            <hr class="mt-4 text-gray-300">\n          </div>\n\n          <div class="lg:grid lg:grid-cols-2 gap-4 lg:h-screen">\n            <div class="overflow-y-auto lg:p-6 lg:mr-10 border-gray-200">\n            <div id="stories-loader" class="py-10 flex flex-col items-center justify-center">\n              <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-teal-500 mb-3"></div>\n                <p class="text-gray-500">Memuat cerita...</p>\n              </div>\n\n              <div id="stories-container" class="space-y-6">\n              </div>\n            </div>\n\n            <div class="hidden lg:block lg:p-6">\n              <div class="space-y-6 mt-4">\n                '.concat(g({username:o,handle:i,profilePicture:a}),'\n              </div>\n            </div>\n          </div>\n\n          <button id="add-story-fab" class="fixed bottom-24 right-6 w-14 h-14 rounded-full bg-teal-500 text-white shadow-lg flex items-center justify-center z-30 lg:hidden focus:outline-none">\n          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">\n            <line x1="12" y1="5" x2="12" y2="19"></line>\n            <line x1="5" y1="12" x2="19" y2="12"></line>\n          </svg>\n        </button>\n\n         <div id="mobile-story-modal" class="fixed inset-0 bg-white items-start justify-start z-50 hidden">\n            <div class="w-full h-full">\n              <div class="p-4 border-b border-gray-100 flex items-center justify-between">\n                <button id="close-story-modal" class="text-gray-700">\n                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                    <line x1="18" y1="6" x2="6" y2="18"></line>\n                    <line x1="6" y1="6" x2="18" y2="18"></line>\n                  </svg>\n                </button>\n                <button id="mobile-story-submit" class="bg-teal-500 text-white px-4 py-1 rounded-full text-sm">Posting</button>\n              </div>\n              \n              <div class="p-4">\n                <div class="flex items-center gap-3 mb-4">\n                  <img src="').concat(a,'" alt="Profile" class="w-8 h-8 rounded-full object-cover">\n                  <div class="dropdown relative">\n                    <button class="dropdown-toggle flex items-center gap-2 border border-gray-300 rounded-full px-3 py-1 text-sm">\n                      <span id="privacy-display">Pilih sebagai</span>\n                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                        <polyline points="6 9 12 15 18 9"></polyline>\n                      </svg>\n                        </button>\n                    <div class="dropdown-menu hidden absolute z-10 mt-1 bg-white shadow-lg rounded-md w-full">\n                      <div class="py-1">\n                        <button class="privacy-option block w-full text-left px-4 py-2 text-sm hover:bg-gray-100" data-anonymous="false">Publik</button>\n                        <button class="privacy-option block w-full text-left px-4 py-2 text-sm hover:bg-gray-100" data-anonymous="true">Anonim</button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                \n                <textarea id="mobile-story-textarea" class="w-full border-0 focus:ring-0 text-gray-700 resize-none h-64 placeholder-gray-400" placeholder="Ada cerita apa?"></textarea>\n                \n                <input type="checkbox" id="mobile-post-anonymously" class="hidden" value="false">\n              </div>\n            </div>\n          </div>        \n\n        </div>\n      '));case 8:return t.prev=8,t.t0=t.catch(0),console.error("Error rendering StoryPage:",t.t0),t.abrupt("return",'\n        <div class="ml-16 min-h-screen p-10 flex justify-center items-center">\n          <p class="text-red-500">Gagal memuat halaman cerita. Silakan coba lagi nanti.</p>\n        </div>\n      ');case 12:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(o=Ie(Pe().mark((function t(){return Pe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._presenter.loadStories();case 3:this._setupFormSubmit(),this._setupMobileFormModal(),Ge(He,this,Re).call(this),Ge(He,this,ze).call(this),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error("Error in afterRender (StoryPage):",t.t0),this.showError(t.t0.message||"Gagal memuat konten halaman cerita.");case 13:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return o.apply(this,arguments)})},{key:"_showLoading",value:function(){this._isLoading=!0;var t=document.getElementById("stories-loader"),e=document.getElementById("stories-container");t&&t.classList.remove("hidden"),e&&e.classList.add("hidden")}},{key:"_hideLoading",value:function(){this._isLoading=!1;var t=document.getElementById("stories-loader"),e=document.getElementById("stories-container");t&&t.classList.add("hidden"),e&&e.classList.remove("hidden")}},{key:"_setupMobileFormModal",value:function(){var t=this,e=document.getElementById("add-story-fab"),r=document.getElementById("mobile-story-modal"),n=document.getElementById("close-story-modal"),o=document.getElementById("mobile-story-submit"),i=document.querySelector(".dropdown-toggle"),a=document.querySelector(".dropdown-menu"),s=document.querySelectorAll(".privacy-option"),c=document.getElementById("privacy-display"),u=document.getElementById("mobile-post-anonymously");e&&r&&e.addEventListener("click",(function(){r.classList.remove("hidden"),r.classList.add("flex")})),n&&r&&n.addEventListener("click",(function(){r.classList.add("hidden"),r.classList.remove("flex"),document.getElementById("mobile-story-textarea").value=""})),i&&a&&(i.addEventListener("click",(function(){a.classList.toggle("hidden")})),document.addEventListener("click",(function(t){i.contains(t.target)||a.contains(t.target)||a.classList.add("hidden")}))),s.forEach((function(t){t.addEventListener("click",(function(){var e="true"===t.getAttribute("data-anonymous");u.checked=e,c.textContent=e?"Anonim":"Publik",a.classList.add("hidden")}))})),o&&o.addEventListener("click",Ie(Pe().mark((function e(){var n,i,a;return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=document.getElementById("mobile-story-textarea").value.trim(),i=u.checked,n){e.next=5;break}return alert("Silakan masukkan konten cerita."),e.abrupt("return");case 5:if(a=o.textContent,o.disabled=!0,o.textContent="Mengirim...",e.prev=8,!t._presenter){e.next=14;break}return e.next=12,t._presenter.postNewStory(n,i);case 12:e.sent&&(document.getElementById("mobile-story-textarea").value="",r.classList.add("hidden"),r.classList.remove("flex"));case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(8),console.error("Error submitting story:",e.t0),alert(e.t0.message||"Gagal mengunggah cerita.");case 20:return e.prev=20,o.disabled=!1,o.textContent=a,e.finish(20);case 24:case"end":return e.stop()}}),e,null,[[8,16,20,24]])}))))}},{key:"showStories",value:(n=Ie(Pe().mark((function t(e){var r,n,o,i=this;return Pe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=document.getElementById("stories-container")){t.next=4;break}return console.log("StoryPage: stories-container not found, possibly not on story page"),t.abrupt("return");case 4:if(e&&0!==e.length){t.next=8;break}return n.innerHTML='<p class="text-gray-500 text-center py-8">Belum ada cerita untuk ditampilkan.</p>',this._hideLoading(),t.abrupt("return");case 8:return this._currentUser=null!==(r=this._currentUser)&&void 0!==r&&r.username?this._currentUser:JSON.parse(localStorage.getItem("user"))||{},t.prev=9,t.next=12,Promise.all(e.map(function(){var t=Ie(Pe().mark((function t(e,r){var n,o,a,s,c,u,l,d,h;return Pe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.id||e._id||e.storyId||"story-".concat(r),s=!e.isAnonymous&&e.username===(null===(n=i._currentUser)||void 0===n?void 0:n.username),c="./images/image.png",u="Pengguna",l="Anonim",e.isAnonymous||!e.username){t.next=21;break}if(t.prev=6,null===(d=i._presenter)||void 0===d||!d.getCompleteUserData){t.next=13;break}return t.next=10,i._presenter.getCompleteUserData(e.username);case 10:t.t0=t.sent,t.next=14;break;case 13:t.t0=null;case 14:(h=t.t0)?(c=h.profilePicture||c,u=h.name||e.name||u,l="@".concat(h.username||e.username)):(c=e.profilePicture||c,u=e.name||u,l="@".concat(e.username)),t.next=21;break;case 18:t.prev=18,t.t1=t.catch(6),console.error("Error fetching profile for ".concat(e.username,":"),t.t1);case 21:return t.abrupt("return",y({username:u,handle:l,content:e.content,isAnonymous:e.isAnonymous,storyId:a,likeCount:e.likeCount||(null===(o=e.likes)||void 0===o?void 0:o.length)||0,commentCount:e.totalCommentCount,viewCount:e.viewCount||e.views||0,profilePicture:c,createdAt:e.createdAt,isOwner:s,userLiked:e.userLiked||!1}));case 22:case"end":return t.stop()}}),t,null,[[6,18]])})));return function(e,r){return t.apply(this,arguments)}}()));case 12:o=t.sent,n.innerHTML=o.join(""),this._presenter&&(pe(this._presenter,"stories-container"),xe(this._presenter,"stories-container")),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(9),console.error("Error rendering stories:",t.t0),n.innerHTML="<div>Error loading stories</div>";case 21:case"end":return t.stop()}}),t,this,[[9,17]])}))),function(t){return n.apply(this,arguments)})},{key:"_setupFormSubmit",value:function(){var t=this,e=document.getElementById("chat-form");e&&e.addEventListener("submit",function(){var r=Ie(Pe().mark((function r(n){var o,i,a,s,c;return Pe().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.preventDefault(),o=document.getElementById("chat-input"),i=document.getElementById("post-anonymously"),a=!!i&&i.checked,s=e.querySelector('button[type="submit"]'),c=s.textContent,o&&o.value.trim()){r.next=9;break}return alert("Silakan masukkan konten cerita."),r.abrupt("return");case 9:if(s.disabled=!0,s.textContent="Mengunggah...",r.prev=11,!t._presenter){r.next=16;break}return r.next=15,t._presenter.postNewStory(o.value.trim(),a);case 15:r.sent;case 16:r.next=22;break;case 18:r.prev=18,r.t0=r.catch(11),console.error("Error submitting story:",r.t0),alert(r.t0.message||"Gagal mengunggah cerita.");case 22:return r.prev=22,s.disabled=!1,s.textContent=c,r.finish(22);case 26:case"end":return r.stop()}}),r,null,[[11,18,22,26]])})));return function(t){return r.apply(this,arguments)}}())}},{key:"_getProfilePicture",value:(r=Ie(Pe().mark((function t(e){var r;return Pe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return","./images/image.png");case 2:return t.prev=2,t.next=5,getUserProfile(e);case 5:return r=t.sent,t.abrupt("return",r.profilePicture||"./images/image.png");case 9:return t.prev=9,t.t0=t.catch(2),console.error("Error getting profile picture:",t.t0),t.abrupt("return","./images/image.png");case 13:case"end":return t.stop()}}),t,null,[[2,9]])}))),function(t){return r.apply(this,arguments)})},{key:"clearForm",value:function(){try{var t=document.getElementById("chat-input");t&&(t.value="");var e=document.getElementById("post-anonymously");e&&(e.checked=!1)}catch(t){console.error("Error clearing form:",t)}}},{key:"showError",value:function(t){var e=document.getElementById("stories-container");if(e)e.innerHTML='<p class="text-red-500 p-4 text-center">'.concat(t,"</p>");else{var r=document.querySelector(".ml-16.min-h-screen.p-10");r?r.innerHTML='<p class="text-red-500 p-6 text-center">'.concat(t,"</p>"):console.log(t)}}}],e&&Te(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}();function Re(){var t=this;Me(De,this,(function(e){var r=e.detail,n=r.storyId,o=r.currentContent;t._presenter&&"function"==typeof t._presenter.editStory?je(n,o,t._presenter):(console.error("StoryPage: Presenter or presenter.editStory method is not available."),alert("Tidak dapat mengedit cerita saat ini."))})),document.addEventListener("showEditStoryModalRequest",Ae(De,this))}function ze(){var t=this;Me(Fe,this,function(){var e=Ie(Pe().mark((function e(r){var n,o;return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.getElementById("stories-container")){e.next=4;break}return console.log("StoryPage: Not on story page, ignoring storyDataChanged"),e.abrupt("return");case 4:if(n=r.detail,o=n.action,n.storyId,!["posted","edited","deleted","liked","commented"].includes(o)){e.next=10;break}if(console.log("StoryPage: Reloading stories due to storyDataChanged"),!t._presenter){e.next=10;break}return e.next=10,t._presenter.loadStories();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),document.addEventListener("storyDataChanged",Ae(Fe,this))}function Ue(t,e){var r=t.getFullYear(),n=t.getMonth();document.getElementById("monthDisplay").textContent="".concat(e[n]," ").concat(r);for(var o=new Date(r,n,1),i=new Date(r,n+1,0),a=o.getDay(),s=i.getDate(),c=new Date(r,n,0).getDate(),u=document.getElementById("calendarDays"),l="",d=a;d>0;d--)l+='\n            <div class="flex items-center justify-center border-t border-r border-gray-100 p-2 h-20 md:h-25 lg:h-30">\n                <span class="text-sm text-gray-400">'.concat(c-d+1,"</span>\n            </div>");for(var h=1;h<=s;h++){var f=h===(new Date).getDate()&&n===(new Date).getMonth()&&r===(new Date).getFullYear(),p=f?"bg-blue-50 text-blue-600 font-semibold":"hover:bg-gray-50",m=(n+1).toString().padStart(2,"0"),v=h.toString().padStart(2,"0");l+='\n            <div class="flex items-center justify-center border-t border-r border-gray-100 p-2 h-20 md:h-25 lg:h-30 '.concat(p,'" data-date="').concat(r,"-").concat(m,"-").concat(v,'">\n                <span class="text-sm ').concat(f?"text-blue-600":"text-gray-700",'">').concat(h,"</span>\n            </div>")}for(var y=35-(a+s),g=1;g<=y;g++)l+='\n            <div class="flex items-center justify-center border-t border-r border-gray-100 p-2 h-20 md:h-25 lg:h-30">\n                <span class="text-sm text-gray-400">'.concat(g,"</span>\n            </div>");u.innerHTML=l}function We(t){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},We(t)}function Je(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ye(){Ye=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==We(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(We(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function Ke(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Ve(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ke(i,n,o,a,s,"next",t)}function s(t){Ke(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Xe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$e(n.key),n)}}function $e(t){var e=function(t){if("object"!=We(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=We(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==We(e)?e:e+""}var Qe=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentDate=new Date,this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],this.userRecommendations=[],this.weeklyEntries=[],this.currentWeekOffset=0},e=[{key:"checkTodayEntry",value:(u=Ve(Ye().mark((function t(){var e;return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,it();case 3:return e=t.sent,console.log(e),t.abrupt("return",{exists:e.exists,formattedDate:this.formatDate(this.currentDate)});case 8:throw t.prev=8,t.t0=t.catch(0),console.error("Presenter: Error checking today entry:",t.t0),t.t0;case 12:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return u.apply(this,arguments)})},{key:"getEntryByDate",value:(c=Ve(Ye().mark((function t(e){var r;return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,st(e);case 3:return r=t.sent,t.abrupt("return",{data:r.data,formattedDate:this.formatDate(new Date(e))});case 7:throw t.prev=7,t.t0=t.catch(0),console.error("Presenter: Error getting entry by date:",t.t0),t.t0;case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return c.apply(this,arguments)})},{key:"saveEntry",value:(s=Ve(Ye().mark((function t(e){var r;return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ut(e);case 3:return r=t.sent,t.abrupt("return",r);case 7:throw t.prev=7,t.t0=t.catch(0),console.error("Presenter: Error saving entry:",t.t0),t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(t){return s.apply(this,arguments)})},{key:"loadRecommendations",value:(a=Ve(Ye().mark((function t(){var e,r;return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(e=JSON.parse(localStorage.getItem("user"))||{}).username){t.next=4;break}throw new Error("User data not found");case 4:return t.next=6,Jt(e.username);case 6:if(!(r=t.sent).error){t.next=9;break}throw new Error(r.message);case 9:return this.userRecommendations=r.data.recommendations||[],t.abrupt("return",this.userRecommendations);case 13:return t.prev=13,t.t0=t.catch(0),console.error("Presenter: Error loading recommendations:",t.t0),t.abrupt("return",[]);case 17:case"end":return t.stop()}}),t,this,[[0,13]])}))),function(){return a.apply(this,arguments)})},{key:"regenerateRecommendations",value:(i=Ve(Ye().mark((function t(){var e,r;return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(e=JSON.parse(localStorage.getItem("user"))||{}).username){t.next=4;break}throw new Error("User data not found");case 4:return t.next=6,Kt(e.username);case 6:if(!(r=t.sent).error){t.next=9;break}throw new Error(r.message||"Failed to regenerate recommendations");case 9:return t.next=11,this.loadRecommendations();case 11:return t.abrupt("return",t.sent);case 14:throw t.prev=14,t.t0=t.catch(0),console.error("Presenter: Error regenerating recommendations:",t.t0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(){return i.apply(this,arguments)})},{key:"loadWeeklyEntries",value:(o=Ve(Ye().mark((function t(){var e;return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt(this.currentWeekOffset);case 3:if(e=t.sent,console.log("Presenter: Loaded weekly entries:",e),!e.error){t.next=7;break}throw new Error(e.message);case 7:return this.weeklyEntries=e.data.weeklyDetails||[],t.abrupt("return",{weekRange:e.data.weekRange,entries:this.weeklyEntries});case 11:return t.prev=11,t.t0=t.catch(0),console.error("Presenter: Error loading weekly entries:",t.t0),t.abrupt("return",{weekRange:{start:"",end:""},entries:[]});case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return o.apply(this,arguments)})},{key:"loadPreviousWeekEntries",value:(n=Ve(Ye().mark((function t(){return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.currentWeekOffset-=1,t.abrupt("return",this.loadWeeklyEntries());case 2:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"loadNextWeekEntries",value:(r=Ve(Ye().mark((function t(){return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.currentWeekOffset<0)){t.next=4;break}this.currentWeekOffset+=1,t.next=6;break;case 4:if(0!==this.currentWeekOffset){t.next=6;break}return t.abrupt("return",this.loadWeeklyEntries());case 6:return t.abrupt("return",this.loadWeeklyEntries());case 7:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"getWeeklyEntries",value:function(){return this.weeklyEntries}},{key:"getMoodEmoji",value:function(t){return{joy:"üòÑ",neutral:"üòê",sadness:"üòî",anger:"üò†"}[t]||"‚ùì"}},{key:"getRecommendations",value:function(){return this.userRecommendations||[]}},{key:"getCurrentDate",value:function(){return this.currentDate}},{key:"setCurrentDate",value:function(t){this.currentDate=t}},{key:"getMonthNames",value:function(){return this.monthNames}},{key:"formatDate",value:function(t){return t.toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})}},{key:"parseDateString",value:function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Je(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Je(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.match(/(\d+)\s+(\w+)\s+(\d+)/),4),r=(e[0],e[1]),n=e[2],o=e[3];return new Date(o,{Januari:0,Februari:1,Maret:2,April:3,Mei:4,Juni:5,Juli:6,Agustus:7,September:8,Oktober:9,November:10,Desember:11}[n],r)}}],e&&Xe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s,c,u}();function Ze(t){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ze(t)}function tr(){tr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Ze(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ze(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function er(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function rr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){er(i,n,o,a,s,"next",t)}function s(t){er(i,n,o,a,s,"throw",t)}a(void 0)}))}}function nr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,or(n.key),n)}}function or(t){var e=function(t){if("object"!=Ze(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ze(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ze(e)?e:e+""}var ir=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.presenter=new Qe},e=[{key:"render",value:(i=rr(tr().mark((function t(){return tr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n        <div class="md:ml-16 lg:ml-16 min-h-screen p-6 lg:p-10 pb-20 lg:pb-10">\n        <div class="max-w-md md:max-w-[90%] ml-0 md:ml-16 lg:ml-16 mx-auto">\n            <div class="mb-4">\n                <h1 class="text-2xl font-semibold text-gray-900 mb-2">Mind Tracker</h1>\n                <p class="text-gray-600 text-sm lg:text-md">Hari ini rasanya gimana? Ini tracker ini buat bantu kamu lebih sadar sama perasaan dan progressmu.</p>\n                <hr class="mt-4 text-gray-300">\n            </div>\n\n            <div class="mb-6">\n                <button id="trackTodayBtn" class="bg-third hover:bg-teal-700 text-white px-3 lg:px-4 py-2 rounded-md flex items-center">\n                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>\n                    </svg>\n                    Yuk Track Your Mind !\n                </button>\n            </div>\n\n           <div id="recommendations-container">\n            '.concat(k([]),'\n        </div>\n\n           <div class="mt-8 mb-6">\n                <h2 class="font-semibold text-base mb-4">Mood Tracker Minggu Ini</h2>\n                <div class="weekly-tracker-container">\n                    \x3c!-- Loading indicator --\x3e\n                    <div class="bg-white rounded-xl border border-gray-200 p-4 flex justify-center items-center h-32">\n                        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-third"></div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="flex items-center justify-between py-2">\n                <h2 id="monthDisplay" class="text-xl font-semibold text-gray-800">\n                    May 2025\n                </h2>\n\n                <div class="flex items-center space-x-2">\n                    <button id="todayBtn"\n                    class="bg-gray-200 text-gray-400 text-sm px-4 py-2 rounded-md">\n                    Today\n                    </button>\n\n                    <div class="flex rounded-md overflow-hidden border border-gray-200">\n                    <button id="prevMonth" class="px-3 py-2 bg-gray-100 hover:bg-gray-200">\n                        <svg class="w-4 h-4 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />\n                        </svg>\n                    </button>\n                    <button id="nextMonth" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 border-l border-gray-300">\n                        <svg class="w-4 h-4 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />\n                        </svg>\n                    </button>\n                    </div>\n                </div>\n                </div>\n\n\n            <div class="bg-white shadow-sm">\n                <div class="grid grid-cols-7 gap-0 border-t border-r border-gray-100">\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">Min</div>\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">Sen</div>\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">Sel</div>\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">Rab</div>\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">Kam</div>\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">Jum</div>\n                    <div class="text-xs text-gray-500 text-center py-2 border-t border-r border-gray-100">Sab</div>\n\n                    <div id="calendarDays" class="col-span-7 grid grid-cols-7"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n      '));case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(o=rr(tr().mark((function t(){var e,r=this;return tr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Ue(this.presenter.getCurrentDate(),this.presenter.getMonthNames()),t.prev=1,t.next=4,this.presenter.loadRecommendations();case 4:return e=t.sent,this.updateRecommendationsSection(e),this.setupRegenerateButton(),t.next=9,this.loadAndRenderWeeklyEntries();case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.error("Failed to load recommendations:",t.t0);case 14:document.getElementById("prevMonth").addEventListener("click",(function(){var t=r.presenter.getCurrentDate();t.setMonth(t.getMonth()-1),r.presenter.setCurrentDate(t),Ue(t,r.presenter.getMonthNames()),r.updateTodayButtonState()})),document.getElementById("nextMonth").addEventListener("click",(function(){var t=r.presenter.getCurrentDate();t.setMonth(t.getMonth()+1),r.presenter.setCurrentDate(t),Ue(t,r.presenter.getMonthNames()),r.updateTodayButtonState()})),document.getElementById("todayBtn").addEventListener("click",(function(){r.presenter.setCurrentDate(new Date),Ue(r.presenter.getCurrentDate(),r.presenter.getMonthNames()),r.updateTodayButtonState()})),document.getElementById("trackTodayBtn").addEventListener("click",rr(tr().mark((function t(){var e;return tr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.presenter.checkTodayEntry();case 3:if(!(e=t.sent).exists){t.next=7;break}return E("Anda sudah mengisi Mind Tracker untuk hari ini.","error"),t.abrupt("return");case 7:r.showModal(e.formattedDate,null,!1),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),console.error("Error checking mind tracker entry:",t.t0),E(t.t0.message||"Terjadi kesalahan server","error");case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))),document.getElementById("calendarDays").addEventListener("click",function(){var t=rr(tr().mark((function t(e){var n;return tr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=e.target.closest("div[data-date]"))&&r.handleDayClick(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 19:case"end":return t.stop()}}),t,this,[[1,11]])}))),function(){return o.apply(this,arguments)})},{key:"loadAndRenderWeeklyEntries",value:(n=rr(tr().mark((function t(){var e,r,n,o,i,a=this;return tr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.presenter.loadWeeklyEntries();case 3:e=t.sent,(r=document.querySelector(".weekly-tracker-container"))&&(r.innerHTML=p(e),r.querySelectorAll("[data-date][data-mood]").forEach((function(t){t.classList.contains("cursor-pointer")&&t.addEventListener("click",(function(){var e=t.dataset.date,r=t.dataset.mood,n=t.dataset.progress;a.showModal(e.split("T")[0],{mood:r,progress:n},!0)}))})),this.setupMobileCarousel(),n=r.querySelector("#moodPrevBtn"),o=r.querySelector("#moodNextBtn"),n&&n.addEventListener("click",function(){var t=rr(tr().mark((function t(e){return tr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(document.querySelector(".mood-mobile-carousel")&&window.innerWidth<1024)){t.next=6;break}e.preventDefault(),a.mobileCarouselPrev(),t.next=9;break;case 6:return t.next=8,a.presenter.loadPreviousWeekEntries();case 8:a.loadAndRenderWeeklyEntries();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),o&&o.addEventListener("click",function(){var t=rr(tr().mark((function t(e){return tr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(document.querySelector(".mood-mobile-carousel")&&window.innerWidth<1024)){t.next=6;break}e.preventDefault(),a.mobileCarouselNext(),t.next=9;break;case 6:return t.next=8,a.presenter.loadNextWeekEntries();case 8:a.loadAndRenderWeeklyEntries();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Failed to load weekly entries:",t.t0),(i=document.querySelector(".weekly-tracker-container"))&&(i.innerHTML='\n                <div class="bg-white rounded-xl border border-gray-200 p-4 text-center text-red-500">\n                    <p>Gagal memuat data mood tracker mingguan.</p>\n                </div>\n            ');case 13:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return n.apply(this,arguments)})},{key:"setupMobileCarousel",value:function(){var t=this,e=document.querySelector(".mood-mobile-carousel");if(e){var r=e.querySelector(".mood-mobile-carousel-slides"),n=e.querySelectorAll(".mobile-carousel-dot");this.mobileCarouselState={slides:r,dots:n,currentSlide:0,visibleDays:3,totalSlides:Math.ceil(this.presenter.getWeeklyEntries().length/3)},n.forEach((function(e,r){e.addEventListener("click",(function(){return t.goToMobileSlide(r)}))})),this.goToMobileSlide(0);var o=0,i=0;e.addEventListener("touchstart",(function(t){o=t.changedTouches[0].screenX}),{passive:!0}),e.addEventListener("touchend",(function(t){i=t.changedTouches[0].screenX,a()}),{passive:!0});var a=function(){i<o-50&&t.mobileCarouselNext(),i>o+50&&t.mobileCarouselPrev()}}}},{key:"goToMobileSlide",value:function(t){var e=this.mobileCarouselState;if(e){t>=e.totalSlides&&(t=0),t<0&&(t=e.totalSlides-1),e.currentSlide=t;var r=t*(80*e.visibleDays);e.slides.style.transform="translateX(-".concat(r,"px)"),e.dots.forEach((function(t,r){r===e.currentSlide?(t.classList.add("bg-third"),t.classList.remove("bg-gray-300")):(t.classList.remove("bg-third"),t.classList.add("bg-gray-300"))}));var n=document.querySelector("#moodPrevBtn"),o=document.querySelector("#moodNextBtn");window.innerWidth<1024&&(n&&(n.disabled=0===e.currentSlide,0===e.currentSlide?n.classList.add("opacity-50"):n.classList.remove("opacity-50")),o&&(o.disabled=e.currentSlide===e.totalSlides-1,e.currentSlide===e.totalSlides-1?o.classList.add("opacity-50"):o.classList.remove("opacity-50")))}}},{key:"mobileCarouselPrev",value:function(){var t=this.mobileCarouselState;!t||t.currentSlide<=0||this.goToMobileSlide(t.currentSlide-1)}},{key:"mobileCarouselNext",value:function(){var t=this.mobileCarouselState;!t||t.currentSlide>=t.totalSlides-1||this.goToMobileSlide(t.currentSlide+1)}},{key:"renderWeeklyEntries",value:function(t,e){var r=this,n=e.weekRange,o=e.entries;if(o&&0!==o.length){var i=new Date(n.start),a=new Date(n.end),s="".concat(i.toLocaleDateString("id-ID",{day:"numeric",month:"short"})," - ").concat(a.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})),c='\n        <div class="mb-3">\n            <h3 class="text-sm font-medium text-gray-500">Minggu Ini ('.concat(s,')</h3>\n        </div>\n        <div class="grid grid-cols-7 gap-2">\n    ');o.forEach((function(t){var e=new Date(t.date).getDate(),n=t.hasEntry?r.presenter.getMoodEmoji(t.mood):"‚Äî",o=t.hasEntry?"bg-third/10":"bg-gray-100",i=t.hasEntry?"text-gray-800":"text-gray-400";c+='\n            <div class="'.concat(o," rounded-lg p-2 text-center ").concat(i,'">\n                <div class="text-xs font-medium">').concat(t.dayName.slice(0,3),'</div>\n                <div class="text-lg font-bold">').concat(e,'</div>\n                <div class="text-xl my-1">').concat(n,"</div>\n            </div>\n        ")})),c+="</div>",o.some((function(t){return t.hasEntry}))&&(c+='\n            <div class="mt-3 text-xs text-gray-500 text-right">\n                <span>Tap tanggal untuk melihat detail</span>\n            </div>\n        '),t.innerHTML=c;var u=t.querySelectorAll(".grid > div");o.forEach((function(t,e){t.hasEntry&&(u[e].classList.add("cursor-pointer","hover:bg-third/20"),u[e].addEventListener("click",(function(){r.showModal(t.date.split("T")[0],{progress:t.progress,mood:t.mood},!0)})))}))}else t.innerHTML='\n            <div class="text-center py-4 text-gray-500">\n                <p>Belum ada data mood tracker untuk minggu ini.</p>\n            </div>\n        '}},{key:"updateRecommendationsSection",value:function(t){var e=document.getElementById("recommendations-container");e&&(e.innerHTML=k(t))}},{key:"setupRegenerateButton",value:function(){var t=this;document.addEventListener("click",function(){var e=rr(tr().mark((function e(r){var n,o;return tr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.target.closest("#regenerate-recommendations")){e.next=17;break}return e.prev=1,(n=r.target.closest("#regenerate-recommendations")).innerHTML,n.innerHTML='\n                    <svg class="animate-spin h-4 w-4 mr-1" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">\n                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>\n                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>\n                    </svg>\n                    Memuat...\n                    ',n.disabled=!0,e.next=8,t.presenter.regenerateRecommendations();case 8:o=e.sent,t.updateRecommendationsSection(o),E("Rekomendasi aktivitas baru telah dimuat!"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.error("Failed to regenerate recommendations:",e.t0),E(e.t0.message||"Gagal memuat rekomendasi baru","error");case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}())}},{key:"updateTodayButtonState",value:function(){var t=document.getElementById("todayBtn"),e=this.presenter.getCurrentDate(),r=new Date,n=e.getMonth()===r.getMonth()&&e.getFullYear()===r.getFullYear();t.className=n?"bg-gray-200 text-gray-400 text-sm px-4 py-2 rounded-md":"bg-third text-white text-sm px-4 py-2 rounded-md hover:bg-third/80 transition-colors"}},{key:"handleDayClick",value:(r=rr(tr().mark((function t(e){var r,n;return tr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return document.querySelectorAll("div[data-date]").forEach((function(t){t.classList.remove("bg-blue-100")})),e.classList.add("bg-blue-100"),r=e.getAttribute("data-date"),t.prev=3,t.next=6,this.presenter.getEntryByDate(r);case 6:n=t.sent,this.showModal(n.formattedDate,n.data,!0),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(3),console.error("Error fetching mind tracker data:",t.t0),E(t.t0.message||"Terjadi kesalahan server","error");case 14:case"end":return t.stop()}}),t,this,[[3,10]])}))),function(t){return r.apply(this,arguments)})},{key:"showModal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=document.getElementById("mindTrackerModal");n&&n.remove();var o=!!document.getElementById("calendarDays").contains(document.activeElement)||r,i=(null==e?void 0:e.mood)||"";document.body.insertAdjacentHTML("beforeend",function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=[{value:"sadness",emoji:"üòû",label:"Sedih"},{value:"neutral",emoji:"üòê",label:"Netral"},{value:"joy",emoji:"üòä",label:"Senang"},{value:"anger",emoji:"üò†",label:"Marah"}].find((function(t){return t.value===e}))||{},n=r.emoji||"",o=r.label||"";return'\n    <div id="mindTrackerModal" class="fixed inset-0 items-center justify-center bg-black/40 z-50 hidden ">\n        <div class="bg-white rounded-lg shadow-lg p-6 w-[90%] md:w-lg lg:w-full lg:max-w-lg">\n            <div class="flex justify-between items-center mb-4">\n                <h3 id="modalTitle" class="text-lg font-semibold">Mind Tracker</h3>\n                <button id="closeModalBtn" class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>\n            </div>\n            <hr class="my-4 text-gray-300">\n            <form id="mindTrackerForm">\n                <div class="text-center mb-4">\n                    '.concat(t&&e?'\n                        <p class="text-md my-4">Perasaanmu Terdeteksi</p>\n                        <div class="flex justify-center mb-2">\n                            <div class="flex flex-col items-center">\n                                <span class="text-4xl">'.concat(n,'</span>\n                                <div class="text-sm mt-2">').concat(o,"</div>\n                            </div>\n                        </div>\n                    "):t?'\n                        <p class="text-md my-4">Belum ada data mood</p>\n                    ':'\n                        <p class="text-md my-4">Perasaanmu Hari ini</p>\n                        <p class="text-xs text-gray-500 mb-4">(Akan terdeteksi otomatis dari teks yang kamu tulis)</p>\n                    ','\n\n                    <p class="mb-4 mt-8">Progres kamu</p>\n                    <textarea name="progress" class="w-full border p-2 rounded-xl overflow-hidden" rows="3" placeholder="Ceritakan bagaimana harimu dan perasaanmu sekarang" required ').concat(t?"readonly":"","></textarea>\n                </div>\n                ").concat(t?"":'\n                <div id="submit-mind-tracker" class="flex justify-end">\n                    <button type="submit" class="w-30 bg-third text-white py-2 px-4 rounded-lg mt-2 justify-end text-xs lg:text-sm">Kirim</button>\n                </div>\n                ',"\n            </form>\n        </div>\n    </div>\n    ")}(o,i));var a=document.getElementById("mindTrackerModal"),s=document.getElementById("modalTitle"),c=(document.getElementById("closeModalBtn"),document.getElementById("mindTrackerForm")),u=t;if(t.match(/^\d{4}-\d{2}-\d{2}$/)){var l=t.split("-");u=new Date(l[0],l[1]-1,l[2]).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})}if(s.textContent="Mind Tracker ‚Äî ".concat(u),a.classList.remove("hidden"),a.classList.add("flex"),e){document.querySelector('textarea[name="progress"]').value=e.progress||"";var d=document.getElementById("selected-mood");d&&e.mood&&(d.value=e.mood)}if(o){var h=document.getElementById("mindTrackerForm");h&&(h.onsubmit=function(t){return t.preventDefault(),!1})}this.setupModalEventListeners(a,c,t)}},{key:"setupModalEventListeners",value:function(t,e,r){var n=this,o=document.getElementById("closeModalBtn"),i=document.querySelectorAll(".mood-option"),a=document.getElementById("selected-mood");e.querySelector('textarea[name="progress"]').readOnly||i.forEach((function(t){t.addEventListener("click",(function(){i.forEach((function(t){t.querySelector("span").classList.remove("scale-125")}));var e=t.dataset.mood;t.querySelector("span").classList.add("scale-125"),a.value=e}))})),o.addEventListener("click",(function(){t.classList.add("hidden"),t.classList.remove("flex")})),t.addEventListener("click",(function(e){e.target===t&&(t.classList.add("hidden"),t.classList.remove("flex"))})),e&&e.addEventListener("submit",function(){var o=rr(tr().mark((function o(i){var a,s,c,u,l,d;return tr().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(i.preventDefault(),i.stopPropagation(),a=new FormData(e),(s=a.get("progress"))&&""!==s.trim()){o.next=7;break}return E("Silakan isi progress Anda hari ini.","error"),o.abrupt("return",!1);case 7:return c=document.querySelector("#submit-mind-tracker button"),u=c.innerHTML,c.disabled=!0,c.innerHTML="Memproses...",l={date:n.presenter.parseDateString(r).toISOString(),progress:a.get("progress")},o.prev=12,o.next=15,n.presenter.saveEntry(l);case 15:if((d=o.sent).error){o.next=26;break}return t.classList.add("hidden"),t.classList.remove("flex"),e.reset(),Ue(n.presenter.getCurrentDate(),n.presenter.getMonthNames()),o.next=23,n.loadAndRenderWeeklyEntries();case 23:E(d.message,"success"),o.next=27;break;case 26:throw new Error(d.message);case 27:o.next=35;break;case 29:o.prev=29,o.t0=o.catch(12),console.error("Error saving mind tracker:",o.t0),E(o.t0.message||"Terjadi kesalahan server","error"),c.disabled=!1,c.innerHTML=u;case 35:return o.abrupt("return",!1);case 36:case"end":return o.stop()}}),o,null,[[12,29]])})));return function(t){return o.apply(this,arguments)}}())}}],e&&nr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}();function ar(t){return ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ar(t)}function sr(){sr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==ar(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ar(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function cr(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function ur(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){cr(i,n,o,a,s,"next",t)}function s(t){cr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function lr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dr(n.key),n)}}function dr(t){var e=function(t){if("object"!=ar(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ar(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ar(e)?e:e+""}var hr=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e},e=[{key:"loadNotifications",value:(o=ur(sr().mark((function t(){var e,r;return sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_t();case 3:if(!(e=t.sent).error){t.next=7;break}return this.view.showError(e.message),t.abrupt("return");case 7:r=this.formatNotifications(e.data),this.view.displayNotifications(r),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("Error loading notifications:",t.t0),this.view.showError("Gagal memuat notifikasi");case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return o.apply(this,arguments)})},{key:"formatNotifications",value:function(t){var e=this;return t.map((function(t){return{id:t._id,icon:e.getNotificationIcon(t.type),title:e.getNotificationTitle(t.type),message:t.message,type:t.type,read:t.read,createdAt:t.createdAt,storyId:t.storyId,commentId:t.commentId,fromUsername:t.fromUsername}}))}},{key:"getNotificationTitle",value:function(t){return{comment:"Komentar Baru",reply:"Balasan Komentar",like:"Suka",story:"Story Baru",follow:"Pengikut Baru",reminder:"Pengingat",system:"Sistem"}[t]||"Notifikasi"}},{key:"getNotificationIcon",value:function(t){return{comment:"images/logo.png",reply:"images/logo.png",like:"images/logo.png",story:"images/logo.png",follow:"images/logo.png",reminder:"images/logo.png",system:"images/logo.png"}[t]||"images/logo.png"}},{key:"markAsRead",value:(n=ur(sr().mark((function t(e){var r;return sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ot(e);case 3:if(!(r=t.sent).error){t.next=7;break}return console.error("Error marking notification as read:",r.message),t.abrupt("return",!1);case 7:return this.view.updateNotificationReadStatus(e),t.abrupt("return",!0);case 11:return t.prev=11,t.t0=t.catch(0),console.error("Error marking notification as read:",t.t0),t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t){return n.apply(this,arguments)})},{key:"markAllAsRead",value:(r=ur(sr().mark((function t(){var e;return sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Tt();case 3:if(!(e=t.sent).error){t.next=13;break}if(console.error("Error marking all notifications as read:",e.message),!e.message.includes("terhubung ke server")){t.next=11;break}return console.warn("Network error - updating all notifications UI optimistically"),this.view.updateAllNotificationsReadStatus(),this.view.showSuccessMessage("Semua notifikasi ditandai sebagai dibaca (offline)"),t.abrupt("return",!0);case 11:return this.view.showError(e.message),t.abrupt("return",!1);case 13:return this.view.updateAllNotificationsReadStatus(),this.view.showSuccessMessage("Semua notifikasi ditandai sebagai dibaca"),t.abrupt("return",!0);case 18:return t.prev=18,t.t0=t.catch(0),console.error("Error marking all notifications as read:",t.t0),this.view.showError("Gagal menandai semua notifikasi sebagai dibaca"),t.abrupt("return",!1);case 23:case"end":return t.stop()}}),t,this,[[0,18]])}))),function(){return r.apply(this,arguments)})}],e&&lr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o}();function fr(t){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fr(t)}function pr(){pr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==fr(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(fr(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function mr(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function vr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){mr(i,n,o,a,s,"next",t)}function s(t){mr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function yr(){return gr.apply(this,arguments)}function gr(){return(gr=vr(pr().mark((function t(){var e;return pr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Notification"in window){t.next=3;break}return console.error("Notification API unsupported."),t.abrupt("return",!1);case 3:if("granted"!==Notification.permission){t.next=5;break}return t.abrupt("return",!0);case 5:return t.next=7,Notification.requestPermission();case 7:if("denied"!==(e=t.sent)){t.next=11;break}return alert("Izin notifikasi ditolak."),t.abrupt("return",!1);case 11:if("default"!==e){t.next=14;break}return alert("Izin notifikasi ditutup atau diabaikan."),t.abrupt("return",!1);case 14:return t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function br(){return wr.apply(this,arguments)}function wr(){return(wr=vr(pr().mark((function t(){var e;return pr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.serviceWorker.getRegistration();case 2:return e=t.sent,t.next=5,e.pushManager.getSubscription();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function xr(){return kr.apply(this,arguments)}function kr(){return(kr=vr(pr().mark((function t(){return pr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,br();case 2:return t.abrupt("return",!!t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Er(){return Sr.apply(this,arguments)}function Sr(){return(Sr=vr(pr().mark((function t(){var e,r,n,o,i,a,s,c;return pr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,yr();case 2:if(t.sent){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,xr();case 6:if(!t.sent){t.next=9;break}return alert("Sudah berlangganan push notification."),t.abrupt("return");case 9:return console.log("Mulai berlangganan push notification..."),e="Langganan push notification gagal diaktifkan.",r="Langganan push notification berhasil diaktifkan.",t.prev=12,t.next=15,navigator.serviceWorker.getRegistration();case 15:return o=t.sent,t.next=18,o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:l("BH25fzqLGh8WAEAkneThLf5ngeFv88HtEVcFrzH2W_cwDYFmFHr6hmtXrS8zsRUrxKweRWAFhxi9uNR37c66gfU")});case 18:return n=t.sent,i=n.toJSON(),a=i.endpoint,s=i.keys,t.next=22,Ct({endpoint:a,keys:s});case 22:if(c=t.sent,console.log({endpoint:a,keys:s}),!c.error){t.next=30;break}return console.error("subscribe: response:",c),alert(e),t.next=29,n.unsubscribe();case 29:return t.abrupt("return");case 30:console.log("subscribe: response:",c),alert(r),t.next=40;break;case 34:return t.prev=34,t.t0=t.catch(12),console.error("subscribe: error:",t.t0),alert(e),t.next=40,n.unsubscribe();case 40:case"end":return t.stop()}}),t,null,[[12,34]])})))).apply(this,arguments)}function jr(){return _r.apply(this,arguments)}function _r(){return(_r=vr(pr().mark((function t(){var e,r,n,o,i,a,s;return pr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="Langganan push notification gagal dinonaktifkan.",r="Langganan push notification berhasil dinonaktifkan.",t.prev=2,t.next=5,br();case 5:if(n=t.sent){t.next=9;break}return alert("Tidak bisa memutus langganan push notification karena belum berlangganan sebelumnya."),t.abrupt("return");case 9:return o=n.toJSON(),i=o.endpoint,a=o.keys,t.next=12,Nt({endpoint:i});case 12:if(!(s=t.sent).error){t.next=17;break}return alert(e),console.error("unsubscribe: response:",s),t.abrupt("return");case 17:return t.next=19,n.unsubscribe();case 19:if(t.sent){t.next=25;break}return alert(e),t.next=24,Ct({endpoint:i,keys:a});case 24:return t.abrupt("return");case 25:alert(r),t.next=32;break;case 28:t.prev=28,t.t0=t.catch(2),alert(e),console.error("unsubscribe: error:",t.t0);case 32:case"end":return t.stop()}}),t,null,[[2,28]])})))).apply(this,arguments)}function Pr(t){return Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pr(t)}function Or(){Or=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Pr(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Pr(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function Ir(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Tr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ir(i,n,o,a,s,"next",t)}function s(t){Ir(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Lr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Cr(n.key),n)}}function Cr(t){var e=function(t){if("object"!=Pr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Pr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pr(e)?e:e+""}var Br=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.presenter=new hr(this),this.notifications=[],this.isSubscribed=!1,this.isSupported=!1,this.currentPage=1,this.itemsPerPage=8,this.totalPages=1},e=[{key:"render",value:(i=Tr(Or().mark((function t(){return Or().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="lg:p-10 p-6 md:p-6 pb-20">\n        <div class="max-w-xl w-full ml-0 md:ml-16 lg:ml-16 text-left">\n          <div class="flex justify-between items-center ">\n            <h1 class="text-2xl font-semibold">Pemberitahuan</h1> \n          </div>\n          <hr class="my-4 text-gray-300">\n\n        <div class="flex justify-between items-center mb-6"> \n          <div id="push-notification-container">\n          </div>\n          <button id="mark-all-read-btn" class="text-xs lg:text-sm text-third hover:text-third/80 hidden">\n            Tandai Semua Dibaca\n          </button>\n        </div>\n         \n          \n          <div id="notification-loading" class="text-center py-8">\n            <p class="text-gray-500">Memuat notifikasi...</p>\n          </div>\n          \n          <div id="notification-container" class="hidden">\n            <div id="notification-list">\n            </div>\n            \n            <div id="pagination-container" class="flex justify-between items-center mt-6 pt-4 border-t border-gray-200 hidden">\n              <button id="prev-btn" class="px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed" disabled>\n              \n                <span class="hidden sm:inline">‚Üê Sebelumnya</span>\n            \n                <span class="sm:hidden text-lg">‚Äπ</span>\n              </button>\n              \n              <span id="page-info" class="text-sm text-gray-600 font-medium">\n                <span class="sm:hidden">1/1</span>\n                <span class="hidden sm:inline">Halaman 1 dari 1</span>\n              </span>\n              \n              <button id="next-btn" class="px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed" disabled>\n               \n                <span class="hidden sm:inline">Selanjutnya ‚Üí</span>\n            \n                <span class="sm:hidden text-lg">‚Ä∫</span>\n              </button>\n            </div>\n          \n          <div id="notification-error" class="hidden text-center py-8">\n            <p class="text-red-500">Gagal memuat notifikasi</p>\n            <button id="retry-btn" class="mt-4 px-4 py-2 bg-third text-white rounded-lg">Coba Lagi</button>\n          </div>\n\n          <div id="success-message" class="hidden bg-third/10 border border-third text-third px-4 py-3 rounded mb-4">\n            <p></p>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(o=Tr(Or().mark((function t(){return Or().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.setupPushNotificationButton();case 2:return t.next=4,this.presenter.loadNotifications();case 4:this.attachEventListeners();case 5:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"setupPushNotificationButton",value:(n=Tr(Or().mark((function t(){var e,r;return Or().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.getElementById("push-notification-container"),t.prev=1,t.next=4,xr();case 4:r=t.sent,e.innerHTML=r?'\n          <button id="push-notification-btn" class="px-4 py-2 bg-red-500 text-white text-sm rounded-lg hover:bg-red-600 transition-colors" data-action="unsubscribe">\n            Nonaktifkan Push Notifikasi\n          </button>\n        ':'\n          <button id="push-notification-btn" class="px-4 py-2 bg-third text-white text-sm rounded-lg hover:bg-third/90 transition-colors" data-action="subscribe">\n            Aktifkan Push Notifikasi\n          </button>\n        ',t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.error("Error checking subscription status:",t.t0),e.innerHTML='\n        <button id="push-notification-btn" class="px-4 py-2 bg-third text-white text-sm rounded-lg hover:bg-third/90 transition-colors" data-action="subscribe">\n          Aktifkan Push Notifikasi\n        </button>\n      ';case 12:case"end":return t.stop()}}),t,null,[[1,8]])}))),function(){return n.apply(this,arguments)})},{key:"handlePushNotificationToggle",value:(r=Tr(Or().mark((function t(){var e,r,n;return Or().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.getElementById("push-notification-btn"),r=e.dataset.action,n=e.textContent,e.disabled=!0,e.textContent="Memproses...",t.prev=5,"subscribe"!==r){t.next=15;break}return t.next=9,Er();case 9:this.showSuccessMessage("Push notification berhasil diaktifkan!"),e.textContent="Nonaktifkan Push Notifikasi",e.className="px-4 py-2 bg-red-500 text-white text-sm rounded-lg hover:bg-red-600 transition-colors",e.dataset.action="unsubscribe",t.next=21;break;case 15:return t.next=17,jr();case 17:this.showSuccessMessage("Push notification berhasil dinonaktifkan!"),e.textContent="Aktifkan Push Notifikasi",e.className="px-4 py-2 bg-third text-white text-sm rounded-lg hover:bg-third/90 transition-colors",e.dataset.action="subscribe";case 21:t.next=28;break;case 23:t.prev=23,t.t0=t.catch(5),console.error("Error toggling push notification:",t.t0),"subscribe"===r?alert("Gagal mengaktifkan push notification: "+t.t0.message):alert("Gagal menonaktifkan push notification: "+t.t0.message),e.textContent=n;case 28:return t.prev=28,e.disabled=!1,t.finish(28);case 31:case"end":return t.stop()}}),t,this,[[5,23,28,31]])}))),function(){return r.apply(this,arguments)})},{key:"displayNotifications",value:function(t){this.notifications=t,this.currentPage=1,this.totalPages=Math.ceil(t.length/this.itemsPerPage);var e=document.getElementById("notification-container"),r=document.getElementById("notification-loading"),n=document.getElementById("notification-error");r.classList.add("hidden"),n.classList.add("hidden"),0===t.length?(document.getElementById("notification-list").innerHTML='\n        <div class="text-center py-8">\n          <p class="text-gray-500">Belum ada notifikasi</p>\n        </div>\n      ',this.hidePagination(),this.hideMarkAllButton()):(this.renderCurrentPage(),this.updatePagination(),this.updateMarkAllButtonVisibility()),e.classList.remove("hidden")}},{key:"renderCurrentPage",value:function(){var t=(this.currentPage-1)*this.itemsPerPage,e=t+this.itemsPerPage,r=this.notifications.slice(t,e);document.getElementById("notification-list").innerHTML='\n        <div class="">\n            <div>\n                '.concat(r.map(v).join(""),"\n            </div>\n        </div>\n    "),this.attachNotificationClickListeners()}},{key:"updatePagination",value:function(){var t=document.getElementById("pagination-container"),e=document.getElementById("prev-btn"),r=document.getElementById("next-btn"),n=document.getElementById("page-info");this.totalPages<=1?this.hidePagination():(t.classList.remove("hidden"),n.textContent="Halaman ".concat(this.currentPage," dari ").concat(this.totalPages),e.disabled=1===this.currentPage,r.disabled=this.currentPage===this.totalPages)}},{key:"hidePagination",value:function(){document.getElementById("pagination-container").classList.add("hidden")}},{key:"goToPreviousPage",value:function(){this.currentPage>1&&(this.currentPage--,this.renderCurrentPage(),this.updatePagination(),document.getElementById("notification-list").scrollIntoView({behavior:"smooth"}))}},{key:"goToNextPage",value:function(){this.currentPage<this.totalPages&&(this.currentPage++,this.renderCurrentPage(),this.updatePagination(),document.getElementById("notification-list").scrollIntoView({behavior:"smooth"}))}},{key:"attachEventListeners",value:function(){var t=this,e=document.getElementById("retry-btn");e&&e.addEventListener("click",(function(){t.showLoading(),t.presenter.loadNotifications()}));var r=document.getElementById("mark-all-read-btn");r&&r.addEventListener("click",(function(){t.handleMarkAllAsRead()}));var n=document.getElementById("push-notification-btn");n&&n.addEventListener("click",(function(){t.handlePushNotificationToggle()}));var o=document.getElementById("prev-btn");o&&o.addEventListener("click",(function(){t.goToPreviousPage()}));var i=document.getElementById("next-btn");i&&i.addEventListener("click",(function(){t.goToNextPage()})),this.attachNotificationClickListeners()}},{key:"updateNotificationReadStatus",value:function(t){var e=this.notifications.find((function(e){return e.id===t}));e&&(e.read=!0),this.renderCurrentPage(),this.updateMarkAllButtonVisibility()}},{key:"updateAllNotificationsReadStatus",value:function(){this.notifications.forEach((function(t){t.read=!0})),this.renderCurrentPage(),this.hideMarkAllButton()}},{key:"hideMarkAllButton",value:function(){var t=document.getElementById("mark-all-read-btn");t&&t.classList.add("hidden")}},{key:"attachNotificationClickListeners",value:function(){var t=this;document.querySelectorAll("[data-notification-id]").forEach((function(e){e.removeEventListener("click",t.handleNotificationClickBound),t.handleNotificationClickBound=function(e){var r=e.currentTarget.dataset.notificationId;t.handleNotificationClick(r)},e.addEventListener("click",t.handleNotificationClickBound)}))}},{key:"handleMarkAllAsRead",value:function(){var t=document.getElementById("mark-all-read-btn");t.disabled=!0,t.textContent="Memproses...",this.presenter.markAllAsRead().then((function(){t.disabled=!1,t.textContent="Tandai Semua Dibaca"}))}},{key:"showLoading",value:function(){var t=document.getElementById("notification-container"),e=document.getElementById("notification-loading"),r=document.getElementById("notification-error"),n=document.getElementById("mark-all-read-btn");t.classList.add("hidden"),r.classList.add("hidden"),n.classList.add("hidden"),e.classList.remove("hidden")}},{key:"showError",value:function(t){var e=document.getElementById("notification-container"),r=document.getElementById("notification-loading"),n=document.getElementById("notification-error"),o=n.querySelector("p");r.classList.add("hidden"),e.classList.add("hidden"),o.textContent=t,n.classList.remove("hidden")}},{key:"showSuccessMessage",value:function(t){var e=document.getElementById("success-message");e.querySelector("p").textContent=t,e.classList.remove("hidden"),setTimeout((function(){e.classList.add("hidden")}),3e3)}},{key:"handleNotificationClick",value:function(t){var e=this.notifications.find((function(e){return e.id===t}));if(e){var r=!e.read;r&&this.updateNotificationReadStatus(t),"comment"===e.type&&e.storyId||"reply"===e.type&&e.storyId?window.location.hash="#/story/".concat(e.storyId):"reminder"===e.type&&(window.location.hash="#/mindtracker"),r&&this.presenter.markAsRead(t).catch((function(t){console.warn("Failed to mark notification as read on server, but UI updated locally:",t)}))}}},{key:"updateMarkAllButtonVisibility",value:function(){var t=document.getElementById("mark-all-read-btn");t&&(this.notifications.some((function(t){return!t.read}))?t.classList.remove("hidden"):t.classList.add("hidden"))}}],e&&Lr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}();function Nr(t){return Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nr(t)}function Ar(){Ar=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Nr(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Nr(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function Mr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Gr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Mr(Object(r),!0).forEach((function(e){Dr(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Dr(t,e,r){return(e=Rr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fr(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Hr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Fr(i,n,o,a,s,"next",t)}function s(t){Fr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function qr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Rr(n.key),n)}}function Rr(t){var e=function(t){if("object"!=Nr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Nr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Nr(e)?e:e+""}function zr(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function Ur(t,e){return t.get(Jr(t,e))}function Wr(t,e,r){return t.set(Jr(t,e),r),r}function Jr(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yr=new WeakMap,Kr=new WeakMap,Vr=new WeakMap,Xr=function(){return t=function t(e){var r=e.view,n=e.authModel;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),zr(this,Yr,void 0),zr(this,Kr,void 0),zr(this,Vr,[]),Wr(Yr,this,r),Wr(Kr,this,n)},e=[{key:"loadUserProfile",value:(s=Hr(Ar().mark((function t(){var e,r,n;return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(e=JSON.parse(localStorage.getItem("user"))||{}).username){t.next=5;break}throw console.warn("User data not found in localStorage for profile page."),new Error("User data not found. Please log in.");case 5:return t.next=7,yt(e.username);case 7:if(!(r=t.sent).error){t.next=10;break}throw new Error(r.message);case 10:return e=Gr(Gr({},e),r.data),localStorage.setItem("user",JSON.stringify(e)),"function"==typeof Ur(Yr,this).updateProfileHeaderDisplay&&Ur(Yr,this).updateProfileHeaderDisplay(e),t.next=15,ft();case 15:if(!(n=t.sent).error){t.next=18;break}throw new Error(n.message);case 18:return Wr(Vr,this,(n.data||[]).filter((function(t){return!t.isAnonymous&&t.username===e.username})).map((function(t){var r;return Gr(Gr({},t),{},{likeCount:t.likeCount,userLiked:t.userLiked||!1,commentCount:(null===(r=t.comments)||void 0===r?void 0:r.length)||0,profilePicture:e.profilePicture||"./images/image.png",name:e.name})}))),Ur(Yr,this).showUserStories(Ur(Vr,this)),t.abrupt("return",!0);case 23:return t.prev=23,t.t0=t.catch(0),console.error("Failed to load profile:",t.t0),t.abrupt("return",!1);case 27:case"end":return t.stop()}}),t,this,[[0,23]])}))),function(){return s.apply(this,arguments)})},{key:"updateProfile",value:(a=Hr(Ar().mark((function t(e){var r,n,o;return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,St(e);case 3:if(!(r=t.sent).error){t.next=6;break}throw new Error(r.message);case 6:return n=JSON.parse(localStorage.getItem("user"))||{},o=Gr(Gr(Gr({},n),r.data),{},{profilePicture:r.data.profilePicture||n.profilePicture}),localStorage.setItem("user",JSON.stringify(o)),document.dispatchEvent(new CustomEvent("profileUpdated",{detail:o})),"function"==typeof Ur(Yr,this).updateProfileHeaderDisplay&&Ur(Yr,this).updateProfileHeaderDisplay(o),t.abrupt("return",r);case 14:throw t.prev=14,t.t0=t.catch(0),console.error("Failed to update profile:",t.t0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(t){return a.apply(this,arguments)})},{key:"isStoryOnProfile",value:function(t){return Ur(Vr,this).some((function(e){return e.id===t||e._id===t}))}},{key:"likeStory",value:(i=Hr(Ar().mark((function t(e){var r;return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}throw new Error("Invalid story ID");case 3:return t.next=5,wt(e);case 5:if(!(r=t.sent).error){t.next=8;break}throw new Error(r.message||"Failed to like story");case 8:return t.abrupt("return",r);case 13:throw t.prev=13,t.t0=t.catch(0),console.error("ProfilePresenter: Failed to like story:",t.t0),t.t0;case 17:case"end":return t.stop()}}),t,this,[[0,13]])}))),function(t){return i.apply(this,arguments)})},{key:"addComment",value:(o=Hr(Ar().mark((function t(e,r){var n,o,i,a,s;return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e&&r){t.next=3;break}throw new Error("Invalid data for comment");case 3:return t.next=5,kt(e,r);case 5:if(!(o=t.sent).error){t.next=8;break}throw new Error(o.message);case 8:return-1!==(i=Ur(Vr,this).findIndex((function(t){return t.id===e||t._id===e})))&&(Ur(Vr,this)[i].comments=(null===(a=o.data)||void 0===a?void 0:a.comments)||[],Ur(Vr,this)[i].commentCount=((null===(s=o.data)||void 0===s?void 0:s.comments)||[]).length),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:e,action:"commented",comments:o.data.comments}})),t.abrupt("return",((null===(n=o.data)||void 0===n?void 0:n.comments)||[]).length);case 14:throw t.prev=14,t.t0=t.catch(0),console.error("ProfilePresenter: Failed to add comment:",t.t0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(t,e){return o.apply(this,arguments)})},{key:"editStory",value:(n=Hr(Ar().mark((function t(e,r){var n,o;return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r&&"string"==typeof r&&""!==r.trim()){t.next=3;break}throw new Error("Content is required");case 3:return t.next=5,Mt(e,r.trim());case 5:if(!(n=t.sent).error){t.next=8;break}throw new Error(n.message);case 8:return-1!==(o=Ur(Vr,this).findIndex((function(t){return t.id===e||t._id===e})))&&(Ur(Vr,this)[o]=Gr(Gr({},Ur(Vr,this)[o]),{},{content:n.data.content,updatedAt:n.data.updatedAt})),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:e,action:"edited",updatedStory:n.data}})),t.abrupt("return",!0);case 14:throw t.prev=14,t.t0=t.catch(0),console.error("ProfilePresenter: Failed to edit story:",t.t0),t.t0;case 18:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(t,e){return n.apply(this,arguments)})},{key:"deleteStory",value:(r=Hr(Ar().mark((function t(e){var r;return Ar().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Gt(e);case 3:if(!(r=t.sent).error){t.next=6;break}throw new Error(r.message);case 6:return Wr(Vr,this,Ur(Vr,this).filter((function(t){return t.id!==e&&t._id!==e}))),document.dispatchEvent(new CustomEvent("storyDataChanged",{detail:{storyId:e,action:"deleted"}})),t.abrupt("return",!0);case 11:throw t.prev=11,t.t0=t.catch(0),console.error("ProfilePresenter: Failed to delete story:",t.t0),t.t0;case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t){return r.apply(this,arguments)})},{key:"handleLogout",value:function(){Ur(Kr,this).getLogout(),Ur(Yr,this).logoutSuccess(),localStorage.removeItem("user"),localStorage.removeItem("sessionId"),sessionStorage.removeItem("welcomeModalShown"),localStorage.removeItem("hasInteractedWithChatbot")}}],e&&qr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,s}();function $r(t){return $r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$r(t)}function Qr(){Qr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==$r(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError($r(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function Zr(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function tn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Zr(i,n,o,a,s,"next",t)}function s(t){Zr(i,n,o,a,s,"throw",t)}a(void 0)}))}}function en(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rn(n.key),n)}}function rn(t){var e=function(t){if("object"!=$r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$r(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$r(e)?e:e+""}function nn(t,e,r){on(t,e),e.set(t,r)}function on(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function an(t,e){return t.get(cn(t,e))}function sn(t,e,r){return t.set(cn(t,e),r),r}function cn(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var un=new WeakMap,ln=new WeakMap,dn=new WeakMap,hn=new WeakMap,fn=new WeakMap,pn=new WeakSet,mn=function(){return t=function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),on(this,e=pn),e.add(this),nn(this,un,null),nn(this,ln,null),nn(this,dn,null),nn(this,hn,null),nn(this,fn,null)},r=[{key:"render",value:(o=tn(Qr().mark((function t(){return Qr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return sn(ln,this,JSON.parse(localStorage.getItem("user"))||{}),t.abrupt("return",(e=an(ln,this),'\n  <div class="md:ml-16 lg:ml-16 min-h-screen p-6 lg:p-10 pb-20 lg:pb-10">\n    <div class="max-w">\n\n    <div class="flex justify-between items-center mb-10">\n    <h1 class="text-2xl font-semibold text-gray-900">Profil</h1>\n\n      <div class="relative md:hidden">\n      <button class="profileMenuBtn text-gray-500 hover:text-gray-700">\n        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n          <circle cx="12" cy="12" r="1"></circle>\n          <circle cx="12" cy="5" r="1"></circle>\n          <circle cx="12" cy="19" r="1"></circle>\n          </svg>\n        </button>\n\n        <div class="story-menu hidden absolute right-0 mt-1 w-32 bg-white rounded-md shadow-lg z-10 border border-gray-200">\n          <button id="editProfileMobile" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Sunting</button>\n          <button id="logoutBtnMobile" class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100"">Keluar</button>\n          </div>\n        </div>\n        </div>\n\n            \n        <div class="mt-8">\n        <div class="flex items-center justify-between mb-8">\n          <div class="flex items-center gap-4">\n          <div class="w-24 h-24 rounded-full overflow-hidden">\n            <img src="'.concat(e.profilePicture||"/images/image.png",'" alt="Foto Profil" class="w-full h-full object-cover">\n          </div>\n          <div>\n            <div class="text-lg font-medium">').concat(e.name||"Nama Pengguna",'</div>\n              <div class="text-gray-500">@').concat(e.username||"namapengguna",'</div>\n            </div>\n          </div>\n            \n        <div class="flex gap-4 mt-6 md:mt-0">\n          <button id="editProfileBtn" class="w-25 border border-primary rounded-lg text-primary mt-2 justify-end hidden md:block">Sunting</button>\n          <button id="logoutBtnDesktop" class="w-25 bg-red-300 text-white py-2 rounded-lg mt-2 justify-end hidden md:block">Keluar</button>\n          </div>\n        </div>\n        </div>\n\n        <hr class="my-4 border-gray-300">\n\n      <div class="bg-none">\n        <h2 class="text-lg font-medium mb-4">Unggahan</h2>\n        <div id="user-stories-container" class="mt-6">\n          <p class="text-gray-500 text-center py-8">Belum ada unggahan</p>\n        </div>\n        </div>\n      </div>\n    </div>\n  ')));case 2:case"end":return t.stop()}var e}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(n=tn(Qr().mark((function t(){return Qr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return sn(un,this,new Xr({view:this,authModel:e})),cn(pn,this,yn).call(this),cn(pn,this,gn).call(this),cn(pn,this,vn).call(this),t.next=6,an(un,this).loadUserProfile();case 6:cn(pn,this,bn).call(this);case 7:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"destroy",value:function(){an(dn,this)&&(document.removeEventListener("storyDataChanged",an(dn,this)),sn(dn,this,null)),an(hn,this)&&(document.removeEventListener("showEditStoryModalRequest",an(hn,this)),sn(hn,this,null)),an(fn,this)&&(document.removeEventListener("profileUpdated",an(fn,this)),sn(fn,this,null)),console.log("ProfilePage destroyed and listeners cleaned up.")}},{key:"showUserStories",value:function(t){var e=this,r=document.getElementById("user-stories-container");r?(sn(ln,this,JSON.parse(localStorage.getItem("user"))||{}),t&&0!==t.length?(r.innerHTML=t.map((function(t){var r,n=t.id||t._id,o=t.isAnonymous?"Pengguna":t.name||an(ln,e).name,i=t.isAnonymous?"Anonim":"@".concat(t.username||an(ln,e).username),a=t.isAnonymous?"./images/image.png":t.profilePicture||an(ln,e).profilePicture||"./images/image.png",s=!t.isAnonymous&&t.username===an(ln,e).username;return y({username:o,handle:i,content:t.content,isAnonymous:t.isAnonymous,storyId:n,likeCount:t.likeCount||(null===(r=t.likes)||void 0===r?void 0:r.length)||0,userLiked:t.userLiked||!1,commentCount:t.totalCommentCount,viewCount:t.viewCount||t.views||0,profilePicture:a,createdAt:t.createdAt,isOwner:s})})).join(""),an(un,this)&&(pe(an(un,this),"user-stories-container"),xe(an(un,this),"user-stories-container"))):r.innerHTML='<p class="text-gray-500 text-center py-8">Belum ada unggahan</p>'):console.error("Element with ID 'user-stories-container' not found.")}},{key:"updateProfileHeaderDisplay",value:function(t){var e=document.querySelector(".ml-16.min-h-screen.p-10");if(e){var r=e.querySelector(".w-24.h-24 img"),n=e.querySelector(".text-lg.font-medium"),o=e.querySelector("div > .text-gray-500");r&&(r.src=t.profilePicture||"/images/image.png"),n&&(n.textContent=t.name||"Nama Pengguna"),o&&(o.textContent="@".concat(t.username||"namapengguna"))}}},{key:"logoutSuccess",value:function(){window.location.hash="/"}}],r&&en(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n,o}();function vn(){var t=this;sn(hn,this,(function(e){var r=e.detail,n=r.storyId,o=r.currentContent;an(un,t)&&"function"==typeof an(un,t).isStoryOnProfile?an(un,t).isStoryOnProfile(n)?je(n,o,an(un,t)):console.log("Edit request for story ".concat(n," ignored: not on this profile.")):console.warn("Presenter or isStoryOnProfile method not available. Cannot verify story context for edit.")})),document.addEventListener("showEditStoryModalRequest",an(hn,this))}function yn(){var t=this;sn(dn,this,function(){var e=tn(Qr().mark((function e(r){var n,o,i,a,s,c;return Qr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.detail,o=n.storyId,i=n.action,a=n.newStory,n.updatedStory,s=JSON.parse(localStorage.getItem("user"))||{},c=!1,"posted"===i&&(null==a?void 0:a.username)===s.username?c=!0:["edited","deleted"].includes(i)?an(un,t)&&"function"==typeof an(un,t).isStoryOnProfile&&an(un,t).isStoryOnProfile(o)&&(c=!0):["liked","commented"].includes(i)&&an(un,t)&&"function"==typeof an(un,t).isStoryOnProfile&&an(un,t).isStoryOnProfile(o)&&(c=!0),!c){e.next=8;break}return console.log("ProfilePage: Reloading user profile due to storyDataChanged",{action:i,storyId:o}),e.next=8,an(un,t).loadUserProfile();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),document.addEventListener("storyDataChanged",an(dn,this))}function gn(){var t=this;sn(fn,this,(function(e){var r=e.detail;sn(ln,t,r),console.log("ProfilePage: profileUpdated event received, local currentUser updated.",r)})),document.addEventListener("profileUpdated",an(fn,this))}function bn(){var t=this,e=document.querySelector(".profileMenuBtn"),r=document.querySelector(".story-menu"),n=document.getElementById("editProfileBtn"),o=document.getElementById("editProfileMobile"),i=document.getElementById("logoutBtnDesktop"),a=document.getElementById("logoutBtnMobile");e&&r&&(e.addEventListener("click",(function(t){t.stopPropagation(),r.classList.toggle("hidden")})),window.addEventListener("click",(function(){r.classList.contains("hidden")||r.classList.add("hidden")})));var s=function(){var e=JSON.parse(localStorage.getItem("user"))||an(ln,t)||{};cn(pn,t,wn).call(t,e)},c=function(){an(un,t)&&an(un,t).handleLogout()};n&&n.addEventListener("click",s),o&&o.addEventListener("click",s),i&&i.addEventListener("click",c),a&&a.addEventListener("click",c)}function wn(t){var e=this,r=document.getElementById("editProfileModal");r&&r.remove(),document.body.insertAdjacentHTML("beforeend",function(t){return'\n    <div id="editProfileModal" class="fixed inset-0 flex items-center justify-center bg-black/40 z-50 hidden p-4">\n      <div class="bg-white rounded-lg shadow-lg p-4 sm:p-6 w-full max-w-md">\n      <div class="flex justify-between items-center mb-4">\n        <h3 class="text-lg font-semibold">Edit Profil</h3>\n        <button id="closeEditProfileModalBtn" class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>\n      </div>\n      <hr class="my-4 border-gray-300">\n        \n        <form id="editProfileForm" class="space-y-4">\n          <div>\n            <label class="block text-sm font-medium text-gray-700 mb-1">Nama Lengkap</label>\n            <input type="text" name="name" value="'.concat(t.name||"",'" class="w-full border border-gray-300 rounded-lg p-2 text-sm sm:text-base">\n          </div>\n          \n          <div>\n            <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>\n            <input type="text" name="username" value="').concat(t.username||"",'" \n              class="w-full border border-gray-300 rounded-lg p-2 text-sm sm:text-base">\n          </div>\n          \n          <div>\n            <label class="block text-sm font-medium text-gray-700 mb-1">Foto Profil</label>\n            <div class="flex items-center gap-4">\n            <div class="w-16 h-16 rounded-full overflow-hidden border border-gray-300 flex-shrink-0">\n              <img id="profileImagePreview" src="').concat(t.profilePicture||"/images/image.png",'"alt="Preview Foto Profil" class="w-full h-full object-cover">\n              </div>\n              <input type="file" id="profilePictureInput" accept="image/*" class="hidden">\n              <button type="button" id="changePhotoBtn" class="text-sm text-primary border border-primary rounded-lg px-3 py-1 whitespace-nowrap">Ganti Foto</button>\n            </div>\n          </div>\n          \n          <div class="flex justify-end gap-3 pt-4">\n            <button type="button" id="cancelEditBtn" class="flex-1 sm:flex-none border border-gray-300 px-5 py-2 rounded-lg text-gray-700">Batal</button>\n            <button type="submit" class="flex-1 sm:flex-none bg-third text-white px-5 py-2 rounded-lg">Simpan</button>\n          </div>\n        </form>\n      </div>\n    </div>\n  ')}(t));var n=document.getElementById("editProfileModal"),o=document.getElementById("closeEditProfileModalBtn"),i=document.getElementById("cancelEditBtn"),a=document.getElementById("editProfileForm"),s=document.getElementById("changePhotoBtn"),c=document.getElementById("profilePictureInput"),u=document.getElementById("profileImagePreview");if(!(n&&o&&i&&a&&s&&c&&u))return console.error("One or more edit profile modal elements not found."),void(n&&n.remove());n.classList.remove("hidden"),n.classList.add("flex");var l=function(){return cn(pn,e,xn).call(e,n)};o.addEventListener("click",l),i.addEventListener("click",l),n.addEventListener("click",(function(t){t.target===n&&l()})),s.addEventListener("click",(function(){c.click()})),c.addEventListener("change",(function(t){var e=t.target.files[0];if(e){var r=new FileReader;r.onload=function(t){u.src=t.target.result},r.readAsDataURL(e)}})),a.addEventListener("submit",function(){var t=tn(Qr().mark((function t(r){var n,o,i,s,u,d;return Qr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),n=a.querySelector('button[type="submit"]'),o=n.textContent,n.disabled=!0,n.textContent="Menyimpan...",i=new FormData(a),s={name:i.get("name"),username:i.get("username")},!c.files[0]){t.next=27;break}if(!((u=c.files[0]).size>2097152)){t.next=14;break}return alert("Ukuran gambar terlalu besar. Maksimal 2MB"),n.disabled=!1,n.textContent=o,t.abrupt("return");case 14:return t.prev=14,t.next=17,cn(pn,e,kn).call(e,u);case 17:s.profilePicture=t.sent,t.next=27;break;case 20:return t.prev=20,t.t0=t.catch(14),console.error("Error converting image to Base64:",t.t0),alert("Gagal memproses gambar. Silakan coba lagi."),n.disabled=!1,n.textContent=o,t.abrupt("return");case 27:if(t.prev=27,!an(un,e)){t.next=33;break}return t.next=31,an(un,e).updateProfile(s);case 31:(d=t.sent)&&!d.error?l():d&&d.message?alert(d.message):alert("Gagal memperbarui profil. Respons tidak diketahui.");case 33:t.next=38;break;case 35:t.prev=35,t.t1=t.catch(27),alert(t.t1.message||"Gagal memperbarui profil.");case 38:return t.prev=38,n.disabled=!1,n.textContent=o,t.finish(38);case 42:case"end":return t.stop()}}),t,null,[[14,20],[27,35,38,42]])})));return function(e){return t.apply(this,arguments)}}())}function xn(t){t&&(t.classList.add("hidden"),t.classList.remove("flex"),setTimeout((function(){return t.remove()}),300))}function kn(t){return En.apply(this,arguments)}function En(){return(En=tn(Qr().mark((function t(e){return Qr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(t){return r(t)}})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Sn(t){return Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sn(t)}function jn(){jn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Sn(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Sn(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function _n(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Pn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,On(n.key),n)}}function On(t){var e=function(t){if("object"!=Sn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Sn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Sn(e)?e:e+""}function In(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function Tn(t,e){return t.get(Cn(t,e))}function Ln(t,e,r){return t.set(Cn(t,e),r),r}function Cn(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Bn=new WeakMap,Nn=new WeakMap,An=new WeakMap,Mn=function(){return t=function t(e){var r=e.view,n=e.model,o=e.authModel;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),In(this,Bn,void 0),In(this,Nn,void 0),In(this,An,void 0),Ln(Bn,this,r),Ln(Nn,this,n),Ln(An,this,o)},e=[{key:"getLogin",value:function(){var t,e=(t=jn().mark((function t(e){var r,n,o;return jn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.usernameOrEmail,n=e.password,Tn(Bn,this).showSubmitLoadingButton(),t.prev=2,t.next=5,Tn(Nn,this).getLogin(r,n);case 5:(o=t.sent).error||o.status>=400?Tn(Bn,this).loginFailed(o.message):(localStorage.setItem("user",JSON.stringify(o.data)),localStorage.removeItem("hasInteractedWithChatbot"),Tn(Bn,this).loginSuccessfully(o.message),window.location.hash="#/",Tn(An,this).putAccessToken(o.data.token)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),Tn(Bn,this).loginFailed(t.t0.message);case 12:return t.prev=12,Tn(Bn,this).hideSubmitLoadingButton(),t.finish(12);case 15:case"end":return t.stop()}}),t,this,[[2,9,12,15]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){_n(i,n,o,a,s,"next",t)}function s(t){_n(i,n,o,a,s,"throw",t)}a(void 0)}))});return function(t){return e.apply(this,arguments)}}()}],e&&Pn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Gn(t){return Gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gn(t)}function Dn(){Dn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Gn(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Gn(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function Fn(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Hn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Fn(i,n,o,a,s,"next",t)}function s(t){Fn(i,n,o,a,s,"throw",t)}a(void 0)}))}}function qn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Rn(n.key),n)}}function Rn(t){var e=function(t){if("object"!=Gn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Gn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Gn(e)?e:e+""}function zn(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Un(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Wn=new WeakMap,Jn=new WeakSet,Yn=function(){return t=function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),zn(this,e=Jn),e.add(this),function(t,e){zn(t,e),e.set(t,null)}(this,Wn)},n=[{key:"render",value:(i=Hn(Dn().mark((function t(){return Dn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n         <div class="flex items-center justify-center min-h-screen bg-white">\n            <div class="w-full max-w-xs">\n                <div class="flex items-center justify-center mb-4 gap-3">\n                    <img src="images/logo.png" alt="Logo" class="w-13 h-13 mb-2">\n                    <h1 class="text-2xl font-semibold text-gray-800 mb-2">MindBlown</h1>\n                </div>\n                <form id="login-form" class="bg-[#F7F7F7] rounded-xl shadow p-6 border border-gray-400">\n                    <p class="mb-3 text-gray-700 text-sm">Masuk untuk ngobrolin apa pun yang kamu rasakan.</p>\n                    <input id="email-input" placeholder="Email / Username" class="w-full mb-3 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n                    <input id="password-input" type="password" placeholder="Kata sandi" class="w-full mb-4 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n                    <div id="errorMessage" class="hidden text-red-500 text-center text-sm" role="alert"></div>\n\n                    <div id="submit-button-container" class="mt-3">\n                        <button class="w-full bg-third text-white text-sm py-2 rounded hover:bg-teal-600 transition" type="submit">Masuk</button>\n                    </div>\n                    \n                    <div class="flex justify-center mt-4">\n                        <p class="text-sm text-gray-500 ">Belum punya akun? <a href="#/register" class="text-third font-semibold hover:underline">Daftar</a></p>\n                    </div>\n                </form>\n            </div>\n        </div>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(o=Hn(Dn().mark((function t(){return Dn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Wn,o=new Mn({view:this,model:r,authModel:e}),n.set(Un(n,this),o),Un(Jn,this,Kn).call(this);case 2:case"end":return t.stop()}var n,o}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"loginSuccessfully",value:function(t){console.log(t),location.hash="/"}},{key:"loginFailed",value:function(t){var e=document.getElementById("errorMessage");e.textContent=t,e.classList.remove("hidden"),setTimeout((function(){e.classList.add("hidden")}),3e3)}},{key:"showSubmitLoadingButton",value:function(){document.getElementById("submit-button-container").innerHTML='\n            <button class="w-full bg-teal-500 text-white text-sm py-2 rounded hover:bg-teal-600 transition flex items-center justify-center gap-2" type="submit" disabled>\n                Loading...\n            </button>\n        '}},{key:"hideSubmitLoadingButton",value:function(){document.getElementById("submit-button-container").innerHTML='\n            <button class="w-full bg-teal-500 text-white text-sm py-2 rounded hover:bg-teal-600 transition" type="submit">Masuk</button>\n        '}}],n&&qn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,o,i}();function Kn(){var t=this;document.getElementById("login-form").addEventListener("submit",function(){var e=Hn(Dn().mark((function e(r){var n;return Dn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),n={usernameOrEmail:document.getElementById("email-input").value,password:document.getElementById("password-input").value},e.next=4,(o=Wn,i=t,o.get(Un(o,i))).getLogin(n);case 4:case"end":return e.stop()}var o,i}),e)})));return function(t){return e.apply(this,arguments)}}())}function Vn(t){return Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vn(t)}function Xn(){Xn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Vn(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Vn(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function $n(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Qn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zn(n.key),n)}}function Zn(t){var e=function(t){if("object"!=Vn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Vn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Vn(e)?e:e+""}function to(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function eo(t,e){return t.get(no(t,e))}function ro(t,e,r){return t.set(no(t,e),r),r}function no(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var oo=new WeakMap,io=new WeakMap,ao=function(){return t=function t(e){var r=e.view,n=e.model;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),to(this,oo,void 0),to(this,io,void 0),ro(oo,this,r),ro(io,this,n)},e=[{key:"getRegistered",value:(r=Xn().mark((function t(e){var r,n,o,i,a,s;return Xn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.username,n=e.name,o=e.preferences,i=e.email,a=e.password,eo(oo,this).showSubmitLoadingButton(),t.prev=2,o&&Array.isArray(o)&&0!==o.length){t.next=5;break}throw new Error("Minimal satu preferensi harus dipilih");case 5:return t.next=7,eo(io,this).getRegister(r,n,o,i,a);case 7:(s=t.sent).error||s.status>=400?eo(oo,this).registeredFailed(s.message):eo(oo,this).registeredSuccessfully(s.message),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),eo(oo,this).registeredFailed(t.t0.message);case 14:return t.prev=14,eo(oo,this).hideSubmitLoadingButton(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[2,11,14,17]])})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){$n(i,n,o,a,s,"next",t)}function s(t){$n(i,n,o,a,s,"throw",t)}a(void 0)}))},function(t){return n.apply(this,arguments)})}],e&&Qn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function so(t){return so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},so(t)}function co(){co=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==so(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(so(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function uo(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function lo(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){uo(i,n,o,a,s,"next",t)}function s(t){uo(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ho(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fo(n.key),n)}}function fo(t){var e=function(t){if("object"!=so(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=so(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==so(e)?e:e+""}function po(t,e,r){mo(t,e),e.set(t,r)}function mo(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vo(t,e){return t.get(go(t,e))}function yo(t,e,r){return t.set(go(t,e),r),r}function go(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var bo=new WeakMap,wo=new WeakMap,xo=new WeakSet,ko=function(){return t=function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),mo(this,e=xo),e.add(this),po(this,bo,null),po(this,wo,null)},e=[{key:"render",value:(o=lo(co().mark((function t(){return co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n        <div class="flex items-center justify-center min-h-screen bg-white">\n            <div class="w-full max-w-xs">\n                <div class="flex items-center justify-center mb-4 gap-3">\n                    <img src="images/logo.png" alt="Logo" class="w-13 h-13 mb-2">\n                    <h1 class="text-2xl font-semibold text-gray-800 mb-2">MindBlown</h1>\n                </div>\n                <form id="register-form" class="bg-[#F7F7F7] rounded-xl shadow p-5 border border-gray-400 sm:p-7">\n                    <p class="mb-3 text-gray-700 text-sm">Daftar untuk ngobrolin apa pun yang kamu rasakan.</p>\n\n                    <input id="username-input" type="text" placeholder="Nama Pengguna" class="w-full mb-3 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n\n                    <input id="name-input" type="text" placeholder="Nama Lengkap" class="w-full mb-3 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n\n                    <input id="email-input" type="email" placeholder="Email" class="w-full mb-3 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n                    <input id="password-input" type="password" placeholder="Kata sandi" class="w-full mb-3 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n                    <input id="passwordConfirm-input" type="password" placeholder="Konfirmasi kata sandi" class="w-full mb-4 px-3 py-2 border border-gray-400 rounded-md focus:outline-none focus:ring" required>\n\n                    <div id="errorMessage" class="hidden text-red-500 text-center text-sm" role="alert"></div>   \n\n                    <div id="submit-button-container" class="mt-3">\n                        <button class="w-full bg-third text-white text-sm py-2 rounded hover:bg-teal-600 transition" type="submit">Daftar</button>\n                    </div>\n                    <div class="flex justify-center mt-4">\n                        <p class="text-sm text-gray-500 ">Sudah punya akun? <a href="#/login" class="text-third font-semibold hover:underline">Masuk</a></p>\n                    </div>\n                </form>\n            </div>\n        </div>\n\n        \x3c!-- Modal Preferensi --\x3e\n        <div id="preferences-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">\n            <div class="bg-white rounded-lg shadow-xl w-full max-w-md p-6 mx-4">\n                <h2 class="text-xl font-semibold text-gray-800 mb-4">Pilih Minat & Preferensi Kamu</h2>\n                <p class="text-gray-600 mb-4">Pilih minimal satu dan maksimal tiga minat yang sesuai dengan kamu.</p>\n                \n                <div id="preferences-container" class="grid grid-cols-2 gap-2 mb-6 max-h-60 overflow-y-auto">\n                    \x3c!-- Preferences will be dynamically inserted here --\x3e\n                </div>\n                \n                <div id="preferences-error" class="hidden text-red-500 text-sm mb-4"></div>\n                \n                <div class="flex justify-center">\n                    <button id="preferences-submit" class="px-6 py-2 bg-teal-500 text-white rounded-full hover:bg-teal-600">Simpan dan Daftar</button>\n                </div>\n            </div>\n        </div>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(n=lo(co().mark((function t(){return co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:yo(bo,this,new ao({view:this,model:r})),go(xo,this,Eo).call(this),go(xo,this,So).call(this);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"registeredSuccessfully",value:function(t){console.log(t),location.hash="/login"}},{key:"registeredFailed",value:function(t){var e=document.getElementById("errorMessage");e.textContent=t,e.classList.remove("hidden"),setTimeout((function(){e.classList.add("hidden")}),3e3)}},{key:"showSubmitLoadingButton",value:function(){document.getElementById("submit-button-container").innerHTML='\n            <button class="w-full bg-teal-500 text-white text-sm py-2 rounded hover:bg-teal-600 transition" type="submit" disabled>\n                Loading...\n            </button>\n        '}},{key:"hideSubmitLoadingButton",value:function(){document.getElementById("submit-button-container").innerHTML='\n            <button class="w-full bg-teal-500 text-white text-sm py-2 rounded hover:bg-teal-600 transition" type="submit">\n                Daftar akun\n            </button>\n        '}}],e&&ho(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,o}();function Eo(){var t=this;document.getElementById("register-form").addEventListener("submit",function(){var e=lo(co().mark((function e(r){var n,o,i,a,s;return co().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),n=document.getElementById("username-input").value,o=document.getElementById("name-input").value,i=document.getElementById("email-input").value,a=document.getElementById("password-input").value,s=document.getElementById("passwordConfirm-input").value,a===s){e.next=9;break}return t.registeredFailed("Konfirmasi kata sandi tidak sama dengan kata sandi!"),e.abrupt("return");case 9:yo(wo,t,{username:n,name:o,preferences:[],email:i,password:a}),go(xo,t,jo).call(t);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function So(){var t,e=this,r=document.getElementById("preferences-container");r&&(r.innerHTML=["Olahraga","Belajar","Produktivitas","Relaksasi","Hiburan","Kesehatan","Sosial","Kreativitas","Hobi","Rumah Tangga","Pengembangan Diri"].map((function(t){return'\n                <div class="preference-option">\n                    <label class="flex items-center space-x-2 p-2 border rounded hover:bg-gray-50 cursor-pointer transition-colors">\n                        <input type="checkbox" name="preference" value="'.concat(t,'" class="h-4 w-4 text-teal-500 focus:ring-teal-400">\n                        <span class="text-sm">').concat(t,"</span>\n                    </label>\n                </div>\n            ")})).join("")),null===(t=document.getElementById("preferences-submit"))||void 0===t||t.addEventListener("click",(function(){var t=Array.from(document.querySelectorAll('input[name="preference"]:checked')).map((function(t){return t.value}));return 0===t.length?(document.getElementById("preferences-error").textContent="Pilih minimal satu preferensi untuk melanjutkan.",void document.getElementById("preferences-error").classList.remove("hidden")):t.length>3?(document.getElementById("preferences-error").textContent="Maksimal tiga preferensi yang bisa dipilih.",void document.getElementById("preferences-error").classList.remove("hidden")):(document.getElementById("preferences-error").classList.add("hidden"),vo(wo,e).preferences=t,document.getElementById("preferences-modal").classList.add("hidden"),void go(xo,e,_o).call(e))}))}function jo(){var t=document.getElementById("preferences-modal");t&&(t.classList.remove("hidden"),t.addEventListener("click",(function(e){e.target===t&&e.stopPropagation()})))}function _o(){return Po.apply(this,arguments)}function Po(){return(Po=lo(co().mark((function t(){return co().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(vo(wo,this)&&vo(wo,this).preferences.length){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,vo(bo,this).getRegistered(vo(wo,this));case 4:case"end":return t.stop()}}),t,this)})))).apply(this,arguments)}function Oo(t){return Oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oo(t)}function Io(){Io=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Oo(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Oo(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function To(t){return function(t){if(Array.isArray(t))return Lo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Lo(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lo(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lo(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Co(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Bo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,No(n.key),n)}}function No(t){var e=function(t){if("object"!=Oo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Oo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Oo(e)?e:e+""}var Ao=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.chatHistory=[]},e=[{key:"loadChatHistory",value:(r=Io().mark((function t(){var e,r,n;return Io().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(r=JSON.parse(localStorage.getItem("user")))&&r.token){t.next=5;break}return console.log("User not logged in, skipping chat history fetch"),t.abrupt("return",[]);case 5:return t.next=7,Xt();case 7:if(!(n=t.sent).error){t.next=10;break}throw new Error(n.message);case 10:return this.chatHistory=null!==(e=n.data)&&void 0!==e&&e.chats?To(n.data.chats).reverse():[],t.abrupt("return",this.chatHistory);case 14:return t.prev=14,t.t0=t.catch(0),console.error("Error loading chat history:",t.t0),t.abrupt("return",[]);case 18:case"end":return t.stop()}}),t,this,[[0,14]])})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){Co(i,n,o,a,s,"next",t)}function s(t){Co(i,n,o,a,s,"throw",t)}a(void 0)}))},function(){return n.apply(this,arguments)})},{key:"getChatHistory",value:function(){return this.chatHistory}},{key:"formatChatDate",value:function(t){var e=new Date(t),r=new Date;return e.toDateString()===r.toDateString()?"Hari ini, ".concat(e.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})):e.toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}}],e&&Bo(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Mo(t){return Mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mo(t)}function Go(){Go=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Mo(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Mo(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function Do(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Fo(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Do(i,n,o,a,s,"next",t)}function s(t){Do(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Ho(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qo(n.key),n)}}function qo(t){var e=function(t){if("object"!=Mo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Mo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Mo(e)?e:e+""}function Ro(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var zo=new WeakSet,Uo=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,zo),this.sessionId=localStorage.getItem("sessionId")||Ro(zo,this,Wo).call(this),localStorage.setItem("sessionId",this.sessionId),this.socket=null,this.connectionId=null,this.anonymousId=null,this.isAnonymous=!0,this.pendingRequests=new Map,this.presenter=new Ao},e=[{key:"render",value:(n=Fo(Go().mark((function t(){return Go().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n       <section class="ml-0 md:ml-8 lg:ml-16 min-h-screen flex">\n        <div class="w-full flex items-center pb-20"> \n            <div class="max-w-2xl w-full mx-auto text-center">\n                \n                <div id="chat-container" class="flex flex-col gap-2 px-6 lg:px-4 overflow-y-auto max-h-[75vh] md:max-h[80vh] lg:max-h-[75vh] pb-10">\n                    <div id="connection-status" class="hidden text-center py-2 text-sm text-gray-500">\n                        Menghubungkan ke MindBlown...\n                    </div>\n                </div>\n                \n                <form id="chat-form" class="fixed bottom-24 lg:bottom-6 z-50 w-full lg:w-full md:max-w-2xl lg:max-w-2xl mx-auto px-4 lg:px-0 flex gap-2">\n                    <textarea \n                      id="chat-input"\n                      class="text-[#8c8c8c] w-full h-16 md:h-20 lg:h-24 px-4 py-3 pr-14 rounded-3xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent overflow-hidden placeholder:leading-[2rem] md:placeholder:leading-[3rem] lg:placeholder:leading-[4rem]"\n                      placeholder="Cerita sedikit..." disabled></textarea>\n                    <button id="send-button" class="absolute right-6 lg:right-3 top-1/2 transform -translate-y-1/2 rounded-full bg-[#eee] p-2 flex items-center justify-center hover:bg-third focus:bg-third transition cursor-pointer" disabled>\n                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" fill="none" viewBox="-0.5 -0.5 16 16" stroke-linecap="round" stroke-linejoin="round" stroke="white" id="Send--Streamline-Mynaui" height="16" width="16">\n                            <path d="m8.75 6.25 -1.875 1.875m5.805 -6.230625a0.33437500000000003 0.33437500000000003 0 0 1 0.42500000000000004 0.42562500000000003l-3.7025 10.58125a0.33437500000000003 0.33437500000000003 0 0 1 -0.62125 0.025l-2.011875 -4.52625a0.33375 0.33375 0 0 0 -0.169375 -0.169375l-4.52625 -2.0125a0.33437500000000003 0.33437500000000003 0 0 1 0.025 -0.620625z" stroke-width="1"></path>\n                        </svg>\n                    </button>\n                </form>\n            </div>\n        </div>\n      </section>\n        ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=Fo(Go().mark((function t(){var e,r,n,o,i,a,c,u,l=this;return Go().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.getElementById("chat-container"),r=document.getElementById("connection-status"),n=document.getElementById("chat-form"),o=document.getElementById("chat-input"),i=document.getElementById("send-button"),e.insertAdjacentHTML("beforeend",'\n        <div id="chat-history-divider" class="hidden border-t border-gray-200 my-4 relative">\n            <span class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white px-4 text-xs text-gray-400">\n                Riwayat chat sebelumnya\n            </span>\n        </div>\n    '),o.addEventListener("input",(function(){return s(o)})),a=function(){requestAnimationFrame((function(){e.scrollTop=e.scrollHeight}))},this.connectWebSocket(e,r,o,i,a),t.prev=9,t.next=12,this.presenter.loadChatHistory();case 12:c=t.sent,u=document.getElementById("chat-history-divider"),c&&c.length>0&&(u.classList.remove("hidden"),c.forEach((function(t){var r=l.presenter.formatChatDate(t.timestamp);e.insertAdjacentHTML("beforeend",'<div class="text-center my-2">\n                            <span class="text-xs text-gray-400">'.concat(r,"</span>\n                        </div>")),e.insertAdjacentHTML("beforeend",h(t.message)),e.insertAdjacentHTML("beforeend",f(t.response))})),e.insertAdjacentHTML("beforeend",'<div class="border-t border-gray-200 my-4 relative">\n                        <span class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white px-4 text-xs text-gray-400">\n                            Chat baru\n                        </span>\n                    </div>'),a()),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(9),console.error("Failed to load chat history:",t.t0);case 20:setTimeout((function(){var t=localStorage.getItem("pendingChatMessage");if(t)if(console.log("Received message from homepage:",t),localStorage.removeItem("pendingChatMessage"),l.socket&&l.socket.readyState===WebSocket.OPEN){var r=Ro(zo,l,Jo).call(l);e.insertAdjacentHTML("beforeend",h(t)),a(),l.pendingRequests.set(r,{message:t,timestamp:new Date}),l.socket.send(JSON.stringify({type:"chatbot_request",message:t,requestId:r}))}else console.error("WebSocket not connected, cannot send message from homepage"),e.insertAdjacentHTML("beforeend",f("Maaf, koneksi terputus. Silakan coba lagi nanti.")),a()}),1e3),n.addEventListener("submit",function(){var t=Fo(Go().mark((function t(r){var n,i;return Go().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),n=o.value.trim()){t.next=4;break}return t.abrupt("return");case 4:localStorage.setItem("hasInteractedWithChatbot","true"),i=Ro(zo,l,Jo).call(l),e.insertAdjacentHTML("beforeend",h(n)),a(),o.value="",o.style.height="",l.socket&&l.socket.readyState===WebSocket.OPEN?(l.pendingRequests.set(i,{message:n,timestamp:new Date}),l.socket.send(JSON.stringify({type:"chatbot_request",message:n,requestId:i}))):(e.insertAdjacentHTML("beforeend",f("Maaf, koneksi terputus. Silakan refresh halaman untuk mencoba lagi.")),a());case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 22:case"end":return t.stop()}}),t,this,[[9,17]])}))),function(){return r.apply(this,arguments)})},{key:"connectWebSocket",value:function(t,e,r,n,o){var i=this;try{var a=I.replace("https://","wss://").replace("http://","ws://");this.socket=new WebSocket("".concat(a,"/chatbot-ws")),this.socket.onopen=function(){e.classList.add("hidden"),r.disabled=!1,n.disabled=!1;var t=JSON.parse(localStorage.getItem("user"));if(t){var o=t.userId||t.id;if(!o&&t.token)try{var a=t.token.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),s=JSON.parse(window.atob(a));if(s.id||s.sub){var c=s.id||s.sub;return void i.socket.send(JSON.stringify({type:"auth",userId:c}))}}catch(t){console.error("Error decoding token:",t)}o?i.socket.send(JSON.stringify({type:"auth",userId:o})):console.warn("No user ID found in user data")}},this.socket.onmessage=function(r){try{var n=JSON.parse(r.data);switch(console.log("WebSocket message received:",n),n.type){case"connected":i.connectionId=n.connectionId,i.anonymousId=n.anonymousId,i.isAnonymous=n.isAnonymous,e.classList.add("hidden");break;case"auth_success":i.isAnonymous=!1,e.classList.add("hidden");break;case"auth_anonymous":i.isAnonymous=!0,i.anonymousId=n.anonymousId,e.classList.add("hidden");break;case"chatbot_processing":var a="typing-".concat(n.requestId);document.getElementById(a)||(t.insertAdjacentHTML("beforeend",S(n.message,n.requestId)),o());break;case"chatbot_response":var s=document.getElementById("typing-".concat(n.requestId));s&&s.remove(),t.insertAdjacentHTML("beforeend",f(n.data.response)),o(),i.pendingRequests.delete(n.requestId);break;case"chatbot_error":var c=document.getElementById("typing-".concat(n.requestId));c&&c.remove(),t.insertAdjacentHTML("beforeend",f("Maaf, terjadi kesalahan: ".concat(n.message))),o(),i.pendingRequests.delete(n.requestId);break;case"error":E(n.message,"error");break;default:console.warn("Unknown message type:",n.type)}}catch(t){console.error("Error handling WebSocket message:",t)}},this.socket.onclose=function(a){console.log("WebSocket connection closed:",a),e.classList.remove("hidden"),e.textContent="Koneksi terputus",e.classList.remove("text-green-500"),e.classList.add("text-red-500"),r.disabled=!0,n.disabled=!0,setTimeout((function(){document.getElementById("chat-container")&&(e.textContent="Mencoba menghubungkan kembali...",e.classList.remove("text-red-500"),e.classList.add("text-yellow-500"),i.connectWebSocket(t,e,r,n,o))}),3e3)},this.socket.onerror=function(t){console.error("WebSocket error:",t),e.classList.remove("hidden"),e.textContent="Koneksi error",e.classList.remove("text-green-500"),e.classList.add("text-red-500")}}catch(t){console.error("Error connecting to WebSocket:",t),e.classList.remove("hidden"),e.textContent="Gagal terhubung",e.classList.add("text-red-500")}}}],e&&Ho(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function Wo(){return Date.now().toString(36)+Math.random().toString(36).substr(2,9)}function Jo(){return Date.now().toString(36)+Math.random().toString(36).substr(2,5)}function Yo(t){return Yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yo(t)}function Ko(){Ko=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Yo(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Yo(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function Vo(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Xo(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Vo(i,n,o,a,s,"next",t)}function s(t){Vo(i,n,o,a,s,"throw",t)}a(void 0)}))}}function $o(t,e,r){return Qo.apply(this,arguments)}function Qo(){return(Qo=Xo(Ko().mark((function t(e,r,n){var o,i,a,s,c,u,l,d,h;return Ko().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.disabled){t.next=2;break}return t.abrupt("return");case 2:return o=n.innerHTML,n.disabled=!0,t.prev=4,t.next=7,e.likeExistingComment(r);case 7:(i=t.sent).error?(alert("Gagal menyukai komentar: ".concat(i.message)),n.innerHTML=o):(l=n.querySelector(".comment-like-count"),d=n.querySelector("svg"),h=(null===(a=i.data)||void 0===a||null===(a=a.comment)||void 0===a?void 0:a.likeCount)||(null===(s=i.data)||void 0===s?void 0:s.likeCount)||i.newLikeCount||0,l&&(l.textContent=String(h)),(null===(c=i.data)||void 0===c||null===(c=c.comment)||void 0===c?void 0:c.userLiked)||i.userLiked||(null===(u=i.message)||void 0===u?void 0:u.includes("disukai"))?(d.classList.add("fill-red-500","text-red-500"),d.classList.remove("fill-none","text-gray-500"),n.classList.add("liked"),l&&(l.classList.add("text-red-500","font-semibold"),l.classList.remove("text-gray-600"))):(d.classList.add("fill-none","text-gray-500"),d.classList.remove("fill-red-500","text-red-500"),n.classList.remove("liked"),l&&(l.classList.add("text-gray-600"),l.classList.remove("text-red-500","font-semibold")))),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(4),console.error("Error handling comment like:",t.t0),alert("Gagal menyukai komentar: "+(t.t0.message||"Terjadi kesalahan")),n.innerHTML=o;case 16:return t.prev=16,n.disabled=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[4,11,16,19]])})))).apply(this,arguments)}var Zo=function(t,e){var r=document.getElementById(e);if(r){var n="_commentInteractionHandler_".concat(e);r[n]&&r.removeEventListener("click",r[n]),r[n]=function(){var e=Xo(Ko().mark((function e(r){var n,o,i;return Ko().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.target.closest(".comment-item-container")){e.next=3;break}return e.abrupt("return");case 3:if(o=n.dataset.commentId){e.next=6;break}return e.abrupt("return");case 6:if(!(i=r.target.closest(".comment-like-btn"))){e.next=13;break}return r.stopPropagation(),r.preventDefault(),e.next=12,$o(t,o,i);case 12:return e.abrupt("return");case 13:if(!r.target.closest(".comment-actions-menu")&&!r.target.closest(".comment-menu-btn")){e.next=15;break}return e.abrupt("return");case 15:n.style.cursor="pointer",window.location.hash="/comment/".concat(o);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.addEventListener("click",r[n])}};function ti(t){return ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ti(t)}function ei(){ei=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==ti(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(ti(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function ri(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}var ni=function(t,e){var r=document.getElementById(e);if(r){var n=null;r.addEventListener("click",(function(t){var r=t.target.closest(".comment-menu-btn");if(r){t.stopPropagation();var o=r.nextElementSibling;document.querySelectorAll("#".concat(e," .comment-menu")).forEach((function(t){t===o||t.classList.contains("hidden")||t.classList.add("hidden")})),o.classList.toggle("hidden"),n=o.classList.contains("hidden")?null:o}})),r.addEventListener("click",(function(t){n&&!n.classList.contains("hidden")&&(n.contains(t.target)||t.target.closest(".comment-menu-btn")||(n.classList.add("hidden"),n=null))}),!0),r.addEventListener("click",function(){var e,r=(e=ei().mark((function e(r){var o,i,a,s;return ei().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=r.target.closest(".delete-comment-btn"))){e.next=18;break}if(r.stopPropagation(),(i=o.closest(".comment-menu"))&&i.classList.add("hidden"),n=null,a=o.dataset.commentId,!confirm("Apakah Anda yakin ingin menghapus komentar ini?")){e.next=18;break}return e.prev=8,e.next=11,t.deleteExistingComment(a);case 11:(s=e.sent).error&&alert("Gagal menghapus komentar: ".concat(s.message)),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),alert("Gagal menghapus komentar: "+(e.t0.message||"Terjadi kesalahan"));case 18:case"end":return e.stop()}}),e,null,[[8,15]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(t){ri(i,n,o,a,s,"next",t)}function s(t){ri(i,n,o,a,s,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}())}};function oi(t){return oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oi(t)}function ii(){ii=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==oi(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(oi(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function ai(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function si(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ai(i,n,o,a,s,"next",t)}function s(t){ai(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ci(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,di(n.key),n)}}function ui(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function li(t,e,r){return(e=di(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function di(t){var e=function(t){if("object"!=oi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=oi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==oi(e)?e:e+""}function hi(t,e){return t.get(pi(t,e))}function fi(t,e,r){return t.set(pi(t,e),r),r}function pi(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var mi=new WeakMap,vi=new WeakSet,yi=function(){return t=function t(e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ui(this,r=vi),r.add(this),li(this,"_storyId",null),li(this,"_presenter",null),li(this,"_storyDataChangedHandler",null),li(this,"_currentUser",null),function(t,e){ui(t,e),e.set(t,null)}(this,mi),this._storyId=e,this._presenter=new ue(this),this._setupStoryDataChangedListener(),pi(vi,this,gi).call(this)},e=[{key:"render",value:(n=si(ii().mark((function t(){var e,r,n,o;return ii().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this._presenter?this._presenter.getCurrentUser():JSON.parse(localStorage.getItem("user"))||{},r=(null==e?void 0:e.name)||"Nama Pengguna",n=null!=e&&e.username?"@".concat(e.username):"@namapengguna",o=(null==e?void 0:e.profilePicture)||"./images/image.png",t.abrupt("return",'\n      <div class="md:ml-16 lg:ml-16 min-h-screen p-6 lg:p-10 pb-18">\n        <div class="mb-1">\n          <h1 class="text-2xl font-semibold text-gray-900 mb-2">Detail Story</h1>\n          <p class="text-gray-600">Cerita lengkap dan komentar.</p>\n          <hr class="mt-4 text-gray-300">\n        </div>\n\n        <div class="lg:grid lg:grid-cols-2 gap-4 lg:h-screen">\n          <div class="lg:overflow-y-auto lg:p-6 lg:mr-10 border-gray-200">\n            <div id="story-detail-container" class="space-y-6"></div>\n            <div id="comments-container" class="mt-8 space-y-6">\n              <h3 class="text-lg font-semibold text-gray-900 mb-4">Komentar</h3>\n              <div id="comments-list" class="space-y-4">\n                </div>\n            </div>\n          </div>\n          \n          <div class="hidden lg:block lg:p-6">\n            <div class="space-y-6 mt-4">\n              '.concat(b({username:r,handle:n,profilePicture:o}),'\n            </div>\n          </div>\n        </div>\n\n        <button id="add-comment-fab" class="fixed bottom-24 right-6 w-14 h-14 rounded-full bg-teal-500 text-white shadow-lg flex items-center justify-center z-30 lg:hidden focus:outline-none">\n          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">\n            <line x1="12" y1="5" x2="12" y2="19"></line>\n            <line x1="5" y1="12" x2="19" y2="12"></line>\n          </svg>\n        </button>\n\n        <div id="mobile-comment-modal" class="fixed inset-0 bg-white items-start justify-start z-50 hidden">\n        <div class="w-full h-full">\n          <div class="p-4 border-b border-gray-100 flex items-center justify-between">\n            <button id="close-comment-modal" class="text-gray-700">\n              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                <line x1="18" y1="6" x2="6" y2="18"></line>\n                <line x1="6" y1="6" x2="18" y2="18"></line>\n              </svg>\n            </button>\n            <button id="mobile-comment-submit" class="bg-teal-500 text-white px-4 py-1 rounded-full text-sm">kirim</button>\n          </div>\n          \n          <div class="p-4">\n            <div class="flex items-center gap-3 mb-4">\n              <img src="').concat(o,'" alt="Profile" class="w-8 h-8 rounded-full object-cover">\n              <span class="text-sm font-medium">').concat(r,'</span>\n            </div>\n            \n            <textarea id="mobile-comment-input" class="w-full border-0 focus:ring-0 text-gray-700 resize-none h-64 placeholder-gray-400" placeholder="Tulis komentar..."></textarea>\n          </div>\n        </div>\n      </div>\n\n      </div>\n    '));case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=si(ii().mark((function t(){return ii().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._presenter){t.next=3;break}return console.error("Presenter not initialized in afterRender."),t.abrupt("return");case 3:return t.next=5,this._presenter.loadStoryDetail(this._storyId);case 5:this.setupEventListeners(),this._setupStoryDataChangedListener(),pi(vi,this,gi).call(this),this._setupMobileCommentButton();case 9:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"_setupMobileCommentButton",value:function(){var t=this,e=document.getElementById("add-comment-fab"),r=document.getElementById("mobile-comment-modal"),n=document.getElementById("close-comment-modal"),o=document.getElementById("mobile-comment-submit");e&&r&&e.addEventListener("click",(function(){r.classList.remove("hidden"),r.classList.add("flex")})),n&&r&&n.addEventListener("click",(function(){r.classList.add("hidden"),r.classList.remove("flex");var t=document.getElementById("mobile-comment-input");t&&(t.value="")})),o&&o.addEventListener("click",si(ii().mark((function e(){var n,i;return ii().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=document.getElementById("mobile-comment-input"))&&n.value.trim()){e.next=4;break}return alert("Silakan masukkan komentar"),e.abrupt("return");case 4:if(i=o.textContent,o.disabled=!0,o.textContent="Mengirim...",e.prev=7,!t._presenter){e.next=13;break}return e.next=11,t._presenter.addComment(t._storyId,n.value.trim());case 11:e.sent&&(n.value="",t._showToast("Komentar berhasil ditambahkan!"),r.classList.add("hidden"),r.classList.remove("flex"));case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(7),console.error("Error submitting comment:",e.t0),alert("Gagal mengunggah komentar: "+(e.t0.message||"Terjadi kesalahan"));case 19:return e.prev=19,o.disabled=!1,o.textContent=i,e.finish(19);case 23:case"end":return e.stop()}}),e,null,[[7,15,19,23]])}))))}},{key:"_setupStoryDataChangedListener",value:function(){var t=this;this._storyDataChangedHandler&&(document.removeEventListener("storyDataChanged",this._storyDataChangedHandler),document.removeEventListener("commentDataChanged",this._storyDataChangedHandler)),this._storyDataChangedHandler=function(e){var r=e.detail,n=r.action,o=r.entityId,i=r.userLiked,a=r.newLikeCount,s=r.message;if("commentLiked"===n&&o){var c=document.querySelector('.comment-item-container[data-comment-id="'.concat(o,'"]'));if(c){var u=c.querySelector(".comment-like-btn"),l=null==u?void 0:u.querySelector("svg"),d=null==u?void 0:u.querySelector(".comment-like-count");if(u&&l&&d){var h=void 0!==i?i:null==s?void 0:s.includes("disukai");h?(u.classList.add("liked"),l.classList.add("fill-red-500","text-red-500"),l.classList.remove("fill-none","text-gray-500"),d.classList.add("text-red-500","font-semibold"),d.classList.remove("text-gray-600")):(u.classList.remove("liked"),l.classList.add("fill-none","text-gray-500"),l.classList.remove("fill-red-500","text-red-500"),d.classList.add("text-gray-600"),d.classList.remove("text-red-500","font-semibold"));var f,p=parseInt(d.textContent||"0");return f=void 0===a||isNaN(a)?h?Math.max(1,p):Math.max(0,p-1):Math.max(0,a),void(d.textContent=String(f))}console.warn("‚ö†Ô∏è Could not find all required elements for comment ".concat(o))}else console.warn("‚ö†Ô∏è Comment element with ID ".concat(o," not found"))}t._storyId&&t._presenter.loadStoryDetail(t._storyId)},document.addEventListener("storyDataChanged",this._storyDataChangedHandler),document.addEventListener("commentDataChanged",this._storyDataChangedHandler)}},{key:"destroy",value:function(){this._storyDataChangedHandler&&(document.removeEventListener("storyDataChanged",this._storyDataChangedHandler),this._storyDataChangedHandler=null),hi(mi,this)&&(document.removeEventListener("showEditStoryModalRequest",hi(mi,this)),fi(mi,this,null))}},{key:"showStoryDetail",value:function(t){var e,r=document.getElementById("story-detail-container");if(r){var n=JSON.parse(localStorage.getItem("user"))||{},o=!t.isAnonymous&&t.username===n.username,i=t._id||t.id||this._storyId;r.innerHTML=y({username:t.isAnonymous?"Pengguna":t.name,handle:t.isAnonymous?"Anonim":"@".concat(t.username),content:t.content,isAnonymous:t.isAnonymous,likeCount:t.likeCount||(null===(e=t.likes)||void 0===e?void 0:e.length)||0,commentCount:t.totalCommentCount,viewCount:t.viewCount||t.views||0,storyId:i,profilePicture:t.profilePicture,createdAt:t.createdAt,isOwner:o,userLiked:t.userLiked||!1}),this._presenter&&(pe(this._presenter,"story-detail-container"),xe(this._presenter,"story-detail-container"));var a=document.getElementById("comments-list");a?(t.comments&&t.comments.length>0?this._renderCommentsRecursive(t.comments,a,0):a.innerHTML='<p class="text-gray-500 text-sm">Belum ada komentar.</p>',Zo(this._presenter,"comments-list"),ni(this._presenter,"comments-list")):console.error("Element 'comments-list' not found in StoryDetailPage.")}else console.warn("Element with ID 'story-detail-container' not found.")}},{key:"_renderCommentsRecursive",value:function(t,e,r){var n=this;t&&0!==t.length?(this._currentUser=this._presenter.getCurrentUser(),e.innerHTML="",t.forEach((function(t){var o,i,a,s=(null===(o=n._currentUser)||void 0===o?void 0:o.username)===t.username,c=document.createElement("div");c.innerHTML=w({commentId:t.id||t._id,username:t.name||"Pengguna",handle:t.username,content:t.content,profilePicture:t.profilePicture||"./images/image.png",createdAt:t.createdAt,likeCount:(null===(i=t.likes)||void 0===i?void 0:i.length)||t.likeCount||0,replyCount:(null===(a=t.replies)||void 0===a?void 0:a.length)||t.replyCount||0,isOwner:s,userLiked:t.isLiked||!1});var u=c.firstElementChild;e.appendChild(u);var l=u.querySelector(".replies-container");l&&t.replies&&t.replies.length>0&&n._renderCommentsRecursive(t.replies,l,r+1)}))):r>0&&(e.innerHTML='<p class="text-gray-400 text-xs pl-4">Tidak ada balasan.</p>')}},{key:"showComments",value:function(t){var e=this,r=document.getElementById("comments-list");r&&(this._currentUser=this._presenter.getCurrentUser(),r.innerHTML=t.map((function(t){var r,n,o,i=(null===(r=e._currentUser)||void 0===r?void 0:r.username)===t.username;return w({commentId:t._id||t.id,username:t.name||t.username||"Pengguna",handle:t.username?"@".concat(t.username):"Anonim",content:t.content,createdAt:t.createdAt||(new Date).toISOString(),profilePicture:t.profilePicture||"./images/image.png",likeCount:t.likeCount||(null===(n=t.likes)||void 0===n?void 0:n.length)||0,replyCount:t.repliesCount||(null===(o=t.replies)||void 0===o?void 0:o.length)||0,isOwner:i,userLiked:t.userLiked||!1})})).join(""),this._presenter&&(Zo(this._presenter,"comments-list"),ni(this._presenter,"comments-list")))}},{key:"setupEventListeners",value:function(){var t=document.getElementById("comment-form");t&&this._setupCommentFormSubmit(t);var e=document.getElementById("mobile-comment-modal");if(e){var r=e.querySelector("#comment-form");r&&this._setupCommentFormSubmit(r)}}},{key:"_setupCommentFormSubmit",value:function(t){var e=this;t.addEventListener("submit",function(){var r=si(ii().mark((function r(n){var o,i,a,s;return ii().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.preventDefault(),o=t.querySelector("#comment-input"),i=t.querySelector('button[type="submit"]'),a=i.textContent,o&&o.value.trim()){r.next=7;break}return alert("Silakan masukkan komentar"),r.abrupt("return");case 7:if(i.disabled=!0,i.textContent="Mengunggah...",r.prev=9,!e._presenter){r.next=15;break}return r.next=13,e._presenter.addComment(e._storyId,o.value.trim());case 13:r.sent&&(o.value="",e._showToast("Komentar berhasil ditambahkan!"),(s=document.getElementById("mobile-comment-modal"))&&s.classList.contains("flex")&&(s.classList.remove("flex"),s.classList.add("hidden")));case 15:r.next=21;break;case 17:r.prev=17,r.t0=r.catch(9),console.error("Error submitting comment:",r.t0),alert("Gagal mengunggah komentar: "+(r.t0.message||"Terjadi kesalahan"));case 21:return r.prev=21,i.disabled=!1,i.textContent=a,r.finish(21);case 25:case"end":return r.stop()}}),r,null,[[9,17,21,25]])})));return function(t){return r.apply(this,arguments)}}())}},{key:"_showToast",value:function(t){var e="toast-notification",r=document.getElementById(e);r&&r.remove(),(r=document.createElement("div")).id=e,r.className="fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded shadow-lg z-[1000]",r.textContent=t,document.body.appendChild(r),setTimeout((function(){r.remove()}),3e3)}},{key:"showError",value:function(t){var e=document.getElementById("story-detail-container");if(e)e.innerHTML='\n        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">\n          <strong class="font-bold">Error!</strong>\n          <span class="block sm:inline">'.concat(t,"</span>\n        </div>");else{var r=document.querySelector(".ml-16.min-h-screen.p-10");r?r.innerHTML='<p class="text-red-500 p-6">'.concat(t,"</p>"):alert(t)}}}],e&&ci(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function gi(){var t=this;fi(mi,this,(function(e){var r=e.detail,n=r.storyId,o=r.currentContent;n===t._storyId&&(t._presenter&&"function"==typeof t._presenter.editStory?je(n,o,t._presenter):console.error("StoryDetailPage: Presenter or presenter.editStory method is not available."))})),document.addEventListener("showEditStoryModalRequest",hi(mi,this))}function bi(t){return bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bi(t)}function wi(){wi=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==bi(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(bi(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function xi(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function ki(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){xi(i,n,o,a,s,"next",t)}function s(t){xi(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Ei(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Si(n.key),n)}}function Si(t){var e=function(t){if("object"!=bi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=bi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==bi(e)?e:e+""}var ji=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.title="404 - Halaman Tidak Ditemukan"},e=[{key:"render",value:(n=ki(wi().mark((function t(){return wi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="min-h-screen flex items-center justify-center bg-gray-50">\n        <div class="text-center px-6 py-12 max-w-md mx-auto">\n          <div class="mb-8">\n            <div class="text-9xl font-bold text-third mb-6">404</div>\n          </div>\n\n          <h1 class="text-3xl font-bold text-gray-900 mb-4">\n            Halaman Tidak Ditemukan\n          </h1>\n          \n          <p class="text-gray-600 mb-8 leading-relaxed">\n            Maaf, halaman yang Anda cari tidak dapat ditemukan.\n          </p>\n\n          <div class="space-y-4">\n            <button \n              id="go-home" \n              class="w-full bg-third text-white py-3 px-6 rounded-lg font-medium hover:bg-third/90 transition-colors">\n              Kembali ke Beranda\n            </button>\n            \n            <button \n              id="go-back" \n              class="w-full border border-gray-300 text-gray-700 py-3 px-6 rounded-lg font-medium hover:bg-gray-50 transition-colors">\n              Kembali ke Halaman Sebelumnya\n            </button>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=ki(wi().mark((function t(){return wi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.attachEventListeners();case 1:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"attachEventListeners",value:function(){var t=document.getElementById("go-home"),e=document.getElementById("go-back");t&&t.addEventListener("click",(function(){window.location.hash="#/"})),e&&e.addEventListener("click",(function(){window.history.length>1?window.history.back():window.location.hash="#/"}))}}],e&&Ei(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function _i(t){return _i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_i(t)}function Pi(){Pi=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==_i(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(_i(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function Oi(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Ii(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Oi(i,n,o,a,s,"next",t)}function s(t){Oi(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Ti(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ci(n.key),n)}}function Li(t,e,r){return(e=Ci(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ci(t){var e=function(t){if("object"!=_i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=_i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_i(e)?e:e+""}var Bi=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Li(this,"_commentId",null),Li(this,"_presenter",null),Li(this,"_commentDataChangedHandler",null),Li(this,"_currentUser",null),this._commentId=e,this._presenter=new ue(this),this._currentUser=this._presenter.getCurrentUser()},e=[{key:"render",value:(n=Ii(Pi().mark((function t(){var e,r,n,o,i,a;return Pi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=(null===(e=this._currentUser)||void 0===e?void 0:e.name)||"Nama Pengguna",i=null!==(r=this._currentUser)&&void 0!==r&&r.username?"@".concat(this._currentUser.username):"@namapengguna",a=(null===(n=this._currentUser)||void 0===n?void 0:n.profilePicture)||"./images/image.png",t.abrupt("return",'\n      <div class="md:ml-16 lg:ml-16 min-h-screen lg:p-10 p-6 pb-20 lg:pb-10">\n        <div class="mb-1">\n            <h1 class="text-2xl font-semibold text-gray-900 mb-2">Detail Komentar</h1>\n            <p class="text-gray-600">Lihat komentar dan balasannya.</p>\n            <hr class="mt-4 text-gray-300">\n        </div>\n\n        <div class="lg:grid lg:grid-cols-2 gap-4 h-screen">\n            <div class="overflow-y-auto lg:p-6 lg:mr-10 border-gray-200">\n            <div id="parent-comment-container" class="space-y-6"></div>\n            <h3 class="text-lg font-semibold text-gray-900 mt-6">Balasan</h3>\n\n            <div id="replies-list-container" class="mt-6 space-y-6">\n                <h3 class="text-lg font-semibold text-gray-900 mb-4">Semua Balasan</h3>\n            </div>\n            </div>\n\n            <div class="hidden lg:p-6 lg:block">\n            <div class="lg:space-y-6 mt-4">\n                '.concat(x({parentCommentId:this._commentId,username:o,handle:i,profilePicture:a}),'\n            </div>\n            </div>\n        </div>\n\n        <button id="add-reply-fab" class="fixed bottom-24 right-6 w-14 h-14 rounded-full bg-teal-500 text-white shadow-lg flex items-center justify-center z-30 lg:hidden focus:outline-none">\n          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">\n            <line x1="12" y1="5" x2="12" y2="19"></line>\n            <line x1="5" y1="12" x2="19" y2="12"></line>\n          </svg>\n        </button>\n\n         <div id="mobile-reply-modal" class="fixed inset-0 bg-white items-start justify-start z-50 hidden">\n          <div class="w-full h-full">\n            <div class="p-4 border-b border-gray-100 flex items-center justify-between">\n              <button id="close-reply-modal" class="text-gray-700">\n                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                  <line x1="18" y1="6" x2="6" y2="18"></line>\n                  <line x1="6" y1="6" x2="18" y2="18"></line>\n                </svg>\n              </button>\n              <button id="mobile-reply-submit" class="bg-teal-500 text-white px-4 py-1 rounded-full text-sm">Posting</button>\n            </div>\n            \n            <div class="p-4">\n              <div class="flex items-center gap-3 mb-4">\n                <img src="').concat(a,'" alt="Profile" class="w-8 h-8 rounded-full object-cover">\n                <span class="text-sm font-medium">').concat(o,'</span>\n              </div>\n              \n              <textarea id="mobile-reply-input" class="w-full border-0 focus:ring-0 text-gray-700 resize-none h-64 placeholder-gray-400" placeholder="Tulis balasan..."></textarea>\n            </div>\n          </div>\n        </div>\n\n        </div>\n    '));case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=Ii(Pi().mark((function t(){return Pi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._presenter){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this._presenter.loadCommentDetail(this._commentId);case 4:this._setupReplyFormSubmit(),this._setupMobileReplyForm(),this._setupCommentDataChangedListener();case 7:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"_setupMobileReplyForm",value:function(){var t=this,e=document.getElementById("add-reply-fab"),r=document.getElementById("mobile-reply-modal"),n=document.getElementById("close-reply-modal"),o=document.getElementById("mobile-reply-submit");e&&r&&e.addEventListener("click",(function(){r.classList.remove("hidden"),r.classList.add("flex")})),n&&r&&n.addEventListener("click",(function(){r.classList.add("hidden"),r.classList.remove("flex"),document.getElementById("mobile-reply-input").value=""})),o&&o.addEventListener("click",Ii(Pi().mark((function e(){var n,i,a;return Pi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=document.getElementById("mobile-reply-input"))&&n.value.trim()){e.next=4;break}return alert("Silakan masukkan balasan."),e.abrupt("return");case 4:return i=o.textContent,o.disabled=!0,o.textContent="Mengirim...",e.prev=7,e.next=10,t._presenter.addReplyToComment(t._commentId,n.value.trim());case 10:(a=e.sent).error?alert("Gagal mengirim balasan: ".concat(a.message)):(n.value="",r.classList.add("hidden"),r.classList.remove("flex")),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(7),console.error("Error submitting reply:",e.t0),alert("Gagal mengirim balasan: "+(e.t0.message||"Terjadi kesalahan"));case 18:return e.prev=18,o.disabled=!1,o.textContent=i,e.finish(18);case 22:case"end":return e.stop()}}),e,null,[[7,14,18,22]])}))))}},{key:"_setupReplyFormSubmit",value:function(){var t=this,e=document.getElementById("reply-form-".concat(this._commentId));e&&e.addEventListener("submit",function(){var r=Ii(Pi().mark((function r(n){var o,i,a,s;return Pi().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.preventDefault(),o=document.getElementById("reply-input-".concat(t._commentId)),i=e.querySelector('button[type="submit"]'),a=i.textContent,o&&o.value.trim()){r.next=7;break}return alert("Silakan masukkan balasan."),r.abrupt("return");case 7:return i.disabled=!0,i.textContent="Mengirim...",r.prev=9,r.next=12,t._presenter.addReplyToComment(t._commentId,o.value.trim());case 12:(s=r.sent).error?alert("Gagal mengirim balasan: ".concat(s.message)):o.value="",r.next=20;break;case 16:r.prev=16,r.t0=r.catch(9),console.error("Error submitting reply:",r.t0),alert("Gagal mengirim balasan: "+(r.t0.message||"Terjadi kesalahan"));case 20:return r.prev=20,i.disabled=!1,i.textContent=a,r.finish(20);case 24:case"end":return r.stop()}}),r,null,[[9,16,20,24]])})));return function(t){return r.apply(this,arguments)}}())}},{key:"_setupCommentDataChangedListener",value:function(){var t=this;this._commentDataChangedHandler=function(){var e=Ii(Pi().mark((function e(r){var n,o,i,a;return Pi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.detail,o=n.entityId,i=n.action,a=n.parentId,o!==t._commentId&&a!==t._commentId&&("replied"!==i||r.detail.storyId!==t._commentId)){e.next=6;break}if(console.log("CommentDetailPage: commentDataChanged event for current comment or its replies, reloading.",r.detail),!t._presenter){e.next=6;break}return e.next=6,t._presenter.loadCommentDetail(t._commentId);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),document.addEventListener("commentDataChanged",this._commentDataChangedHandler)}},{key:"showCommentDetail",value:function(t){var e,r,n,o,i=document.getElementById("parent-comment-container"),a=document.getElementById("replies-list-container");i&&a?(this._currentUser=this._presenter.getCurrentUser(),!t.isCommentAnonymous&&(null===(e=this._currentUser)||void 0===e||e.username,t.authorActualUsername),i.innerHTML=w({commentId:t._id,username:t.name||"Pengguna",handle:t.username||"Anonim",content:t.content,profilePicture:t.profilePicture||"./images/image.png",createdAt:t.createdAt,likeCount:(null===(r=t.likes)||void 0===r?void 0:r.length)||t.likeCount||0,replyCount:(null===(n=t.replies)||void 0===n?void 0:n.length)||t.replyCount||0,isOwner:(null===(o=this._currentUser)||void 0===o?void 0:o.username)===t.username,userLiked:t.userLiked||!1}),t.replies&&t.replies.length>0?this._renderCommentsRecursive(t.replies,a,1):a.innerHTML='<p class="text-gray-500 text-sm">Belum ada balasan untuk komentar ini.</p>',Zo(this._presenter,i.id),ni(this._presenter,i.id),Zo(this._presenter,a.id),ni(this._presenter,a.id)):console.error("Comment detail page containers not found.")}},{key:"_renderCommentsRecursive",value:function(t,e,r){var n=this;if(t&&0!==t.length){var o="";t.forEach((function(t){var e,i,a,s=(null===(e=n._currentUser)||void 0===e?void 0:e.username)===t.username,c=w({commentId:t._id,username:t.name||"Pengguna",handle:t.username,content:t.content,profilePicture:t.profilePicture||"./images/image.png",createdAt:t.createdAt,likeCount:(null===(i=t.likes)||void 0===i?void 0:i.length)||t.likeCount||0,replyCount:(null===(a=t.replies)||void 0===a?void 0:a.length)||t.replyCount||0,isOwner:s,userLiked:t.userLiked||!1}),u=document.createElement("div");u.innerHTML=c;var l=u.querySelector(".replies-container");l&&t.replies&&t.replies.length>0&&n._renderCommentsRecursive(t.replies,l,r+1),o+=u.innerHTML})),e.innerHTML=o}else e.innerHTML=1===r?'<p class="text-gray-500 text-sm">Belum ada balasan.</p>':""}},{key:"showError",value:function(t){var e=document.getElementById("parent-comment-container");e?e.innerHTML='<p class="text-red-500 p-4 text-center">'.concat(t,"</p>"):alert(t)}},{key:"destroy",value:function(){this._commentDataChangedHandler&&(document.removeEventListener("commentDataChanged",this._commentDataChangedHandler),this._commentDataChangedHandler=null)}}],e&&Ti(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const Ni={"/login":function(){return N(new Yn)},"/register":function(){return N(new ko)},"/":function(){return new J},"/story":function(){return M(new qe)},"/mindtracker":function(){return M(new ir)},"/notification":function(){return M(new Br)},"/profile":function(){return M(new mn)},"/chatbot":function(){return new Uo},"/story/:id":function(t){return M(new yi(t))},"/404":function(){return new ji},"/comment/:id":function(t){return new Bi(t)}};function Ai(t){return Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ai(t)}function Mi(){Mi=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Ai(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ai(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function Gi(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function Di(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Gi(i,n,o,a,s,"next",t)}function s(t){Gi(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Fi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Hi(n.key),n)}}function Hi(t){var e=function(t){if("object"!=Ai(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ai(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ai(e)?e:e+""}function qi(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function Ri(t,e){return t.get(Ui(t,e))}function zi(t,e,r){return t.set(Ui(t,e),r),r}function Ui(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Wi=new WeakMap,Ji=new WeakMap,Yi=new WeakMap,Ki=new WeakMap,Vi=new WeakMap,Xi=new WeakMap;const $i=function(){return t=function t(e){var r=e.content,n=e.sidebar,o=e.sidebarToggle,i=e.sidebarToggleIcon,a=e.sidebarToggleContainer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),qi(this,Wi,null),qi(this,Ji,null),qi(this,Yi,null),qi(this,Ki,null),qi(this,Vi,null),qi(this,Xi,!1),zi(Wi,this,r),zi(Ji,this,n),zi(Yi,this,o),zi(Ki,this,i),zi(Vi,this,a),this.setupSidebarToggle(),this.setupNavigationLinks()},e=[{key:"setupSidebarToggle",value:function(){var t=this;Ri(Yi,this)&&Ri(Ki,this)&&Ri(Ji,this)&&Ri(Yi,this).addEventListener("click",(function(){console.log("clicked"),zi(Xi,t,!Ri(Xi,t)),Ri(Xi,t)?t.expandSidebar():t.collapseSidebar()}))}},{key:"setupNavigationLinks",value:function(){var t=this;document.querySelectorAll("nav a").forEach((function(e){e.addEventListener("click",(function(){Ri(Xi,t)&&t.collapseSidebar()}))}));var e=document.querySelector('a[href="#/"]');e&&e.addEventListener("click",(function(){Ri(Xi,t)&&t.collapseSidebar()})),this.updateActiveNavLink()}},{key:"collapseSidebar",value:function(){zi(Xi,this,!1),Ri(Ji,this).classList.remove("w-56"),Ri(Ji,this).classList.add("w-16"),Ri(Vi,this).classList.remove("ml-54"),Ri(Ki,this).innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="18" viewBox="0 0 24 24" width="18"><path d="M24 24H0V0h24v24z" fill="none" opacity=".87"/><path d="M7.38 21.01c.49.49 1.28.49 1.77 0l8.31-8.31c.39-.39.39-1.02 0-1.41L9.15 2.98c-.49-.49-1.28-.49-1.77 0s-.49 1.28 0 1.77L14.62 12l-7.25 7.25c-.48.48-.48 1.28.01 1.76z"/></svg>',document.querySelectorAll(".sidebar-label").forEach((function(t){return t.classList.add("hidden")}))}},{key:"expandSidebar",value:function(){zi(Xi,this,!0),Ri(Ji,this).classList.remove("w-16"),Ri(Ji,this).classList.add("w-56"),Ri(Vi,this).classList.add("ml-54"),Ri(Ki,this).innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="18" viewBox="0 0 24 24" width="18"><path d="M24 24H0V0h24v24z" fill="none" opacity=".87"/><path d="M16.62 2.99c-.49-.49-1.28-.49-1.77 0l-8.31 8.31c-.39.39-.39 1.02 0 1.41l8.31 8.31c.49.49 1.28.49 1.77 0s.49-1.28 0-1.77L9.38 12l7.25-7.25c.48-.48.48-1.28-.01-1.76z"/></svg>',document.querySelectorAll(".sidebar-label").forEach((function(t){return t.classList.remove("hidden")}))}},{key:"updateActiveNavLink",value:function(){var t=window.location.hash||"#/";document.querySelectorAll("nav a").forEach((function(e){var r=e.getAttribute("href"),n=e.querySelector("svg");r===t?(e.classList.add("text-[#00ADB5]"),n&&n.classList.add("text-[#00ADB5]")):(e.classList.remove("text-[#00ADB5]"),n&&n.classList.remove("text-[#00ADB5]"))}))}},{key:"renderPage",value:(r=Di(Mi().mark((function t(){var e,r,n,o,i,s,c=this;return Mi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=P(),r=j(_()),n=r.id,(o=Ni[e])||(o=Ni["/404"]),i=o(n)){t.next=7;break}return t.abrupt("return");case 7:s=a({updateDOM:function(){var t=Di(Mi().mark((function t(){return Mi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.render();case 2:Ri(Wi,c).innerHTML=t.sent,i.afterRender(),c.updateActiveNavLink();case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}),s.ready.catch(console.error),s.updateCallbackDone.then((function(){scrollTo({top:0,behavior:"instant"})}));case 10:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&Fi(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Qi(t){return Qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qi(t)}function Zi(){Zi=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r,n){return Object.defineProperty(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function u(e,r,n,o){var i=r&&r.prototype instanceof h?r:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,r,n){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===d)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===o)throw o=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=3;var u=l(e,r,n);if("normal"===u.type){if(o=n.done?4:2,u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=4,n.method="throw",n.arg=u.arg)}}}(e,n,new S(o||[])),!0),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function f(){}function p(){}var m={};c(m,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(j([])));y&&y!==r&&n.call(y,i)&&(m=y);var g=p.prototype=h.prototype=Object.create(m);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Qi(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,r){var n=r.method,o=e.i[n];if(o===t)return r.delegate=null,"throw"===n&&e.i.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=l(o,e.i,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var a=i.arg;return a?a.done?(r[e.r]=a.value,r.next=e.n,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function k(t){this.tryEntries.push(t)}function E(e){var r=e[4]||{};r.type="normal",r.arg=t,e[4]=r}function S(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function j(e){if(null!=e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Qi(e)+" is not iterable")}return f.prototype=p,c(g,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,s,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t){a.type="throw",a.arg=e,r.next=t}for(var o=r.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return n("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,n(c),!0;if(s<u)return n(u),!1}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var o=n;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[2]===t)return this.complete(r[4],r[3]),E(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r[0]===t){var n=r[4];if("throw"===n.type){var o=n.arg;E(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={i:j(e),r,n},"next"===this.method&&(this.arg=t),d}},e}function ta(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function ea(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ta(i,n,o,a,s,"next",t)}function s(t){ta(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ra(){var t=window.location.hash.replace("#","")||"/",e=document.getElementById("navbar-container"),r=document.getElementById("mobile-navbar"),n=P(),o=void 0!==Ni[n];["/login","/register","/404"].includes(t)||!o?(e&&(e.style.display="none"),r&&(r.style.display="none")):(e&&(e.style.display=""),r&&(r.style.display=""))}document.addEventListener("DOMContentLoaded",ea(Zi().mark((function t(){var e;return Zi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new $i({content:document.querySelector("#main-content"),sidebar:document.querySelector("#sidebar"),sidebarToggle:document.querySelector("#sidebar-toggle"),sidebarToggleIcon:document.querySelector("#sidebar-toggle-icon"),sidebarToggleContainer:document.querySelector("#sidebar-toggle-container")}),t.next=3,e.renderPage();case 3:return t.next=5,c();case 5:console.log("Berhasil mendaftarkan service worker."),ra(),r=void 0,n=void 0,void 0,r=document.querySelector("#sidebar a.block"),n=document.querySelector("#mobile-navbar a:first-child"),o=function(t){"true"===localStorage.getItem("hasInteractedWithChatbot")&&(t.preventDefault(),window.location.href="#/chatbot")},r&&r.addEventListener("click",o),n&&n.addEventListener("click",o),window.addEventListener("hashchange",ea(Zi().mark((function t(){return Zi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.renderPage();case 2:ra();case 3:case"end":return t.stop()}}),t)}))));case 9:case"end":return t.stop()}var r,n,o}),t)}))))})();